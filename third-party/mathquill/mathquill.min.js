(function(){var O=jQuery,s,an,E="mathquill-command-id",j="mathquill-block-id",ak=Math.min,y=Math.max;var K=[].slice;function af(){}function e(P){var ao=K.call(arguments,1);return function(){return P.apply(this,ao)}}function ac(ao,P){if(!P){throw new Error("prayer failed: "+ao)}}var h=(function(ap,aq,au){function ao(P){return typeof P==="object"}function at(P){return typeof P==="function"}function ar(az,av){if(av===au){av=az;az=Object}function aA(aC){var aB=this;if(!(aB instanceof aA)){return new aA(arguments)}if(aC&&at(aB.init)){aB.init.apply(aB,aC)}}var ay=aA[ap]=new az();var ax=az[ap];var aw;var P=aA.mixin=function(aC){aw={};if(at(aC)){aw=aC.call(aA,ay,ax,aA,az)}else{if(ao(aC)){aw=aC}}if(ao(aw)){for(var aB in aw){if(aq.call(aw,aB)){ay[aB]=aw[aB]}}}if(!at(ay.init)){ay.init=function(){az.apply(this,arguments)}}return aA};ay.constructor=aA;return P(av)}return ar})("prototype",({}).hasOwnProperty);var l=(function(){var P={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};function ap(ar){var av=ar.which||ar.keyCode;var aq=P[av];var au;var at=[];if(ar.ctrlKey){at.push("Ctrl")}if(ar.originalEvent&&ar.originalEvent.metaKey){at.push("Meta")}if(ar.altKey){at.push("Alt")}if(ar.shiftKey){at.push("Shift")}au=aq||String.fromCharCode(av);if(!at.length&&!aq){return au}at.push(au);return at.join("-")}return function ao(ar,aC){var aE=null;var ax=null;if(!aC){aC={}}var aA=aC.text||af;var aw=aC.key||af;var aK=aC.paste||af;var av=aC.cut||af;var aD=O(ar);var aM=O(aC.container||aD);var az=af;function aJ(aN){az=aN;setTimeout(aN)}aM.bind("keydown keypress input keyup focusout paste",function(){az()});function aF(aN){az();aD.val(aN);if(aN){aD[0].select()}}function aI(){var aN=aD[0];if(!("selectionStart" in aN)){return false}return aN.selectionStart!==aN.selectionEnd}function at(aO){var aN=aD.val();aD.val("");if(aN){aO(aN)}}function aB(){aw(ap(aE),aE)}function aL(aN){aE=aN;ax=null;aB()}function au(aN){if(aE&&ax){aB()}ax=aN;aJ(aH)}function aH(){if(aI()){return}at(aA)}function ay(){aE=ax=null}function aq(aN){aD.focus();aJ(aG)}function aG(){at(aK)}aM.bind({keydown:aL,keypress:au,focusout:ay,cut:av,paste:aq});return{select:aF}}}());var c=h(function(aC,aE,ar){function at(aG,aF){if(aG){aG="'"+aG+"'"}else{aG="EOF"}throw"Parse Error: "+aF+" at "+aG}aC.init=function(aF){this._=aF};aC.parse=function(aG){return this.skip(aD)._(aG,aF,at);function aF(aI,aH){return aH}};aC.or=function(aG){ac("or is passed a parser",aG instanceof ar);var aF=this;return ar(function(aK,aJ,aI){return aF._(aK,aJ,aH);function aH(aL){return aG._(aK,aJ,aI)}})};aC.then=function(aG){var aF=this;return ar(function(aK,aJ,aH){return aF._(aK,aI,aH);function aI(aN,aL){var aM=(aG instanceof ar?aG:aG(aL));ac("a parser is returned",aM instanceof ar);return aM._(aN,aJ,aH)}})};aC.many=function(){var aF=this;return ar(function(aL,aK,aI){var aH=[];while(aF._(aL,aJ,aG)){}return aK(aL,aH);function aJ(aN,aM){aL=aN;aH.push(aM);return true}function aG(){return false}})};aC.times=function(aH,aF){if(arguments.length<2){aF=aH}var aG=this;return ar(function(aP,aO,aI){var aK=[];var aR=true;var aJ;for(var aM=0;aM<aH;aM+=1){aR=aG._(aP,aQ,aL);if(!aR){return aI(aP,aJ)}}for(;aM<aF&&aR;aM+=1){aR=aG._(aP,aQ,aN)}return aO(aP,aK);function aQ(aT,aS){aK.push(aS);aP=aT;return true}function aL(aT,aS){aJ=aS;aP=aT;return false}function aN(aT,aS){return false}})};aC.result=function(aF){return this.then(au(aF))};aC.atMost=function(aF){return this.times(0,aF)};aC.atLeast=function(aG){var aF=this;return aF.times(aG).then(function(aH){return aF.many().map(function(aI){return aH.concat(aI)})})};aC.map=function(aF){return this.then(function(aG){return au(aF(aG))})};aC.skip=function(aF){return this.then(function(aG){return aF.result(aG)})};var av=this.string=function(aH){var aF=aH.length;var aG="expected '"+aH+"'";return ar(function(aL,aK,aJ){var aI=aL.slice(0,aF);if(aI===aH){return aK(aL.slice(aF),aI)}else{return aJ(aL,aG)}})};var aA=this.regex=function(aF){ac("regexp parser is anchored",aF.toString().charAt(1)==="^");var aG="expected "+aF;return ar(function(aL,aK,aJ){var aI=aF.exec(aL);if(aI){var aH=aI[0];return aK(aL.slice(aH.length),aH)}else{return aJ(aL,aG)}})};var au=ar.succeed=function(aF){return ar(function(aH,aG){return aG(aH,aF)})};var aq=ar.fail=function(aF){return ar(function(aI,aG,aH){return aH(aI,aF)})};var ap=ar.letter=aA(/^[a-z]/i);var ax=ar.letters=aA(/^[a-z]*/i);var az=ar.digit=aA(/^[0-9]/);var ao=ar.digits=aA(/^[0-9]*/);var P=ar.whitespace=aA(/^\s+/);var ay=ar.optWhitespace=aA(/^\s*/);var aw=ar.any=ar(function(aH,aG,aF){if(!aH){return aF(aH,"expected any character")}return aG(aH.slice(1),aH.charAt(0))});var aB=ar.all=ar(function(aH,aG,aF){return aG("",aH)});var aD=ar.eof=ar(function(aH,aG,aF){if(aH){return aF(aH,"expected EOF")}return aG(aH,aH)})});var z=h(function(P){P.prev=0;P.next=0;P.parent=0;P.firstChild=0;P.lastChild=0;P.children=function(){return G(this.firstChild,this.lastChild)};P.eachChild=function(ao){return this.children().each(ao)};P.foldChildren=function(ao,ap){return this.children().fold(ao,ap)};P.adopt=function(ap,aq,ao){G(this,this).adopt(ap,aq,ao);return this};P.disown=function(){G(this,this).disown();return this}});var G=h(function(P){P.first=0;P.last=0;P.init=function(aq,ap){ac("no half-empty fragments",!aq===!ap);if(!aq){return}ac("first node is passed to Fragment",aq instanceof z);ac("last node is passed to Fragment",ap instanceof z);ac("first and last have the same parent",aq.parent===ap.parent);this.first=aq;this.last=ap};function ao(aq,ar,ap){ac("a parent is always present",aq);ac("prev is properly set up",(function(){if(!ar){return aq.firstChild===ap}return ar.next===ap&&ar.parent===aq})());ac("next is properly set up",(function(){if(!ap){return aq.lastChild===ar}return ap.prev===ar&&ap.parent===aq})())}P.adopt=function(ar,au,aq){ao(ar,au,aq);var ap=this;ap.disowned=false;var av=ap.first;if(!av){return this}var at=ap.last;if(au){}else{ar.firstChild=av}if(aq){aq.prev=at}else{ar.lastChild=at}ap.last.next=aq;ap.each(function(aw){aw.prev=au;aw.parent=ar;if(au){au.next=aw}au=aw});return ap};P.disown=function(){var ap=this;var at=ap.first;if(!at||ap.disowned){return ap}ap.disowned=true;var ar=ap.last;var aq=at.parent;ao(aq,at.prev,at);ao(aq,ar,ar.next);if(at.prev){at.prev.next=ar.next}else{aq.firstChild=ar.next}if(ar.next){ar.next.prev=at.prev}else{aq.lastChild=at.prev}return ap};P.each=function(ar){var ap=this;var aq=ap.first;if(!aq){return ap}for(;aq!==ap.last.next;aq=aq.next){if(ar.call(ap,aq)===false){break}}return ap};P.fold=function(ap,aq){this.each(function(ar){ap=aq.call(this,ap,ar)});return ap}});var i=(function(){var P=0;return function(){return P+=1}})();var D=h(z,function(P){P.init=function(ao){this.id=i();D[this.id]=this};P.toString=function(){return"[MathElement "+this.id+"]"};P.bubble=function(ar){var ao=K.call(arguments,1);for(var aq=this;aq;aq=aq.parent){var ap=aq[ar]&&aq[ar].apply(aq,ao);if(ap===false){break}}return this};P.postOrder=function(aq){var ap=K.call(arguments,1);if(typeof aq==="string"){var ao=aq;aq=function(at){if(ao in at){at[ao].apply(at,arguments)}}}(function ar(at){at.eachChild(ar);aq(at)})(this)};P.jQ=O();P.jQadd=function(ao){this.jQ=this.jQ.add(ao)};this.jQize=function(ao){var ap=O(ao);ap.find("*").andSelf().each(function(){var at=O(this),aq=at.attr("mathquill-command-id"),ar=at.attr("mathquill-block-id");if(aq){D[aq].jQadd(at)}if(ar){D[ar].jQadd(at)}});return ap};P.finalizeInsert=function(){var ao=this;ao.postOrder("finalizeTree");ao.postOrder("blur");ao.postOrder("respace");if(ao.next.respace){ao.next.respace()}if(ao.prev.respace){ao.prev.respace()}ao.postOrder("redraw");ao.bubble("redraw")}});var B=h(D,function(P,ao){P.init=function(ar,at,ap){var aq=this;ao.init.call(aq);if(!aq.ctrlSeq){aq.ctrlSeq=ar}if(at){aq.htmlTemplate=at}if(ap){aq.textTemplate=ap}};P.replaces=function(ap){ap.disown();this.replacedFragment=ap};P.isEmpty=function(){return this.foldChildren(true,function(ap,aq){return ap&&aq.isEmpty()})};P.parser=function(){var aq=S.block;var ap=this;return aq.times(ap.numBlocks()).map(function(at){ap.blocks=at;for(var ar=0;ar<at.length;ar+=1){at[ar].adopt(ap,ap.lastChild,0)}return ap})};P.createBefore=function(ar){var ap=this;var aq=ap.replacedFragment;ap.createBlocks();D.jQize(ap.html());if(aq){aq.adopt(ap.firstChild,0,0);aq.jQ.appendTo(ap.firstChild.jQ)}ar.jQ.before(ap.jQ);ar.prev=ap.adopt(ar.parent,ar.prev,ar.next);ap.finalizeInsert(ar);ap.placeCursor(ar)};P.createBlocks=function(){var aq=this,at=aq.numBlocks(),ar=aq.blocks=Array(at);for(var ap=0;ap<at;ap+=1){var au=ar[ap]=v();au.adopt(aq,aq.lastChild,0)}};P.respace=af;P.placeCursor=function(ap){ap.appendTo(this.foldChildren(this.firstChild,function(aq,ar){return aq.isEmpty()?aq:ar}))};P.remove=function(){this.disown();this.jQ.remove();this.postOrder(function(ap){delete D[ap.id]});return this};P.numBlocks=function(){var ap=this.htmlTemplate.match(/&\d+/g);return ap?ap.length:0};P.html=function(){var au=this;var aw=au.blocks;var ap=" mathquill-command-id="+au.id;var av=au.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);ac("no unmatched angle brackets",av.join("")===this.htmlTemplate);for(var ar=0,aq=av[0];aq;ar+=1,aq=av[ar]){if(aq.slice(-2)==="/>"){av[ar]=aq.slice(0,-2)+ap+"/>"}else{if(aq.charAt(0)==="<"){ac("not an unmatched top-level close tag",aq.charAt(1)!=="/");av[ar]=aq.slice(0,-1)+ap+">";var at=1;do{ar+=1,aq=av[ar];ac("no missing close tags",aq);if(aq.slice(0,2)==="</"){at-=1}else{if(aq.charAt(0)==="<"&&aq.slice(-2)!=="/>"){at+=1}}}while(at>0)}}}return av.join("").replace(/>&(\d+)/g,function(ay,ax){return" mathquill-block-id="+aw[ax].id+">"+aw[ax].join("html")})};P.latex=function(){return this.foldChildren(this.ctrlSeq,function(ap,aq){return ap+"{"+(aq.latex()||" ")+"}"})};P.textTemplate=[""];P.text=function(){var ap=0;return this.foldChildren(this.textTemplate[ap],function(ar,at){ap+=1;var aq=at.text();if(ar&&this.textTemplate[ap]==="("&&aq[0]==="("&&aq.slice(-1)===")"){return ar+aq.slice(1,-1)+this.textTemplate[ap]}return ar+at.text()+(this.textTemplate[ap]||"")})}});var W=h(B,function(P,ao){P.init=function(aq,ap,ar){if(!ar){ar=aq&&aq.length>1?aq.slice(1):aq}ao.init.call(this,aq,ap,[ar])};P.parser=function(){return c.succeed(this)};P.numBlocks=function(){return 0};P.replaces=function(ap){ap.remove()};P.createBlocks=af;P.latex=function(){return this.ctrlSeq};P.text=function(){return this.textTemplate};P.placeCursor=af;P.isEmpty=function(){return true}});var v=h(D,function(P){P.join=function(ao){return this.foldChildren("",function(ap,aq){return ap+aq[ao]()})};P.latex=function(){return this.join("latex")};P.text=function(){return this.firstChild===this.lastChild?this.firstChild.text():"("+this.join("text")+")"};P.isEmpty=function(){return this.firstChild===0&&this.lastChild===0};P.focus=function(){this.jQ.addClass("hasCursor");this.jQ.removeClass("empty");return this};P.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){this.jQ.addClass("empty")}return this}});var Y=h(G,function(P,ao){P.init=function(aq,ap){ao.init.call(this,aq,ap||aq);this.jQ=this.fold(O(),function(ar,at){return at.jQ.add(ar)})};P.latex=function(){return this.fold("",function(aq,ap){return aq+ap.latex()})};P.remove=function(){this.jQ.remove();this.each(function(ap){ap.postOrder(function(aq){delete D[aq.id]})});return this.disown()}});function ae(au,ax,aw,ap){var aq=au.contents().detach();if(!aw){au.addClass("mathquill-rendered-math")}ax.jQ=au.attr(j,ax.id);ax.revert=function(){au.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(aq)};var aA=ax.cursor=I(ax);ax.renderLatex(aq.text());var aB=ax.textarea=O('<span class="textarea" math="true"><textarea math="true"></textarea></span>'),az=aB.children();var at;ax.selectionChanged=function(){if(at===s){at=setTimeout(P)}k(au[0])};function P(){at=s;var aC=aA.selection?"$"+aA.selection.latex()+"$":"";av.select(aC)}au.bind("selectstart.mathquill",function(aC){if(aC.target!==az[0]){aC.preventDefault()}aC.stopPropagation()});var ar,ao=aA.blink;au.bind("mousedown.mathquill",function(aD){function aC(aG){aA.seek(O(aG.target),aG.pageX,aG.pageY);if(aA.prev!==ar.prev||aA.parent!==ar.parent){aA.selectFrom(ar)}return false}function aF(aG){delete aG.target;return aC(aG)}function aE(aG){ar=s;aA.blink=ao;if(!aA.selection){if(ap){aA.show()}else{aB.detach()}}au.unbind("mousemove",aC);O(aG.target.ownerDocument).unbind("mousemove",aF).unbind("mouseup",aE)}setTimeout(function(){az.focus()});aA.blink=af;aA.seek(O(aD.target),aD.pageX,aD.pageY);ar={parent:aA.parent,prev:aA.prev,next:aA.next};if(!ap){au.prepend(aB)}au.mousemove(aC);O(aD.target.ownerDocument).mousemove(aF).mouseup(aE);return false});if(!ap){var av=l(az,{container:au});au.bind("cut paste",false).bind("copy",P).prepend('<span math="true" class="selectable" >$'+ax.latex()+"$</span>");az.blur(function(){aA.clearSelection();setTimeout(ay)});function ay(){aB.detach()}return}var av=l(az,{container:au,key:function(aD,aC){aA.parent.bubble("onKey",aD,aC)},text:function(aC){aA.parent.bubble("onText",aC)},cut:function(aC){if(aA.selection){setTimeout(function(){aA.prepareEdit();aA.parent.bubble("redraw")})}aC.stopPropagation()},paste:function(aC){if(aC.slice(0,1)==="$"&&aC.slice(-1)==="$"){aC=aC.slice(1,-1)}else{aC="\\text{"+aC+"}"}aA.writeLatex(aC).show()}});au.prepend(aB);au.addClass("mathquill-editable");if(aw){au.addClass("mathquill-textbox")}az.focus(function(aC){if(!aA.parent){aA.appendTo(ax)}aA.parent.jQ.addClass("hasCursor");if(aA.selection){aA.selection.jQ.removeClass("blur");setTimeout(ax.selectionChanged)}else{aA.show()}aC.stopPropagation()}).blur(function(aC){aA.hide().parent.blur();if(aA.selection){aA.selection.jQ.addClass("blur")}aC.stopPropagation()});au.bind("focus.mathquill blur.mathquill",function(aC){az.trigger(aC)}).blur()}var m=h(v,function(P,ao){P.latex=function(){return ao.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};P.text=function(){return this.foldChildren("",function(ap,aq){return ap+aq.text()})};P.renderLatex=function(ap){var aq=this.jQ;aq.children().slice(1).remove();this.firstChild=this.lastChild=0;this.cursor.appendTo(this).writeLatex(ap)};P.onKey=function(ap,ar){switch(ap){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(this.cursor.prev||this.cursor.selection){this.cursor.backspace()}break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":var aq=this.cursor.parent;if(aq===this.cursor.root){if(ap==="Spacebar"){ar.preventDefault()}return}this.cursor.prepareMove();if(aq.next){this.cursor.prependTo(aq.next)}else{this.cursor.insertAfter(aq.parent)}break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":var aq=this.cursor.parent;if(aq===this.cursor.root){if(ap==="Shift-Spacebar"){ar.preventDefault()}return}this.cursor.prepareMove();if(aq.prev){this.cursor.appendTo(aq.prev)}else{this.cursor.insertBefore(aq.parent)}break;case"Enter":break;case"End":this.cursor.prepareMove().appendTo(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().appendTo(this);break;case"Shift-End":while(this.cursor.next){this.cursor.selectRight()}break;case"Ctrl-Shift-End":while(this.cursor.next||this.cursor.parent!==this){this.cursor.selectRight()}break;case"Home":this.cursor.prepareMove().prependTo(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().prependTo(this);break;case"Shift-Home":while(this.cursor.prev){this.cursor.selectLeft()}break;case"Ctrl-Shift-Home":while(this.cursor.prev||this.cursor.parent!==this){this.cursor.selectLeft()}break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor.prev){while(this.cursor.prev){this.cursor.selectLeft()}}else{this.cursor.selectLeft()}case"Shift-Down":if(this.cursor.next){while(this.cursor.next){this.cursor.selectRight()}}else{this.cursor.selectRight()}case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(this.cursor.next||this.cursor.selection){this.cursor.deleteForward()}break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root){return}this.cursor.prepareMove().appendTo(this);while(this.cursor.prev){this.cursor.selectLeft()}break;default:return false}ar.preventDefault();return false};P.onText=function(ap){this.cursor.write(ap);return false}});var ah=h(B,function(P,ao){P.init=function(ap){ao.init.call(this,"$");this.cursor=ap};P.htmlTemplate='<span math="true" class="mathquill-rendered-math">&0</span>';P.createBlocks=function(){this.firstChild=this.lastChild=m();this.blocks=[this.firstChild];this.firstChild.parent=this;var ap=this.firstChild.cursor=this.cursor;this.firstChild.onText=function(aq){if(aq!=="$"||ap.parent!==this){ap.write(aq)}else{if(this.isEmpty()){ap.insertAfter(this.parent).backspace().insertNew(aa("\\$","$")).show()}else{if(!ap.next){ap.insertAfter(this.parent)}else{if(!ap.prev){ap.insertBefore(this.parent)}else{ap.write(aq)}}}}return false}};P.latex=function(){return"$"+this.firstChild.latex()+"$"}});var U=h(v,function(P){P.renderLatex=function(ar){var aC=this;var aA=aC.cursor;aC.jQ.children().slice(1).remove();aC.firstChild=aC.lastChild=0;aA.show().appendTo(aC);var ax=c.regex;var av=c.string;var aB=c.eof;var az=c.all;var aw=av("$").then(S).skip(av("$").or(aB)).map(function(aF){var aE=ah(aA);aE.createBlocks();var aD=aE.firstChild;aF.children().adopt(aD,0,0);return aE});var ay=av("\\$").result("$");var ap=ay.or(ax(/^[^$]/)).map(aa);var ao=aw.or(ap).many();var aq=ao.skip(aB).or(az.result(false)).parse(ar);if(aq){for(var at=0;at<aq.length;at+=1){aq[at].adopt(aC,aC.lastChild,0)}var au=aC.join("html");D.jQize(au).appendTo(aC.jQ);this.finalizeInsert()}};P.onKey=m.prototype.onKey;P.onText=function(ao){this.cursor.prepareEdit();if(ao==="$"){this.cursor.insertNew(ah(this.cursor))}else{this.cursor.insertNew(aa(ao))}return false}});var x={},J={};var Q,k=af,ag=document.createElement("div"),am=ag.style,F={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},a;for(var w in F){if(w in am){a=w;break}}if(a){Q=function(ao,P,ap){ao.css(a,"scale("+P+","+ap+")")}}else{if("filter" in am){k=function(P){P.className=P.className};Q=function(aq,P,at){P/=(1+(at-1)/2);aq.css("fontSize",at+"em");if(!aq.hasClass("matrixed-container")){aq.addClass("matrixed-container").wrapInner('<span math="true" class="matrixed"></span>')}var ar=aq.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+P+",SizingMethod='auto expand')");function ap(){aq.css("marginRight",(ar.width()-1)*(P-1)/P+"px")}ap();var ao=setInterval(ap);O(window).load(function(){clearTimeout(ao);ap()})}}else{Q=function(ao,P,ap){ao.css("fontSize",ap+"em")}}}var H=h(B,function(P,ao){P.init=function(ar,aq,ap){ao.init.call(this,ar,"<"+aq+" "+ap+' math="true">&0</'+aq+">")}});J.mathrm=e(H,"\\mathrm","span",'class="roman font"');J.mathit=e(H,"\\mathit","i",'class="font"');J.mathbf=e(H,"\\mathbf","b",'class="font"');J.mathsf=e(H,"\\mathsf","span",'class="sans-serif font"');J.mathtt=e(H,"\\mathtt","span",'class="monospace font"');J.underline=e(H,"\\underline","span",'class="non-leaf underline"');J.overline=J.bar=e(H,"\\overline","span",'class="non-leaf overline"');var al=h(B,function(P,ao){P.init=function(aq,ap,ar){ao.init.call(this,aq,"<"+ap+' class="non-leaf" math="true">&0</'+ap+">",[ar])};P.finalizeTree=function(){ac("SupSub is only _ and ^",this.ctrlSeq==="^"||this.ctrlSeq==="_");if(this.ctrlSeq==="_"){this.down=this.firstChild;this.firstChild.up=ap}else{this.up=this.firstChild;this.firstChild.down=ap}function ap(at){var aq=this.parent,ar=at;do{if(ar.next){at.insertBefore(aq);return false}ar=ar.parent.parent}while(ar!==aq);at.insertAfter(aq);return false}};P.latex=function(){var ap=this.firstChild.latex();if(ap.length===1){return this.ctrlSeq+ap}else{return this.ctrlSeq+"{"+(ap||" ")+"}"}};P.redraw=function(){if(this.prev){this.prev.respace()}if(!(this.prev instanceof al)){this.respace();if(this.next&&!(this.next instanceof al)){this.next.respace()}}};P.respace=function(){if(this.prev.ctrlSeq==="\\int "||(this.prev instanceof al&&this.prev.ctrlSeq!=this.ctrlSeq&&this.prev.prev&&this.prev.prev.ctrlSeq==="\\int ")){if(!this.limit){this.limit=true;this.jQ.addClass("limit")}}else{if(this.limit){this.limit=false;this.jQ.removeClass("limit")}}this.respaced=this.prev instanceof al&&this.prev.ctrlSeq!=this.ctrlSeq&&!this.prev.respaced;if(this.respaced){var aq=+this.jQ.css("fontSize").slice(0,-2),ap=this.prev.jQ.outerWidth(),ar=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&this.ctrlSeq==="_"?-0.25:0)-ap/aq+"em",marginRight:0.1-ak(ar,ap)/aq+"em"})}else{if(this.limit&&this.ctrlSeq==="_"){this.jQ.css({left:"-.25em",marginRight:""})}else{this.jQ.css({left:"",marginRight:""})}}if(this.next instanceof al){this.next.respace()}return this}});J.subscript=J._=e(al,"_","sub","_");J.superscript=J.supscript=J["^"]=e(al,"^","sup","**");var Z=J.frac=J.dfrac=J.cfrac=J.fraction=h(B,function(P,ao){P.ctrlSeq="\\frac";P.htmlTemplate='<span math="true" class="fraction non-leaf"><span math="true" class="numerator">&0</span><span math="true" class="denominator">&1</span><span math="true" style="display:inline-block;width:0">&nbsp;</span></span>';P.textTemplate=["(","/",")"];P.finalizeTree=function(){this.up=this.lastChild.up=this.firstChild;this.down=this.firstChild.down=this.lastChild}});var g=J.over=x["/"]=h(Z,function(P,ao){P.createBefore=function(aq){if(!this.replacedFragment){var ap=aq.prev;while(ap&&!(ap instanceof ai||ap instanceof ab||ap instanceof u)){ap=ap.prev}if(ap instanceof u&&ap.next instanceof al){ap=ap.next;if(ap.next instanceof al&&ap.next.ctrlSeq!=ap.ctrlSeq){ap=ap.next}}if(ap!==aq.prev){this.replaces(Y(ap.next||aq.parent.firstChild,aq.prev));aq.prev=ap}}ao.createBefore.call(this,aq)}});var t=J.sqrt=J["√"]=h(B,function(P,ao){P.ctrlSeq="\\sqrt";P.htmlTemplate='<span math="true" class="non-leaf"><span math="true" class="scaled sqrt-prefix">&radic;</span><span math="true" class="non-leaf sqrt-stem">&0</span></span>';P.textTemplate=["sqrt(",")"];P.parser=function(){return S.optBlock.then(function(ap){return S.block.map(function(ar){var aq=aj();aq.blocks=[ap,ar];ap.adopt(aq,0,0);ar.adopt(aq,ap,0);return aq})}).or(ao.parser.call(this))};P.redraw=function(){var ap=this.lastChild.jQ;Q(ap.prev(),1,ap.innerHeight()/+ap.css("fontSize").slice(0,-2)-0.1)}});var aj=J.nthroot=h(t,function(P,ao){P.htmlTemplate='<sup math="true" class="nthroot non-leaf">&0</sup><span math="true" class="scaled"><span math="true" class="sqrt-prefix scaled">&radic;</span><span math="true" class="sqrt-stem non-leaf">&1</span></span>';P.textTemplate=["sqrt[","](",")"];P.latex=function(){return"\\sqrt["+this.firstChild.latex()+"]{"+this.lastChild.latex()+"}"}});var A=h(B,function(P,ao){P.init=function(aq,at,ar,ap){ao.init.call(this,"\\left"+ar,'<span math="true" class="non-leaf"><span math="true" class="scaled paren">'+aq+'</span><span math="true" class="non-leaf">&0</span><span math="true" class="scaled paren">'+at+"</span></span>",[aq,at]);this.end="\\right"+ap};P.jQadd=function(){ao.jQadd.apply(this,arguments);var ap=this.jQ;this.bracketjQs=ap.children(":first").add(ap.children(":last"))};P.latex=function(){return this.ctrlSeq+this.firstChild.latex()+this.end};P.redraw=function(){var aq=this.firstChild.jQ;var ap=aq.outerHeight()/+aq.css("fontSize").slice(0,-2);Q(this.bracketjQs,ak(1+0.2*(ap-1),1.2),1.05*ap)}});J.left=h(B,function(P){P.parser=function(){var ap=c.regex;var ao=c.string;var ap=c.regex;var aq=c.succeed;var at=S.block;var ar=c.optWhitespace;return ar.then(ap(/^(?:[([|]|\\\{)/)).then(function(au){if(au.charAt(0)==="\\"){au=au.slice(1)}var av=x[au]();return S.map(function(aw){av.blocks=[aw];aw.adopt(av,0,0)}).then(ao("\\right")).skip(ar).then(ap(/^(?:[\])|]|\\\})/)).then(function(aw){if(aw.slice(-1)!==av.end.slice(-1)){return c.fail("open doesn't match close")}return aq(av)})})}});J.right=h(B,function(P){P.parser=function(){return c.fail("unmatched \\right")}});J.lbrace=x["{"]=e(A,"{","}","\\{","\\}");J.langle=J.lang=e(A,"&lang;","&rang;","\\langle ","\\rangle ");var V=h(A,function(P,ao){P.createBefore=function(ap){if(!ap.next&&ap.parent.parent&&ap.parent.parent.end===this.end&&!this.replacedFragment){ap.insertAfter(ap.parent.parent)}else{ao.createBefore.call(this,ap)}};P.placeCursor=function(ap){this.firstChild.blur();ap.insertAfter(this)}});J.rbrace=x["}"]=e(V,"{","}","\\{","\\}");J.rangle=J.rang=e(V,"&lang;","&rang;","\\langle ","\\rangle ");var q=function(P,ao){P.init=function(ap,aq){ao.init.call(this,ap,aq,ap,aq)}};var L=h(A,q);J.lparen=x["("]=e(L,"(",")");J.lbrack=J.lbracket=x["["]=e(L,"[","]");var N=h(V,q);J.rparen=x[")"]=e(N,"(",")");J.rbrack=J.rbracket=x["]"]=e(N,"[","]");var b=J.lpipe=J.rpipe=x["|"]=h(L,function(P,ao){P.init=function(){ao.init.call(this,"|","|")};P.createBefore=V.prototype.createBefore});var ab=x.$=J.text=J.textnormal=J.textrm=J.textup=J.textmd=h(B,function(P,ao){P.ctrlSeq="\\text";P.htmlTemplate='<span math="true" class="text">&0</span>';P.replaces=function(ap){if(ap instanceof Y){this.replacedText=ap.remove().jQ.text()}else{if(typeof ap==="string"){this.replacedText=ap}}};P.textTemplate=['"','"'];P.parser=function(){var ap=c.string;var aq=c.regex;var ar=c.optWhitespace;return ar.then(ap("{")).then(aq(/^[^}]*/)).skip(ap("}")).map(function(ax){var av=ab();av.createBlocks();var aw=av.firstChild;for(var at=0;at<ax.length;at+=1){var au=aa(ax.charAt(at));au.adopt(aw,aw.lastChild,0)}return av})};P.createBlocks=function(){this.firstChild=this.lastChild=p();this.blocks=[this.firstChild];this.firstChild.parent=this};P.finalizeInsert=function(){this.firstChild.blur=function(){delete this.blur;return this};ao.finalizeInsert.call(this)};P.createBefore=function(aq){ao.createBefore.call(this,this.cursor=aq);if(this.replacedText){for(var ap=0;ap<this.replacedText.length;ap+=1){this.write(this.replacedText.charAt(ap))}}};P.write=function(ap){this.cursor.insertNew(aa(ap))};P.onKey=function(ap,aq){if(!this.cursor.selection&&((ap==="Backspace"&&!this.cursor.prev)||(ap==="Del"&&!this.cursor.next))){if(this.isEmpty()){this.cursor.insertAfter(this)}return false}};P.onText=function(aq){this.cursor.prepareEdit();if(aq!=="$"){this.write(aq)}else{if(this.isEmpty()){this.cursor.insertAfter(this).backspace().insertNew(aa("\\$","$"))}else{if(!this.cursor.next){this.cursor.insertAfter(this)}else{if(!this.cursor.prev){this.cursor.insertBefore(this)}else{var ap=ab(Y(this.cursor.next,this.firstChild.lastChild));ap.placeCursor=function(ar){this.prev=0;delete this.placeCursor;this.placeCursor(ar)};ap.firstChild.focus=function(){return this};this.cursor.insertAfter(this).insertNew(ap);ap.prev=this;this.cursor.insertBefore(ap);delete ap.firstChild.focus}}}}return false}});var p=h(v,function(P,ao){P.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){var ap=this.parent,aq=ap.cursor;if(aq.parent===this){this.jQ.addClass("empty")}else{aq.hide();ap.remove();if(aq.next===ap){aq.next=ap.next}else{if(aq.prev===ap){aq.prev=ap.prev}}aq.show().parent.bubble("redraw")}}return this};P.focus=function(){ao.focus.call(this);var aq=this.parent;if(aq.next.ctrlSeq===aq.ctrlSeq){var at=this,ar=aq.cursor,ap=aq.next.firstChild;ap.eachChild(function(au){au.parent=at;au.jQ.appendTo(at.jQ)});if(this.lastChild){this.lastChild.next=ap.firstChild}else{this.firstChild=ap.firstChild}ap.firstChild.prev=this.lastChild;this.lastChild=ap.lastChild;ap.parent.remove();if(ar.prev){ar.insertAfter(ar.prev)}else{ar.prependTo(this)}ar.parent.bubble("redraw")}else{if(aq.prev.ctrlSeq===aq.ctrlSeq){var ar=aq.cursor;if(ar.prev){aq.prev.firstChild.focus()}else{ar.appendTo(aq.prev.firstChild)}}}return this}});function n(ap,ao,P){return h(ab,{ctrlSeq:ap,htmlTemplate:"<"+ao+" "+P+' math="true">&0</'+ao+">"})}J.em=J.italic=J.italics=J.emph=J.textit=J.textsl=n("\\textit","i",'class="text"');J.strong=J.bold=J.textbf=n("\\textbf","b",'class="text"');J.sf=J.textsf=n("\\textsf","span",'class="sans-serif text"');J.tt=J.texttt=n("\\texttt","span",'class="monospace text"');J.textsc=n("\\textsc","span",'style="font-variant:small-caps" class="text"');J.uppercase=n("\\uppercase","span",'style="text-transform:uppercase" class="text"');J.lowercase=n("\\lowercase","span",'style="text-transform:lowercase" class="text"');var X=x["\\"]=h(B,function(P,ao){P.ctrlSeq="\\";P.replaces=function(ap){this._replacedFragment=ap.disown();this.isEmpty=function(){return false}};P.htmlTemplate='<span math="true" class="latex-command-input non-leaf">\\<span math="true">&0</span></span>';P.textTemplate=["\\"];P.createBlocks=function(){ao.createBlocks.call(this);this.firstChild.focus=function(){this.parent.jQ.addClass("hasCursor");if(this.isEmpty()){this.parent.jQ.removeClass("empty")}return this};this.firstChild.blur=function(){this.parent.jQ.removeClass("hasCursor");if(this.isEmpty()){this.parent.jQ.addClass("empty")}return this}};P.createBefore=function(aq){ao.createBefore.call(this,aq);this.cursor=aq.appendTo(this.firstChild);if(this._replacedFragment){var ap=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(ar){O(ar.target=ap).trigger(ar);return false}).insertBefore(this.jQ).add(this.jQ)}};P.latex=function(){return"\\"+this.firstChild.latex()+" "};P.onKey=function(ap,aq){if(ap==="Tab"||ap==="Enter"||ap==="Spacebar"){this.renderCommand();aq.preventDefault();return false}};P.onText=function(ap){if(ap.match(/[a-z]/i)){this.cursor.prepareEdit();this.cursor.insertNew(aa(ap));return false}this.renderCommand();if(ap==="\\"&&this.firstChild.isEmpty()){return false}};P.renderCommand=function(){this.jQ=this.jQ.last();this.remove();if(this.next){this.cursor.insertBefore(this.next)}else{this.cursor.appendTo(this.parent)}var aq=this.firstChild.latex(),ap;if(!aq){aq="backslash"}this.cursor.insertCmd(aq,this._replacedFragment)}});var M=J.binom=J.binomial=h(B,function(P,ao){P.ctrlSeq="\\binom";P.htmlTemplate='<span math="true" class="paren scaled">(</span><span math="true" class="non-leaf"><span math="true" class="array non-leaf"><span math="true">&0</span><span math="true">&1</span></span></span><span math="true" class="paren scaled">)</span>';P.textTemplate=["choose(",",",")"];P.redraw=function(){var ar=this.jQ.eq(1);var ap=ar.outerHeight()/+ar.css("fontSize").slice(0,-2);var aq=this.jQ.filter(".paren");Q(aq,ak(1+0.2*(ap-1),1.2),1.05*ap)}});var o=J.choose=h(M,function(P){P.createBefore=g.prototype.createBefore});var C=J.vector=h(B,function(P,ao){P.ctrlSeq="\\vector";P.htmlTemplate='<span math="true" class="array"><span math="true">&0</span></span>';P.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(ap,aq){ap.push(aq.latex());return ap}).join("\\\\")+"\\end{matrix}"};P.text=function(){return"["+this.foldChildren([],function(ap,aq){ap.push(aq.text());return ap}).join()+"]"};P.createBefore=function(ap){ao.createBefore.call(this,this.cursor=ap)};P.onKey=function(ap,ar){var aq=this.cursor.parent;if(aq.parent===this){if(ap==="Enter"){var at=v();at.parent=this;at.jQ=O('<span math="true"></span>').attr(j,at.id).insertAfter(aq.jQ);if(aq.next){aq.next.prev=at}else{this.lastChild=at}at.next=aq.next;aq.next=at;at.prev=aq;this.bubble("redraw").cursor.appendTo(at);ar.preventDefault();return false}else{if(ap==="Tab"&&!aq.next){if(aq.isEmpty()){if(aq.prev){this.cursor.insertAfter(this);delete aq.prev.next;this.lastChild=aq.prev;aq.jQ.remove();this.bubble("redraw");ar.preventDefault();return false}else{return}}var at=v();at.parent=this;at.jQ=O('<span math="true"></span>').attr(j,at.id).appendTo(this.jQ);this.lastChild=at;aq.next=at;at.prev=aq;this.bubble("redraw").cursor.appendTo(at);ar.preventDefault();return false}else{if(ar.which===8){if(aq.isEmpty()){if(aq.prev){this.cursor.appendTo(aq.prev);aq.prev.next=aq.next}else{this.cursor.insertBefore(this);this.firstChild=aq.next}if(aq.next){aq.next.prev=aq.prev}else{this.lastChild=aq.prev}aq.jQ.remove();if(this.isEmpty()){this.cursor.deleteForward()}else{this.bubble("redraw")}ar.preventDefault();return false}else{if(!this.cursor.prev){ar.preventDefault();return false}}}}}}}});J.editable=h(ah,function(P,ao){P.init=function(){B.prototype.init.call(this,"\\editable")};P.jQadd=function(){var ap=this;ao.jQadd.apply(ap,arguments);var aq=ap.firstChild.disown();var ar=ap.jQ.children().detach();ap.firstChild=ap.lastChild=m();ap.blocks=[ap.firstChild];ap.firstChild.parent=ap;ae(ap.jQ,ap.firstChild,false,true);ap.cursor=ap.firstChild.cursor;aq.children().adopt(ap.firstChild,0,0);ar.appendTo(ap.firstChild.jQ);ap.firstChild.cursor.appendTo(ap.firstChild)};P.latex=function(){return this.firstChild.latex()};P.text=function(){return this.firstChild.text()}});J.f=e(W,"f",'<var math="true" class="florin">&fnof;</var><span math="true" style="display:inline-block;width:0">&nbsp;</span>');var r=h(W,function(P,ao){P.init=function(aq,ap){ao.init.call(this,aq,'<var math="true">'+(ap||aq)+"</var>")};P.text=function(){var ap=this.ctrlSeq;if(this.prev&&!(this.prev instanceof r)&&!(this.prev instanceof ai)){ap="*"+ap}if(this.next&&!(this.next instanceof ai)&&!(this.next.ctrlSeq==="^")){ap+="*"}return ap}});var aa=h(W,function(P,ao){P.init=function(aq,ap){ao.init.call(this,aq,'<span math="true">'+(ap||aq)+"</span>")}});x[" "]=e(aa,"\\:"," ");J.prime=x["'"]=e(aa,"'","&prime;");var f=h(W,function(P,ao){P.init=function(aq,ap){ao.init.call(this,aq,'<span math="true" class="nonSymbola">'+(ap||aq)+"</span>")}});J["@"]=f;J["&"]=e(f,"\\&","&amp;");J["%"]=e(f,"\\%","%");J.alpha=J.beta=J.gamma=J.delta=J.zeta=J.eta=J.theta=J.iota=J.kappa=J.mu=J.nu=J.xi=J.rho=J.sigma=J.tau=J.chi=J.psi=J.omega=h(r,function(P,ao){P.init=function(ap){ao.init.call(this,"\\"+ap+" ","&"+ap+";")}});J.phi=e(r,"\\phi ","&#981;");J.phiv=J.varphi=e(r,"\\varphi ","&phi;");J.epsilon=e(r,"\\epsilon ","&#1013;");J.epsiv=J.varepsilon=e(r,"\\varepsilon ","&epsilon;");J.piv=J.varpi=e(r,"\\varpi ","&piv;");J.sigmaf=J.sigmav=J.varsigma=e(r,"\\varsigma ","&sigmaf;");J.thetav=J.vartheta=J.thetasym=e(r,"\\vartheta ","&thetasym;");J.upsilon=J.upsi=e(r,"\\upsilon ","&upsilon;");J.gammad=J.Gammad=J.digamma=e(r,"\\digamma ","&#989;");J.kappav=J.varkappa=e(r,"\\varkappa ","&#1008;");J.rhov=J.varrho=e(r,"\\varrho ","&#1009;");J.pi=J["π"]=e(f,"\\pi ","&pi;");J.lambda=e(f,"\\lambda ","&lambda;");J.Upsilon=J.Upsi=J.upsih=J.Upsih=e(W,"\\Upsilon ",'<var math="true" style="font-family: serif">&upsih;</var>');J.Gamma=J.Delta=J.Theta=J.Lambda=J.Xi=J.Pi=J.Sigma=J.Phi=J.Psi=J.Omega=J.forall=h(aa,function(P,ao){P.init=function(ap){ao.init.call(this,"\\"+ap+" ","&"+ap+";")}});var ad=h(B,function(P){P.init=function(ao){this.latex=ao};P.createBefore=function(ao){ao.writeLatex(this.latex)};P.parser=function(){var ao=S.parse(this.latex).children();return c.succeed(ao)}});J["¹"]=e(ad,"^1");J["²"]=e(ad,"^2");J["³"]=e(ad,"^3");J["¼"]=e(ad,"\\frac14");J["½"]=e(ad,"\\frac12");J["¾"]=e(ad,"\\frac34");var ai=h(W,function(P,ao){P.init=function(aq,ap,ar){ao.init.call(this,aq,'<span math="true" class="binary-operator">'+ap+"</span>",ar)}});var d=h(ai,function(P){P.init=aa.prototype.init;P.respace=function(){if(!this.prev){this.jQ[0].className=""}else{if(this.prev instanceof ai&&this.next&&!(this.next instanceof ai)){this.jQ[0].className="unary-operator"}else{this.jQ[0].className="binary-operator"}}return this}});J["+"]=e(d,"+","+");J["–"]=J["-"]=e(d,"-","&minus;");J["±"]=J.pm=J.plusmn=J.plusminus=e(d,"\\pm ","&plusmn;");J.mp=J.mnplus=J.minusplus=e(d,"\\mp ","&#8723;");x["*"]=J.sdot=J.cdot=e(ai,"\\cdot ","&middot;");J["="]=e(ai,"=","=");J["<"]=e(ai,"<","&lt;");J[">"]=e(ai,">","&gt;");J.notin=J.sim=J.cong=J.equiv=J.oplus=J.otimes=h(ai,function(P,ao){P.init=function(ap){ao.init.call(this,"\\"+ap+" ","&"+ap+";")}});J.times=e(ai,"\\times ","&times;","[x]");J["÷"]=J.div=J.divide=J.divides=e(ai,"\\div ","&divide;","[/]");J["≠"]=J.ne=J.neq=e(ai,"\\ne ","&ne;");J.ast=J.star=J.loast=J.lowast=e(ai,"\\ast ","&lowast;");J.therefor=J.therefore=e(ai,"\\therefore ","&there4;");J.cuz=J.because=e(ai,"\\because ","&#8757;");J.prop=J.propto=e(ai,"\\propto ","&prop;");J["≈"]=J.asymp=J.approx=e(ai,"\\approx ","&asymp;");J.lt=e(ai,"<","&lt;");J.gt=e(ai,">","&gt;");J["≤"]=J.le=J.leq=e(ai,"\\le ","&le;");J["≥"]=J.ge=J.geq=e(ai,"\\ge ","&ge;");J.isin=J["in"]=e(ai,"\\in ","&isin;");J.ni=J.contains=e(ai,"\\ni ","&ni;");J.notni=J.niton=J.notcontains=J.doesnotcontain=e(ai,"\\not\\ni ","&#8716;");J.sub=J.subset=e(ai,"\\subset ","&sub;");J.sup=J.supset=J.superset=e(ai,"\\supset ","&sup;");J.nsub=J.notsub=J.nsubset=J.notsubset=e(ai,"\\not\\subset ","&#8836;");J.nsup=J.notsup=J.nsupset=J.notsupset=J.nsuperset=J.notsuperset=e(ai,"\\not\\supset ","&#8837;");J.sube=J.subeq=J.subsete=J.subseteq=e(ai,"\\subseteq ","&sube;");J.supe=J.supeq=J.supsete=J.supseteq=J.supersete=J.superseteq=e(ai,"\\supseteq ","&supe;");J.nsube=J.nsubeq=J.notsube=J.notsubeq=J.nsubsete=J.nsubseteq=J.notsubsete=J.notsubseteq=e(ai,"\\not\\subseteq ","&#8840;");J.nsupe=J.nsupeq=J.notsupe=J.notsupeq=J.nsupsete=J.nsupseteq=J.notsupsete=J.notsupseteq=J.nsupersete=J.nsuperseteq=J.notsupersete=J.notsuperseteq=e(ai,"\\not\\supseteq ","&#8841;");var u=h(W,function(P,ao){P.init=function(aq,ap){ao.init.call(this,aq,'<big math="true">'+ap+"</big>")}});J["∑"]=J.sum=J.summation=e(u,"\\sum ","&sum;");J["∏"]=J.prod=J.product=e(u,"\\prod ","&prod;");J.coprod=J.coproduct=e(u,"\\coprod ","&#8720;");J["∫"]=J["int"]=J.integral=e(u,"\\int ","&int;");J.N=J.naturals=J.Naturals=e(aa,"\\mathbb{N}","&#8469;");J.P=J.primes=J.Primes=J.projective=J.Projective=J.probability=J.Probability=e(aa,"\\mathbb{P}","&#8473;");J.Z=J.integers=J.Integers=e(aa,"\\mathbb{Z}","&#8484;");J.Q=J.rationals=J.Rationals=e(aa,"\\mathbb{Q}","&#8474;");J.R=J.reals=J.Reals=e(aa,"\\mathbb{R}","&#8477;");J.C=J.complex=J.Complex=J.complexes=J.Complexes=J.complexplane=J.Complexplane=J.ComplexPlane=e(aa,"\\mathbb{C}","&#8450;");J.H=J.Hamiltonian=J.quaternions=J.Quaternions=e(aa,"\\mathbb{H}","&#8461;");J.quad=J.emsp=e(aa,"\\quad ","    ");J.qquad=e(aa,"\\qquad ","        ");J.diamond=e(aa,"\\diamond ","&#9671;");J.bigtriangleup=e(aa,"\\bigtriangleup ","&#9651;");J.ominus=e(aa,"\\ominus ","&#8854;");J.uplus=e(aa,"\\uplus ","&#8846;");J.bigtriangledown=e(aa,"\\bigtriangledown ","&#9661;");J.sqcap=e(aa,"\\sqcap ","&#8851;");J.triangleleft=e(aa,"\\triangleleft ","&#8882;");J.sqcup=e(aa,"\\sqcup ","&#8852;");J.triangleright=e(aa,"\\triangleright ","&#8883;");J.odot=e(aa,"\\odot ","&#8857;");J.bigcirc=e(aa,"\\bigcirc ","&#9711;");J.dagger=e(aa,"\\dagger ","&#0134;");J.ddagger=e(aa,"\\ddagger ","&#135;");J.wr=e(aa,"\\wr ","&#8768;");J.amalg=e(aa,"\\amalg ","&#8720;");J.models=e(aa,"\\models ","&#8872;");J.prec=e(aa,"\\prec ","&#8826;");J.succ=e(aa,"\\succ ","&#8827;");J.preceq=e(aa,"\\preceq ","&#8828;");J.succeq=e(aa,"\\succeq ","&#8829;");J.simeq=e(aa,"\\simeq ","&#8771;");J.mid=e(aa,"\\mid ","&#8739;");J.ll=e(aa,"\\ll ","&#8810;");J.gg=e(aa,"\\gg ","&#8811;");J.parallel=e(aa,"\\parallel ","&#8741;");J.bowtie=e(aa,"\\bowtie ","&#8904;");J.sqsubset=e(aa,"\\sqsubset ","&#8847;");J.sqsupset=e(aa,"\\sqsupset ","&#8848;");J.smile=e(aa,"\\smile ","&#8995;");J.sqsubseteq=e(aa,"\\sqsubseteq ","&#8849;");J.sqsupseteq=e(aa,"\\sqsupseteq ","&#8850;");J.doteq=e(aa,"\\doteq ","&#8784;");J.frown=e(aa,"\\frown ","&#8994;");J.vdash=e(aa,"\\vdash ","&#8870;");J.dashv=e(aa,"\\dashv ","&#8867;");J.longleftarrow=e(aa,"\\longleftarrow ","&#8592;");J.longrightarrow=e(aa,"\\longrightarrow ","&#8594;");J.Longleftarrow=e(aa,"\\Longleftarrow ","&#8656;");J.Longrightarrow=e(aa,"\\Longrightarrow ","&#8658;");J.longleftrightarrow=e(aa,"\\longleftrightarrow ","&#8596;");J.updownarrow=e(aa,"\\updownarrow ","&#8597;");J.Longleftrightarrow=e(aa,"\\Longleftrightarrow ","&#8660;");J.Updownarrow=e(aa,"\\Updownarrow ","&#8661;");J.mapsto=e(aa,"\\mapsto ","&#8614;");J.nearrow=e(aa,"\\nearrow ","&#8599;");J.hookleftarrow=e(aa,"\\hookleftarrow ","&#8617;");J.hookrightarrow=e(aa,"\\hookrightarrow ","&#8618;");J.searrow=e(aa,"\\searrow ","&#8600;");J.leftharpoonup=e(aa,"\\leftharpoonup ","&#8636;");J.rightharpoonup=e(aa,"\\rightharpoonup ","&#8640;");J.swarrow=e(aa,"\\swarrow ","&#8601;");J.leftharpoondown=e(aa,"\\leftharpoondown ","&#8637;");J.rightharpoondown=e(aa,"\\rightharpoondown ","&#8641;");J.nwarrow=e(aa,"\\nwarrow ","&#8598;");J.ldots=e(aa,"\\ldots ","&#8230;");J.cdots=e(aa,"\\cdots ","&#8943;");J.vdots=e(aa,"\\vdots ","&#8942;");J.ddots=e(aa,"\\ddots ","&#8944;");J.surd=e(aa,"\\surd ","&#8730;");J.triangle=e(aa,"\\triangle ","&#9653;");J.ell=e(aa,"\\ell ","&#8467;");J.top=e(aa,"\\top ","&#8868;");J.flat=e(aa,"\\flat ","&#9837;");J.natural=e(aa,"\\natural ","&#9838;");J.sharp=e(aa,"\\sharp ","&#9839;");J.wp=e(aa,"\\wp ","&#8472;");J.bot=e(aa,"\\bot ","&#8869;");J.clubsuit=e(aa,"\\clubsuit ","&#9827;");J.diamondsuit=e(aa,"\\diamondsuit ","&#9826;");J.heartsuit=e(aa,"\\heartsuit ","&#9825;");J.spadesuit=e(aa,"\\spadesuit ","&#9824;");J.oint=e(aa,"\\oint ","&#8750;");J.bigcap=e(aa,"\\bigcap ","&#8745;");J.bigcup=e(aa,"\\bigcup ","&#8746;");J.bigsqcup=e(aa,"\\bigsqcup ","&#8852;");J.bigvee=e(aa,"\\bigvee ","&#8744;");J.bigwedge=e(aa,"\\bigwedge ","&#8743;");J.bigodot=e(aa,"\\bigodot ","&#8857;");J.bigotimes=e(aa,"\\bigotimes ","&#8855;");J.bigoplus=e(aa,"\\bigoplus ","&#8853;");J.biguplus=e(aa,"\\biguplus ","&#8846;");J.lfloor=e(aa,"\\lfloor ","&#8970;");J.rfloor=e(aa,"\\rfloor ","&#8971;");J.lceil=e(aa,"\\lceil ","&#8968;");J.rceil=e(aa,"\\rceil ","&#8969;");J.slash=e(aa,"\\slash ","&#47;");J.opencurlybrace=e(aa,"\\opencurlybrace ","&#123;");J.closecurlybrace=e(aa,"\\closecurlybrace ","&#125;");J.caret=e(aa,"\\caret ","^");J.underscore=e(aa,"\\underscore ","_");J.backslash=e(aa,"\\backslash ","\\");J.vert=e(aa,"|");J.perp=J.perpendicular=e(aa,"\\perp ","&perp;");J.nabla=J.del=e(aa,"\\nabla ","&nabla;");J.hbar=e(aa,"\\hbar ","&#8463;");J.AA=J.Angstrom=J.angstrom=e(aa,"\\text\\AA ","&#8491;");J.ring=J.circ=J.circle=e(aa,"\\circ ","&#8728;");J.bull=J.bullet=e(aa,"\\bullet ","&bull;");J.setminus=J.smallsetminus=e(aa,"\\setminus ","&#8726;");J.not=J["¬"]=J.neg=e(aa,"\\neg ","&not;");J["…"]=J.dots=J.ellip=J.hellip=J.ellipsis=J.hellipsis=e(aa,"\\dots ","&hellip;");J.converges=J.darr=J.dnarr=J.dnarrow=J.downarrow=e(aa,"\\downarrow ","&darr;");J.dArr=J.dnArr=J.dnArrow=J.Downarrow=e(aa,"\\Downarrow ","&dArr;");J.diverges=J.uarr=J.uparrow=e(aa,"\\uparrow ","&uarr;");J.uArr=J.Uparrow=e(aa,"\\Uparrow ","&uArr;");J.to=e(ai,"\\to ","&rarr;");J.rarr=J.rightarrow=e(aa,"\\rightarrow ","&rarr;");J.implies=e(ai,"\\Rightarrow ","&rArr;");J.rArr=J.Rightarrow=e(aa,"\\Rightarrow ","&rArr;");J.gets=e(ai,"\\gets ","&larr;");J.larr=J.leftarrow=e(aa,"\\leftarrow ","&larr;");J.impliedby=e(ai,"\\Leftarrow ","&lArr;");J.lArr=J.Leftarrow=e(aa,"\\Leftarrow ","&lArr;");J.harr=J.lrarr=J.leftrightarrow=e(aa,"\\leftrightarrow ","&harr;");J.iff=e(ai,"\\Leftrightarrow ","&hArr;");J.hArr=J.lrArr=J.Leftrightarrow=e(aa,"\\Leftrightarrow ","&hArr;");J.Re=J.Real=J.real=e(aa,"\\Re ","&real;");J.Im=J.imag=J.image=J.imagin=J.imaginary=J.Imaginary=e(aa,"\\Im ","&image;");J.part=J.partial=e(aa,"\\partial ","&part;");J.inf=J.infin=J.infty=J.infinity=e(aa,"\\infty ","&infin;");J.alef=J.alefsym=J.aleph=J.alephsym=e(aa,"\\aleph ","&alefsym;");J.xist=J.xists=J.exist=J.exists=e(aa,"\\exists ","&exist;");J.and=J.land=J.wedge=e(aa,"\\wedge ","&and;");J.or=J.lor=J.vee=e(aa,"\\vee ","&or;");J.o=J.O=J.empty=J.emptyset=J.oslash=J.Oslash=J.nothing=J.varnothing=e(ai,"\\varnothing ","&empty;");J.cup=J.union=e(ai,"\\cup ","&cup;");J.cap=J.intersect=J.intersection=e(ai,"\\cap ","&cap;");J.deg=J.degree=e(aa,"^\\circ ","&deg;");J.ang=J.angle=e(aa,"\\angle ","&ang;");var T=h(W,function(P,ao){P.init=function(ap){ao.init.call(this,"\\"+ap+" ",'<span math="true">'+ap+"</span>")};P.respace=function(){this.jQ[0].className=(this.next instanceof al||this.next instanceof A)?"":"non-italicized-function"}});J.ln=J.lg=J.log=J.span=J.proj=J.det=J.dim=J.min=J.max=J.mod=J.lcm=J.gcd=J.gcf=J.hcf=J.lim=T;(function(){var ao=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var P in ao){J[ao[P]]=J[ao[P]+"h"]=J["a"+ao[P]]=J["arc"+ao[P]]=J["a"+ao[P]+"h"]=J["arc"+ao[P]+"h"]=T}}());var S=(function(){function aD(aG){var aH=v();aG.adopt(aH,0,0);return aH}function aw(aI){var aH=aI[0]||v();for(var aG=1;aG<aI.length;aG+=1){aI[aG].children().adopt(aH,aH.lastChild,0)}return aH}var P=c.string;var aq=c.regex;var aF=c.letter;var ax=c.any;var aC=c.optWhitespace;var aE=c.succeed;var av=c.fail;var ay=aF.map(r);var az=aq(/^[^${}\\_^]/).map(aa);var ao=aq(/^[^\\]/).or(P("\\").then(aq(/^[a-z]+/i).or(aq(/^\s+/).result(" ")).or(ax))).then(function(aH){var aG=J[aH];if(aG){return aG(aH).parser()}else{return av("unknown command: \\"+aH)}});var ar=ao.or(ay).or(az);var au=P("{").then(function(){return aB}).skip(P("}"));var at=aC.then(au.or(ar.map(aD)));var aB=at.many().map(aw).skip(aC);var aA=P("[").then(at.then(function(aG){return aG.join("latex")!=="]"?aE(aG):av()}).many().map(aw).skip(aC)).skip(P("]"));var ap=aB;ap.block=at;ap.optBlock=aA;return ap})();var I=h(function(ao){ao.init=function(ar){this.parent=this.root=ar;var at=this.jQ=this._jQ=O('<span math="true" class="cursor">&zwj;</span>');this.blink=function(){at.toggleClass("blink")};this.upDownCache={}};ao.prev=0;ao.next=0;ao.parent=0;ao.show=function(){this.jQ=this._jQ.removeClass("blink");if("intervalId" in this){clearInterval(this.intervalId)}else{if(this.next){if(this.selection&&this.selection.first.prev===this.prev){this.jQ.insertBefore(this.selection.jQ)}else{this.jQ.insertBefore(this.next.jQ.first())}}else{this.jQ.appendTo(this.parent.jQ)}this.parent.focus()}this.intervalId=setInterval(this.blink,500);return this};ao.hide=function(){if("intervalId" in this){clearInterval(this.intervalId)}delete this.intervalId;this.jQ.detach();this.jQ=O();return this};ao.insertAt=function(at,au,ar){var av=this.parent;this.parent=at;this.prev=au;this.next=ar;av.blur()};ao.insertBefore=function(ar){this.insertAt(ar.parent,ar.prev,ar);this.parent.jQ.addClass("hasCursor");this.jQ.insertBefore(ar.jQ.first());return this};ao.insertAfter=function(ar){this.insertAt(ar.parent,ar,ar.next);this.parent.jQ.addClass("hasCursor");this.jQ.insertAfter(ar.jQ.last());return this};ao.prependTo=function(ar){this.insertAt(ar,0,ar.firstChild);if(ar.textarea){this.jQ.insertAfter(ar.textarea)}else{this.jQ.prependTo(ar.jQ)}ar.focus();return this};ao.appendTo=function(ar){this.insertAt(ar,ar.lastChild,0);this.jQ.appendTo(ar.jQ);ar.focus();return this};ao.hopLeft=function(){this.jQ.insertBefore(this.prev.jQ.first());this.next=this.prev;this.prev=this.prev.prev;return this};ao.hopRight=function(){this.jQ.insertAfter(this.next.jQ.last());this.prev=this.next;this.next=this.next.next;return this};ao.moveLeftWithin=function(ar){if(this.prev){if(this.prev.lastChild){this.appendTo(this.prev.lastChild)}else{this.hopLeft()}}else{if(this.parent===ar){return}if(this.parent.prev){this.appendTo(this.parent.prev)}else{this.insertBefore(this.parent.parent)}}};ao.moveRightWithin=function(ar){if(this.next){if(this.next.firstChild){this.prependTo(this.next.firstChild)}else{this.hopRight()}}else{if(this.parent===ar){return}if(this.parent.next){this.prependTo(this.parent.next)}else{this.insertAfter(this.parent.parent)}}};ao.moveLeft=function(){ap(this);if(this.selection){this.insertBefore(this.selection.first).clearSelection()}else{this.moveLeftWithin(this.root)}return this.show()};ao.moveRight=function(){ap(this);if(this.selection){this.insertAfter(this.selection.last).clearSelection()}else{this.moveRightWithin(this.root)}return this.show()};ao.moveUp=function(){return P(this,"up")};ao.moveDown=function(){return P(this,"down")};function P(ar,at){if(ar.next[at]){ar.prependTo(ar.next[at])}else{if(ar.prev[at]){ar.appendTo(ar.prev[at])}else{var aw=ar.parent;do{var ax=aw[at];if(ax){if(typeof ax==="function"){ax=aw[at](ar)}if(ax===false||ax instanceof v){ar.upDownCache[aw.id]={parent:ar.parent,prev:ar.prev,next:ar.next};if(ax instanceof v){var av=ar.upDownCache[ax.id];if(av){if(av.next){ar.insertBefore(av.next)}else{ar.appendTo(av.parent)}}else{var au=aq(ar).left;ar.appendTo(ax);ar.seekHoriz(au,ax)}}break}}aw=aw.parent.parent}while(aw)}}return ar.clearSelection().show()}ao.seek=function(av,at,ar){ap(this);var au,ax,aw=this.clearSelection().show();if(av.hasClass("empty")){aw.prependTo(D[av.attr(j)]);return aw}au=D[av.attr(E)];if(au instanceof W){if(av.outerWidth()>2*(at-av.offset().left)){aw.insertBefore(au)}else{aw.insertAfter(au)}return aw}if(!au){ax=D[av.attr(j)];if(!ax){av=av.parent();au=D[av.attr(E)];if(!au){ax=D[av.attr(j)];if(!ax){ax=aw.root}}}}if(au){aw.insertAfter(au)}else{aw.appendTo(ax)}return aw.seekHoriz(at,aw.root)};ao.seekHoriz=function(at,aw){var av=this;var au=aq(av).left-at;var ar;do{av.moveLeftWithin(aw);ar=au;au=aq(av).left-at}while(au>0&&(av.prev||av.parent!==aw));if(-au>ar){av.moveRightWithin(aw)}return av};function aq(ar){var at=ar.jQ.removeClass("cursor").offset();ar.jQ.addClass("cursor");return at}ao.writeLatex=function(av){var at=this;ap(at);at.show().deleteSelection();var au=c.all;var ar=c.eof;var aw=S.skip(ar).or(au.result(false)).parse(av);if(aw){aw.children().adopt(at.parent,at.prev,at.next);D.jQize(aw.join("html")).insertBefore(at.jQ);at.prev=aw.lastChild;aw.finalizeInsert();at.parent.bubble("redraw")}return this.hide()};ao.write=function(ar){ap(this);return this.show().insertCh(ar)};ao.insertCh=function(ar){var at;if(ar.match(/^[a-eg-zA-Z]$/)){at=r(ar)}else{if(at=x[ar]||J[ar]){at=at(ar)}else{at=aa(ar)}}if(this.selection){this.prev=this.selection.first.prev;this.next=this.selection.last.next;at.replaces(this.selection);delete this.selection}return this.insertNew(at)};ao.insertNew=function(ar){ar.createBefore(this);return this};ao.insertCmd=function(ar,au){var at=J[ar];if(at){at=at(ar);if(au){at.replaces(au)}this.insertNew(at)}else{at=ab();at.replaces(ar);at.firstChild.focus=function(){delete this.focus;return this};this.insertNew(at).insertAfter(at);if(au){au.remove()}}return this};ao.unwrapGramp=function(){var at=this.parent.parent;var ar=at.parent;var au=at.next;var aw=this;var av=at.prev;at.disown().eachChild(function(ax){if(ax.isEmpty()){return}ax.children().adopt(ar,av,au).each(function(ay){ay.jQ.insertBefore(at.jQ.first())});av=ax.lastChild});if(!this.next){if(this.prev){this.next=this.prev.next}else{while(!this.next){this.parent=this.parent.next;if(this.parent){this.next=this.parent.firstChild}else{this.next=at.next;this.parent=ar;break}}}}if(this.next){this.insertBefore(this.next)}else{this.appendTo(ar)}at.jQ.remove();if(at.prev){at.prev.respace()}if(at.next){at.next.respace()}};ao.backspace=function(){ap(this);this.show();if(this.deleteSelection()){}else{if(this.prev){if(this.prev.isEmpty()){this.prev=this.prev.remove().prev}else{this.selectLeft()}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insertAfter(this.parent.parent).backspace()}else{this.unwrapGramp()}}}}if(this.prev){this.prev.respace()}if(this.next){this.next.respace()}this.parent.bubble("redraw");return this};ao.deleteForward=function(){ap(this);this.show();if(this.deleteSelection()){}else{if(this.next){if(this.next.isEmpty()){this.next=this.next.remove().next}else{this.selectRight()}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insertBefore(this.parent.parent).deleteForward()}else{this.unwrapGramp()}}}}if(this.prev){this.prev.respace()}if(this.next){this.next.respace()}this.parent.bubble("redraw");return this};ao.selectFrom=function(aw){var aA=this,au=aw;loopThroughAncestors:while(true){for(var ax=this;ax!==aA.parent.parent;ax=ax.parent.parent){if(ax.parent===au.parent){at=ax;ay=au;break loopThroughAncestors}}for(var az=aw;az!==au.parent.parent;az=az.parent.parent){if(aA.parent===az.parent){at=aA;ay=az;break loopThroughAncestors}}if(aA.parent.parent){aA=aA.parent.parent}if(au.parent.parent){au=au.parent.parent}}var at,ay,ar;if(at.next!==ay){for(var av=at;av;av=av.next){if(av===ay.prev){ar=true;break}}if(!ar){ar=ay;ay=at;at=ar}}this.hide().selection=R(at.prev.next||at.parent.firstChild,ay.next.prev||ay.parent.lastChild);this.insertAfter(ay.next.prev||ay.parent.lastChild);this.root.selectionChanged()};ao.selectLeft=function(){ap(this);if(this.selection){if(this.selection.first===this.next){if(this.prev){this.hopLeft().selection.extendLeft()}else{if(this.parent!==this.root){this.insertBefore(this.parent.parent).selection.levelUp()}}}else{this.hopLeft();if(this.selection.first===this.selection.last){this.clearSelection().show();return}this.selection.retractLeft()}}else{if(this.prev){this.hopLeft()}else{if(this.parent!==this.root){this.insertBefore(this.parent.parent)}else{return}}this.hide().selection=R(this.next)}this.root.selectionChanged()};ao.selectRight=function(){ap(this);if(this.selection){if(this.selection.last===this.prev){if(this.next){this.hopRight().selection.extendRight()}else{if(this.parent!==this.root){this.insertAfter(this.parent.parent).selection.levelUp()}}}else{this.hopRight();if(this.selection.first===this.selection.last){this.clearSelection().show();return}this.selection.retractRight()}}else{if(this.next){this.hopRight()}else{if(this.parent!==this.root){this.insertAfter(this.parent.parent)}else{return}}this.hide().selection=R(this.prev)}this.root.selectionChanged()};function ap(ar){ar.upDownCache={}}ao.prepareMove=function(){ap(this);return this.show().clearSelection()};ao.prepareEdit=function(){ap(this);return this.show().deleteSelection()};ao.clearSelection=function(){if(this.selection){this.selection.clear();delete this.selection;this.root.selectionChanged()}return this};ao.deleteSelection=function(){if(!this.selection){return false}this.prev=this.selection.first.prev;this.next=this.selection.last.next;this.selection.remove();this.root.selectionChanged();return delete this.selection}});var R=h(Y,function(P,ao){P.init=function(){var ap=this;ao.init.apply(ap,arguments);ap.jQwrap(ap.jQ)};P.jQwrap=function(ap){this.jQ=ap.wrapAll('<span math="true" class="selection"></span>').parent()};P.adopt=function(){this.jQ.replaceWith(this.jQ=this.jQ.children());return ao.adopt.apply(this,arguments)};P.clear=function(){this.jQ.replaceWith(this.jQ.children());return this};P.levelUp=function(){var aq=this,ap=aq.first=aq.last=aq.last.parent.parent;aq.clear().jQwrap(ap.jQ);return aq};P.extendLeft=function(){this.first=this.first.prev;this.first.jQ.prependTo(this.jQ)};P.extendRight=function(){this.last=this.last.next;this.last.jQ.appendTo(this.jQ)};P.retractRight=function(){this.first.jQ.insertBefore(this.jQ);this.first=this.first.next};P.retractLeft=function(){this.last.jQ.insertAfter(this.jQ);this.last=this.last.prev}});O.fn.mathquill=function(at,ar){switch(at){case"redraw":return this.each(function(){var aw=O(this).attr(j),ax=aw&&D[aw];if(ax){(function av(ay){ay.eachChild(av);if(ay.redraw){ay.redraw()}}(ax))}});case"revert":return this.each(function(){var av=O(this).attr(j),aw=av&&D[av];if(aw&&aw.revert){aw.revert()}});case"latex":if(arguments.length>1){return this.each(function(){var av=O(this).attr(j),aw=av&&D[av];if(aw){aw.renderLatex(ar)}})}var ao=O(this).attr(j),au=ao&&D[ao];return au&&au.latex();case"text":var ao=O(this).attr(j),au=ao&&D[ao];return au&&au.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span math="true" class="?cursor( blink)?"?><\/span>/i,"").replace(/<span math="true" class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1){return this.each(function(){var av=O(this).attr(j),ax=av&&D[av],aw=ax&&ax.cursor;if(aw){aw.writeLatex(ar).parent.blur()}})}case"cmd":if(arguments.length>1){return this.each(function(){var av=O(this).attr(j),ay=av&&D[av],ax=ay&&ay.cursor;if(ax){ax.show();if(/^\\[a-z]+$/i.test(ar)){var aw=ax.selection;if(aw){ax.prev=aw.first.prev;ax.next=aw.last.next;delete ax.selection}ax.insertCmd(ar.slice(1),aw)}else{ax.insertCh(ar)}ax.hide().parent.blur()}})}default:var P=at==="textbox",ap=P||at==="editable",aq=P?U:m;return this.each(function(){ae(O(this),aq(),P,ap)})}};O(function(){O(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable");O(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox");O(".mathquill-embedded-latex").mathquill()})}());