/* automatically generated by JSCoverage - do not edit */
try {
  if (typeof top === 'object' && top !== null && typeof top.opener === 'object' && top.opener !== null) {
    // this is a browser window that was opened from another window

    if (! top.opener._$jscoverage) {
      top.opener._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null) {
    // this is a browser window

    try {
      if (typeof top.opener === 'object' && top.opener !== null && top.opener._$jscoverage) {
        top._$jscoverage = top.opener._$jscoverage;
      }
    }
    catch (e) {}

    if (! top._$jscoverage) {
      top._$jscoverage = {};
    }
  }
}
catch (e) {}

try {
  if (typeof top === 'object' && top !== null && top._$jscoverage) {
    _$jscoverage = top._$jscoverage;
  }
}
catch (e) {}
if (typeof _$jscoverage !== 'object') {
  _$jscoverage = {};
}
if (! _$jscoverage['plugins/table.action.js']) {
  _$jscoverage['plugins/table.action.js'] = [];
  _$jscoverage['plugins/table.action.js'][8] = 0;
  _$jscoverage['plugins/table.action.js'][9] = 0;
  _$jscoverage['plugins/table.action.js'][13] = 0;
  _$jscoverage['plugins/table.action.js'][16] = 0;
  _$jscoverage['plugins/table.action.js'][19] = 0;
  _$jscoverage['plugins/table.action.js'][22] = 0;
  _$jscoverage['plugins/table.action.js'][25] = 0;
  _$jscoverage['plugins/table.action.js'][26] = 0;
  _$jscoverage['plugins/table.action.js'][30] = 0;
  _$jscoverage['plugins/table.action.js'][39] = 0;
  _$jscoverage['plugins/table.action.js'][43] = 0;
  _$jscoverage['plugins/table.action.js'][53] = 0;
  _$jscoverage['plugins/table.action.js'][54] = 0;
  _$jscoverage['plugins/table.action.js'][82] = 0;
  _$jscoverage['plugins/table.action.js'][83] = 0;
  _$jscoverage['plugins/table.action.js'][94] = 0;
  _$jscoverage['plugins/table.action.js'][96] = 0;
  _$jscoverage['plugins/table.action.js'][97] = 0;
  _$jscoverage['plugins/table.action.js'][98] = 0;
  _$jscoverage['plugins/table.action.js'][100] = 0;
  _$jscoverage['plugins/table.action.js'][102] = 0;
  _$jscoverage['plugins/table.action.js'][103] = 0;
  _$jscoverage['plugins/table.action.js'][104] = 0;
  _$jscoverage['plugins/table.action.js'][105] = 0;
  _$jscoverage['plugins/table.action.js'][106] = 0;
  _$jscoverage['plugins/table.action.js'][107] = 0;
  _$jscoverage['plugins/table.action.js'][108] = 0;
  _$jscoverage['plugins/table.action.js'][110] = 0;
  _$jscoverage['plugins/table.action.js'][112] = 0;
  _$jscoverage['plugins/table.action.js'][115] = 0;
  _$jscoverage['plugins/table.action.js'][117] = 0;
  _$jscoverage['plugins/table.action.js'][118] = 0;
  _$jscoverage['plugins/table.action.js'][119] = 0;
  _$jscoverage['plugins/table.action.js'][120] = 0;
  _$jscoverage['plugins/table.action.js'][121] = 0;
  _$jscoverage['plugins/table.action.js'][122] = 0;
  _$jscoverage['plugins/table.action.js'][125] = 0;
  _$jscoverage['plugins/table.action.js'][128] = 0;
  _$jscoverage['plugins/table.action.js'][130] = 0;
  _$jscoverage['plugins/table.action.js'][131] = 0;
  _$jscoverage['plugins/table.action.js'][132] = 0;
  _$jscoverage['plugins/table.action.js'][133] = 0;
  _$jscoverage['plugins/table.action.js'][134] = 0;
  _$jscoverage['plugins/table.action.js'][136] = 0;
  _$jscoverage['plugins/table.action.js'][137] = 0;
  _$jscoverage['plugins/table.action.js'][142] = 0;
  _$jscoverage['plugins/table.action.js'][144] = 0;
  _$jscoverage['plugins/table.action.js'][146] = 0;
  _$jscoverage['plugins/table.action.js'][147] = 0;
  _$jscoverage['plugins/table.action.js'][148] = 0;
  _$jscoverage['plugins/table.action.js'][150] = 0;
  _$jscoverage['plugins/table.action.js'][151] = 0;
  _$jscoverage['plugins/table.action.js'][153] = 0;
  _$jscoverage['plugins/table.action.js'][154] = 0;
  _$jscoverage['plugins/table.action.js'][157] = 0;
  _$jscoverage['plugins/table.action.js'][158] = 0;
  _$jscoverage['plugins/table.action.js'][160] = 0;
  _$jscoverage['plugins/table.action.js'][161] = 0;
  _$jscoverage['plugins/table.action.js'][162] = 0;
  _$jscoverage['plugins/table.action.js'][163] = 0;
  _$jscoverage['plugins/table.action.js'][166] = 0;
  _$jscoverage['plugins/table.action.js'][167] = 0;
  _$jscoverage['plugins/table.action.js'][168] = 0;
  _$jscoverage['plugins/table.action.js'][174] = 0;
  _$jscoverage['plugins/table.action.js'][175] = 0;
  _$jscoverage['plugins/table.action.js'][176] = 0;
  _$jscoverage['plugins/table.action.js'][177] = 0;
  _$jscoverage['plugins/table.action.js'][178] = 0;
  _$jscoverage['plugins/table.action.js'][179] = 0;
  _$jscoverage['plugins/table.action.js'][180] = 0;
  _$jscoverage['plugins/table.action.js'][181] = 0;
  _$jscoverage['plugins/table.action.js'][184] = 0;
  _$jscoverage['plugins/table.action.js'][185] = 0;
  _$jscoverage['plugins/table.action.js'][186] = 0;
  _$jscoverage['plugins/table.action.js'][188] = 0;
  _$jscoverage['plugins/table.action.js'][195] = 0;
  _$jscoverage['plugins/table.action.js'][196] = 0;
  _$jscoverage['plugins/table.action.js'][197] = 0;
  _$jscoverage['plugins/table.action.js'][200] = 0;
  _$jscoverage['plugins/table.action.js'][201] = 0;
  _$jscoverage['plugins/table.action.js'][202] = 0;
  _$jscoverage['plugins/table.action.js'][203] = 0;
  _$jscoverage['plugins/table.action.js'][204] = 0;
  _$jscoverage['plugins/table.action.js'][205] = 0;
  _$jscoverage['plugins/table.action.js'][206] = 0;
  _$jscoverage['plugins/table.action.js'][207] = 0;
  _$jscoverage['plugins/table.action.js'][209] = 0;
  _$jscoverage['plugins/table.action.js'][210] = 0;
  _$jscoverage['plugins/table.action.js'][211] = 0;
  _$jscoverage['plugins/table.action.js'][212] = 0;
  _$jscoverage['plugins/table.action.js'][213] = 0;
  _$jscoverage['plugins/table.action.js'][214] = 0;
  _$jscoverage['plugins/table.action.js'][215] = 0;
  _$jscoverage['plugins/table.action.js'][216] = 0;
  _$jscoverage['plugins/table.action.js'][217] = 0;
  _$jscoverage['plugins/table.action.js'][218] = 0;
  _$jscoverage['plugins/table.action.js'][219] = 0;
  _$jscoverage['plugins/table.action.js'][221] = 0;
  _$jscoverage['plugins/table.action.js'][222] = 0;
  _$jscoverage['plugins/table.action.js'][223] = 0;
  _$jscoverage['plugins/table.action.js'][224] = 0;
  _$jscoverage['plugins/table.action.js'][225] = 0;
  _$jscoverage['plugins/table.action.js'][226] = 0;
  _$jscoverage['plugins/table.action.js'][228] = 0;
  _$jscoverage['plugins/table.action.js'][229] = 0;
  _$jscoverage['plugins/table.action.js'][230] = 0;
  _$jscoverage['plugins/table.action.js'][231] = 0;
  _$jscoverage['plugins/table.action.js'][232] = 0;
  _$jscoverage['plugins/table.action.js'][234] = 0;
  _$jscoverage['plugins/table.action.js'][235] = 0;
  _$jscoverage['plugins/table.action.js'][236] = 0;
  _$jscoverage['plugins/table.action.js'][237] = 0;
  _$jscoverage['plugins/table.action.js'][238] = 0;
  _$jscoverage['plugins/table.action.js'][239] = 0;
  _$jscoverage['plugins/table.action.js'][240] = 0;
  _$jscoverage['plugins/table.action.js'][241] = 0;
  _$jscoverage['plugins/table.action.js'][245] = 0;
  _$jscoverage['plugins/table.action.js'][246] = 0;
  _$jscoverage['plugins/table.action.js'][247] = 0;
  _$jscoverage['plugins/table.action.js'][248] = 0;
  _$jscoverage['plugins/table.action.js'][249] = 0;
  _$jscoverage['plugins/table.action.js'][251] = 0;
  _$jscoverage['plugins/table.action.js'][252] = 0;
  _$jscoverage['plugins/table.action.js'][253] = 0;
  _$jscoverage['plugins/table.action.js'][255] = 0;
  _$jscoverage['plugins/table.action.js'][256] = 0;
  _$jscoverage['plugins/table.action.js'][257] = 0;
  _$jscoverage['plugins/table.action.js'][258] = 0;
  _$jscoverage['plugins/table.action.js'][261] = 0;
  _$jscoverage['plugins/table.action.js'][262] = 0;
  _$jscoverage['plugins/table.action.js'][263] = 0;
  _$jscoverage['plugins/table.action.js'][264] = 0;
  _$jscoverage['plugins/table.action.js'][265] = 0;
  _$jscoverage['plugins/table.action.js'][267] = 0;
  _$jscoverage['plugins/table.action.js'][268] = 0;
  _$jscoverage['plugins/table.action.js'][269] = 0;
  _$jscoverage['plugins/table.action.js'][270] = 0;
  _$jscoverage['plugins/table.action.js'][271] = 0;
  _$jscoverage['plugins/table.action.js'][272] = 0;
  _$jscoverage['plugins/table.action.js'][274] = 0;
  _$jscoverage['plugins/table.action.js'][275] = 0;
  _$jscoverage['plugins/table.action.js'][277] = 0;
  _$jscoverage['plugins/table.action.js'][280] = 0;
  _$jscoverage['plugins/table.action.js'][281] = 0;
  _$jscoverage['plugins/table.action.js'][282] = 0;
  _$jscoverage['plugins/table.action.js'][283] = 0;
  _$jscoverage['plugins/table.action.js'][284] = 0;
  _$jscoverage['plugins/table.action.js'][285] = 0;
  _$jscoverage['plugins/table.action.js'][286] = 0;
  _$jscoverage['plugins/table.action.js'][287] = 0;
  _$jscoverage['plugins/table.action.js'][291] = 0;
  _$jscoverage['plugins/table.action.js'][293] = 0;
  _$jscoverage['plugins/table.action.js'][294] = 0;
  _$jscoverage['plugins/table.action.js'][295] = 0;
  _$jscoverage['plugins/table.action.js'][296] = 0;
  _$jscoverage['plugins/table.action.js'][297] = 0;
  _$jscoverage['plugins/table.action.js'][298] = 0;
  _$jscoverage['plugins/table.action.js'][299] = 0;
  _$jscoverage['plugins/table.action.js'][301] = 0;
  _$jscoverage['plugins/table.action.js'][302] = 0;
  _$jscoverage['plugins/table.action.js'][306] = 0;
  _$jscoverage['plugins/table.action.js'][309] = 0;
  _$jscoverage['plugins/table.action.js'][313] = 0;
  _$jscoverage['plugins/table.action.js'][314] = 0;
  _$jscoverage['plugins/table.action.js'][315] = 0;
  _$jscoverage['plugins/table.action.js'][317] = 0;
  _$jscoverage['plugins/table.action.js'][318] = 0;
  _$jscoverage['plugins/table.action.js'][319] = 0;
  _$jscoverage['plugins/table.action.js'][320] = 0;
  _$jscoverage['plugins/table.action.js'][321] = 0;
  _$jscoverage['plugins/table.action.js'][322] = 0;
  _$jscoverage['plugins/table.action.js'][324] = 0;
  _$jscoverage['plugins/table.action.js'][325] = 0;
  _$jscoverage['plugins/table.action.js'][328] = 0;
  _$jscoverage['plugins/table.action.js'][329] = 0;
  _$jscoverage['plugins/table.action.js'][330] = 0;
  _$jscoverage['plugins/table.action.js'][331] = 0;
  _$jscoverage['plugins/table.action.js'][332] = 0;
  _$jscoverage['plugins/table.action.js'][333] = 0;
  _$jscoverage['plugins/table.action.js'][335] = 0;
  _$jscoverage['plugins/table.action.js'][340] = 0;
  _$jscoverage['plugins/table.action.js'][344] = 0;
  _$jscoverage['plugins/table.action.js'][345] = 0;
  _$jscoverage['plugins/table.action.js'][346] = 0;
  _$jscoverage['plugins/table.action.js'][347] = 0;
  _$jscoverage['plugins/table.action.js'][348] = 0;
  _$jscoverage['plugins/table.action.js'][352] = 0;
  _$jscoverage['plugins/table.action.js'][353] = 0;
  _$jscoverage['plugins/table.action.js'][355] = 0;
  _$jscoverage['plugins/table.action.js'][356] = 0;
  _$jscoverage['plugins/table.action.js'][357] = 0;
  _$jscoverage['plugins/table.action.js'][358] = 0;
  _$jscoverage['plugins/table.action.js'][359] = 0;
  _$jscoverage['plugins/table.action.js'][361] = 0;
  _$jscoverage['plugins/table.action.js'][362] = 0;
  _$jscoverage['plugins/table.action.js'][363] = 0;
  _$jscoverage['plugins/table.action.js'][364] = 0;
  _$jscoverage['plugins/table.action.js'][370] = 0;
  _$jscoverage['plugins/table.action.js'][371] = 0;
  _$jscoverage['plugins/table.action.js'][377] = 0;
  _$jscoverage['plugins/table.action.js'][378] = 0;
  _$jscoverage['plugins/table.action.js'][380] = 0;
  _$jscoverage['plugins/table.action.js'][381] = 0;
  _$jscoverage['plugins/table.action.js'][382] = 0;
  _$jscoverage['plugins/table.action.js'][383] = 0;
  _$jscoverage['plugins/table.action.js'][384] = 0;
  _$jscoverage['plugins/table.action.js'][385] = 0;
  _$jscoverage['plugins/table.action.js'][386] = 0;
  _$jscoverage['plugins/table.action.js'][387] = 0;
  _$jscoverage['plugins/table.action.js'][388] = 0;
  _$jscoverage['plugins/table.action.js'][390] = 0;
  _$jscoverage['plugins/table.action.js'][391] = 0;
  _$jscoverage['plugins/table.action.js'][392] = 0;
  _$jscoverage['plugins/table.action.js'][393] = 0;
  _$jscoverage['plugins/table.action.js'][397] = 0;
  _$jscoverage['plugins/table.action.js'][398] = 0;
  _$jscoverage['plugins/table.action.js'][399] = 0;
  _$jscoverage['plugins/table.action.js'][400] = 0;
  _$jscoverage['plugins/table.action.js'][401] = 0;
  _$jscoverage['plugins/table.action.js'][405] = 0;
  _$jscoverage['plugins/table.action.js'][406] = 0;
  _$jscoverage['plugins/table.action.js'][408] = 0;
  _$jscoverage['plugins/table.action.js'][409] = 0;
  _$jscoverage['plugins/table.action.js'][410] = 0;
  _$jscoverage['plugins/table.action.js'][412] = 0;
  _$jscoverage['plugins/table.action.js'][413] = 0;
  _$jscoverage['plugins/table.action.js'][414] = 0;
  _$jscoverage['plugins/table.action.js'][415] = 0;
  _$jscoverage['plugins/table.action.js'][416] = 0;
  _$jscoverage['plugins/table.action.js'][430] = 0;
  _$jscoverage['plugins/table.action.js'][431] = 0;
  _$jscoverage['plugins/table.action.js'][432] = 0;
  _$jscoverage['plugins/table.action.js'][433] = 0;
  _$jscoverage['plugins/table.action.js'][434] = 0;
  _$jscoverage['plugins/table.action.js'][435] = 0;
  _$jscoverage['plugins/table.action.js'][437] = 0;
  _$jscoverage['plugins/table.action.js'][440] = 0;
  _$jscoverage['plugins/table.action.js'][441] = 0;
  _$jscoverage['plugins/table.action.js'][442] = 0;
  _$jscoverage['plugins/table.action.js'][444] = 0;
  _$jscoverage['plugins/table.action.js'][447] = 0;
  _$jscoverage['plugins/table.action.js'][449] = 0;
  _$jscoverage['plugins/table.action.js'][450] = 0;
  _$jscoverage['plugins/table.action.js'][451] = 0;
  _$jscoverage['plugins/table.action.js'][452] = 0;
  _$jscoverage['plugins/table.action.js'][453] = 0;
  _$jscoverage['plugins/table.action.js'][454] = 0;
  _$jscoverage['plugins/table.action.js'][456] = 0;
  _$jscoverage['plugins/table.action.js'][459] = 0;
  _$jscoverage['plugins/table.action.js'][460] = 0;
  _$jscoverage['plugins/table.action.js'][461] = 0;
  _$jscoverage['plugins/table.action.js'][463] = 0;
  _$jscoverage['plugins/table.action.js'][468] = 0;
  _$jscoverage['plugins/table.action.js'][469] = 0;
  _$jscoverage['plugins/table.action.js'][470] = 0;
  _$jscoverage['plugins/table.action.js'][471] = 0;
  _$jscoverage['plugins/table.action.js'][472] = 0;
  _$jscoverage['plugins/table.action.js'][473] = 0;
  _$jscoverage['plugins/table.action.js'][474] = 0;
  _$jscoverage['plugins/table.action.js'][475] = 0;
  _$jscoverage['plugins/table.action.js'][476] = 0;
  _$jscoverage['plugins/table.action.js'][477] = 0;
  _$jscoverage['plugins/table.action.js'][479] = 0;
  _$jscoverage['plugins/table.action.js'][480] = 0;
  _$jscoverage['plugins/table.action.js'][481] = 0;
  _$jscoverage['plugins/table.action.js'][482] = 0;
  _$jscoverage['plugins/table.action.js'][486] = 0;
  _$jscoverage['plugins/table.action.js'][487] = 0;
  _$jscoverage['plugins/table.action.js'][490] = 0;
  _$jscoverage['plugins/table.action.js'][491] = 0;
  _$jscoverage['plugins/table.action.js'][492] = 0;
  _$jscoverage['plugins/table.action.js'][494] = 0;
  _$jscoverage['plugins/table.action.js'][495] = 0;
  _$jscoverage['plugins/table.action.js'][496] = 0;
  _$jscoverage['plugins/table.action.js'][497] = 0;
  _$jscoverage['plugins/table.action.js'][499] = 0;
  _$jscoverage['plugins/table.action.js'][508] = 0;
  _$jscoverage['plugins/table.action.js'][512] = 0;
  _$jscoverage['plugins/table.action.js'][513] = 0;
  _$jscoverage['plugins/table.action.js'][515] = 0;
  _$jscoverage['plugins/table.action.js'][516] = 0;
  _$jscoverage['plugins/table.action.js'][517] = 0;
  _$jscoverage['plugins/table.action.js'][518] = 0;
  _$jscoverage['plugins/table.action.js'][521] = 0;
  _$jscoverage['plugins/table.action.js'][522] = 0;
  _$jscoverage['plugins/table.action.js'][523] = 0;
  _$jscoverage['plugins/table.action.js'][527] = 0;
  _$jscoverage['plugins/table.action.js'][529] = 0;
  _$jscoverage['plugins/table.action.js'][530] = 0;
  _$jscoverage['plugins/table.action.js'][533] = 0;
  _$jscoverage['plugins/table.action.js'][534] = 0;
  _$jscoverage['plugins/table.action.js'][535] = 0;
  _$jscoverage['plugins/table.action.js'][538] = 0;
  _$jscoverage['plugins/table.action.js'][539] = 0;
  _$jscoverage['plugins/table.action.js'][545] = 0;
  _$jscoverage['plugins/table.action.js'][546] = 0;
  _$jscoverage['plugins/table.action.js'][548] = 0;
  _$jscoverage['plugins/table.action.js'][549] = 0;
  _$jscoverage['plugins/table.action.js'][550] = 0;
  _$jscoverage['plugins/table.action.js'][552] = 0;
  _$jscoverage['plugins/table.action.js'][553] = 0;
  _$jscoverage['plugins/table.action.js'][556] = 0;
  _$jscoverage['plugins/table.action.js'][557] = 0;
  _$jscoverage['plugins/table.action.js'][558] = 0;
  _$jscoverage['plugins/table.action.js'][559] = 0;
  _$jscoverage['plugins/table.action.js'][560] = 0;
  _$jscoverage['plugins/table.action.js'][563] = 0;
  _$jscoverage['plugins/table.action.js'][565] = 0;
  _$jscoverage['plugins/table.action.js'][566] = 0;
  _$jscoverage['plugins/table.action.js'][567] = 0;
  _$jscoverage['plugins/table.action.js'][568] = 0;
  _$jscoverage['plugins/table.action.js'][569] = 0;
  _$jscoverage['plugins/table.action.js'][571] = 0;
  _$jscoverage['plugins/table.action.js'][574] = 0;
  _$jscoverage['plugins/table.action.js'][575] = 0;
  _$jscoverage['plugins/table.action.js'][576] = 0;
  _$jscoverage['plugins/table.action.js'][577] = 0;
  _$jscoverage['plugins/table.action.js'][578] = 0;
  _$jscoverage['plugins/table.action.js'][579] = 0;
  _$jscoverage['plugins/table.action.js'][580] = 0;
  _$jscoverage['plugins/table.action.js'][583] = 0;
  _$jscoverage['plugins/table.action.js'][587] = 0;
  _$jscoverage['plugins/table.action.js'][588] = 0;
  _$jscoverage['plugins/table.action.js'][590] = 0;
  _$jscoverage['plugins/table.action.js'][591] = 0;
  _$jscoverage['plugins/table.action.js'][593] = 0;
  _$jscoverage['plugins/table.action.js'][594] = 0;
  _$jscoverage['plugins/table.action.js'][595] = 0;
  _$jscoverage['plugins/table.action.js'][597] = 0;
  _$jscoverage['plugins/table.action.js'][598] = 0;
  _$jscoverage['plugins/table.action.js'][599] = 0;
  _$jscoverage['plugins/table.action.js'][600] = 0;
  _$jscoverage['plugins/table.action.js'][601] = 0;
  _$jscoverage['plugins/table.action.js'][604] = 0;
  _$jscoverage['plugins/table.action.js'][605] = 0;
  _$jscoverage['plugins/table.action.js'][606] = 0;
  _$jscoverage['plugins/table.action.js'][607] = 0;
  _$jscoverage['plugins/table.action.js'][608] = 0;
  _$jscoverage['plugins/table.action.js'][612] = 0;
  _$jscoverage['plugins/table.action.js'][613] = 0;
  _$jscoverage['plugins/table.action.js'][615] = 0;
  _$jscoverage['plugins/table.action.js'][616] = 0;
  _$jscoverage['plugins/table.action.js'][619] = 0;
  _$jscoverage['plugins/table.action.js'][620] = 0;
  _$jscoverage['plugins/table.action.js'][621] = 0;
  _$jscoverage['plugins/table.action.js'][623] = 0;
  _$jscoverage['plugins/table.action.js'][624] = 0;
  _$jscoverage['plugins/table.action.js'][625] = 0;
  _$jscoverage['plugins/table.action.js'][627] = 0;
  _$jscoverage['plugins/table.action.js'][628] = 0;
  _$jscoverage['plugins/table.action.js'][630] = 0;
  _$jscoverage['plugins/table.action.js'][631] = 0;
  _$jscoverage['plugins/table.action.js'][633] = 0;
  _$jscoverage['plugins/table.action.js'][639] = 0;
  _$jscoverage['plugins/table.action.js'][640] = 0;
  _$jscoverage['plugins/table.action.js'][641] = 0;
  _$jscoverage['plugins/table.action.js'][642] = 0;
  _$jscoverage['plugins/table.action.js'][643] = 0;
  _$jscoverage['plugins/table.action.js'][647] = 0;
  _$jscoverage['plugins/table.action.js'][648] = 0;
  _$jscoverage['plugins/table.action.js'][649] = 0;
  _$jscoverage['plugins/table.action.js'][650] = 0;
  _$jscoverage['plugins/table.action.js'][651] = 0;
  _$jscoverage['plugins/table.action.js'][652] = 0;
  _$jscoverage['plugins/table.action.js'][653] = 0;
  _$jscoverage['plugins/table.action.js'][654] = 0;
  _$jscoverage['plugins/table.action.js'][655] = 0;
  _$jscoverage['plugins/table.action.js'][657] = 0;
  _$jscoverage['plugins/table.action.js'][659] = 0;
  _$jscoverage['plugins/table.action.js'][660] = 0;
  _$jscoverage['plugins/table.action.js'][661] = 0;
  _$jscoverage['plugins/table.action.js'][662] = 0;
  _$jscoverage['plugins/table.action.js'][663] = 0;
  _$jscoverage['plugins/table.action.js'][664] = 0;
  _$jscoverage['plugins/table.action.js'][665] = 0;
  _$jscoverage['plugins/table.action.js'][668] = 0;
  _$jscoverage['plugins/table.action.js'][669] = 0;
  _$jscoverage['plugins/table.action.js'][670] = 0;
  _$jscoverage['plugins/table.action.js'][671] = 0;
  _$jscoverage['plugins/table.action.js'][675] = 0;
  _$jscoverage['plugins/table.action.js'][676] = 0;
  _$jscoverage['plugins/table.action.js'][677] = 0;
  _$jscoverage['plugins/table.action.js'][678] = 0;
  _$jscoverage['plugins/table.action.js'][679] = 0;
  _$jscoverage['plugins/table.action.js'][681] = 0;
  _$jscoverage['plugins/table.action.js'][683] = 0;
  _$jscoverage['plugins/table.action.js'][693] = 0;
  _$jscoverage['plugins/table.action.js'][694] = 0;
  _$jscoverage['plugins/table.action.js'][695] = 0;
  _$jscoverage['plugins/table.action.js'][698] = 0;
  _$jscoverage['plugins/table.action.js'][699] = 0;
  _$jscoverage['plugins/table.action.js'][700] = 0;
  _$jscoverage['plugins/table.action.js'][701] = 0;
  _$jscoverage['plugins/table.action.js'][705] = 0;
  _$jscoverage['plugins/table.action.js'][706] = 0;
  _$jscoverage['plugins/table.action.js'][707] = 0;
  _$jscoverage['plugins/table.action.js'][708] = 0;
  _$jscoverage['plugins/table.action.js'][709] = 0;
  _$jscoverage['plugins/table.action.js'][712] = 0;
  _$jscoverage['plugins/table.action.js'][713] = 0;
  _$jscoverage['plugins/table.action.js'][714] = 0;
  _$jscoverage['plugins/table.action.js'][715] = 0;
  _$jscoverage['plugins/table.action.js'][717] = 0;
  _$jscoverage['plugins/table.action.js'][718] = 0;
  _$jscoverage['plugins/table.action.js'][719] = 0;
  _$jscoverage['plugins/table.action.js'][722] = 0;
  _$jscoverage['plugins/table.action.js'][726] = 0;
  _$jscoverage['plugins/table.action.js'][727] = 0;
  _$jscoverage['plugins/table.action.js'][728] = 0;
  _$jscoverage['plugins/table.action.js'][730] = 0;
  _$jscoverage['plugins/table.action.js'][736] = 0;
  _$jscoverage['plugins/table.action.js'][737] = 0;
  _$jscoverage['plugins/table.action.js'][739] = 0;
  _$jscoverage['plugins/table.action.js'][742] = 0;
  _$jscoverage['plugins/table.action.js'][743] = 0;
  _$jscoverage['plugins/table.action.js'][744] = 0;
  _$jscoverage['plugins/table.action.js'][745] = 0;
  _$jscoverage['plugins/table.action.js'][746] = 0;
  _$jscoverage['plugins/table.action.js'][747] = 0;
  _$jscoverage['plugins/table.action.js'][748] = 0;
  _$jscoverage['plugins/table.action.js'][749] = 0;
  _$jscoverage['plugins/table.action.js'][750] = 0;
  _$jscoverage['plugins/table.action.js'][752] = 0;
  _$jscoverage['plugins/table.action.js'][755] = 0;
  _$jscoverage['plugins/table.action.js'][757] = 0;
  _$jscoverage['plugins/table.action.js'][758] = 0;
  _$jscoverage['plugins/table.action.js'][759] = 0;
  _$jscoverage['plugins/table.action.js'][760] = 0;
  _$jscoverage['plugins/table.action.js'][763] = 0;
  _$jscoverage['plugins/table.action.js'][765] = 0;
  _$jscoverage['plugins/table.action.js'][766] = 0;
  _$jscoverage['plugins/table.action.js'][767] = 0;
  _$jscoverage['plugins/table.action.js'][769] = 0;
  _$jscoverage['plugins/table.action.js'][770] = 0;
  _$jscoverage['plugins/table.action.js'][773] = 0;
  _$jscoverage['plugins/table.action.js'][774] = 0;
  _$jscoverage['plugins/table.action.js'][775] = 0;
  _$jscoverage['plugins/table.action.js'][776] = 0;
  _$jscoverage['plugins/table.action.js'][779] = 0;
  _$jscoverage['plugins/table.action.js'][783] = 0;
  _$jscoverage['plugins/table.action.js'][787] = 0;
  _$jscoverage['plugins/table.action.js'][791] = 0;
  _$jscoverage['plugins/table.action.js'][793] = 0;
  _$jscoverage['plugins/table.action.js'][794] = 0;
  _$jscoverage['plugins/table.action.js'][795] = 0;
  _$jscoverage['plugins/table.action.js'][796] = 0;
  _$jscoverage['plugins/table.action.js'][797] = 0;
  _$jscoverage['plugins/table.action.js'][800] = 0;
  _$jscoverage['plugins/table.action.js'][804] = 0;
  _$jscoverage['plugins/table.action.js'][805] = 0;
  _$jscoverage['plugins/table.action.js'][807] = 0;
  _$jscoverage['plugins/table.action.js'][808] = 0;
  _$jscoverage['plugins/table.action.js'][809] = 0;
  _$jscoverage['plugins/table.action.js'][810] = 0;
  _$jscoverage['plugins/table.action.js'][811] = 0;
  _$jscoverage['plugins/table.action.js'][812] = 0;
  _$jscoverage['plugins/table.action.js'][813] = 0;
  _$jscoverage['plugins/table.action.js'][814] = 0;
  _$jscoverage['plugins/table.action.js'][816] = 0;
  _$jscoverage['plugins/table.action.js'][817] = 0;
  _$jscoverage['plugins/table.action.js'][819] = 0;
  _$jscoverage['plugins/table.action.js'][820] = 0;
  _$jscoverage['plugins/table.action.js'][822] = 0;
  _$jscoverage['plugins/table.action.js'][823] = 0;
  _$jscoverage['plugins/table.action.js'][825] = 0;
  _$jscoverage['plugins/table.action.js'][826] = 0;
  _$jscoverage['plugins/table.action.js'][828] = 0;
  _$jscoverage['plugins/table.action.js'][830] = 0;
  _$jscoverage['plugins/table.action.js'][832] = 0;
  _$jscoverage['plugins/table.action.js'][833] = 0;
  _$jscoverage['plugins/table.action.js'][834] = 0;
  _$jscoverage['plugins/table.action.js'][838] = 0;
  _$jscoverage['plugins/table.action.js'][839] = 0;
  _$jscoverage['plugins/table.action.js'][840] = 0;
  _$jscoverage['plugins/table.action.js'][844] = 0;
  _$jscoverage['plugins/table.action.js'][845] = 0;
  _$jscoverage['plugins/table.action.js'][848] = 0;
  _$jscoverage['plugins/table.action.js'][863] = 0;
  _$jscoverage['plugins/table.action.js'][864] = 0;
  _$jscoverage['plugins/table.action.js'][866] = 0;
  _$jscoverage['plugins/table.action.js'][867] = 0;
  _$jscoverage['plugins/table.action.js'][869] = 0;
  _$jscoverage['plugins/table.action.js'][871] = 0;
  _$jscoverage['plugins/table.action.js'][880] = 0;
  _$jscoverage['plugins/table.action.js'][881] = 0;
  _$jscoverage['plugins/table.action.js'][882] = 0;
  _$jscoverage['plugins/table.action.js'][883] = 0;
  _$jscoverage['plugins/table.action.js'][888] = 0;
  _$jscoverage['plugins/table.action.js'][895] = 0;
  _$jscoverage['plugins/table.action.js'][896] = 0;
  _$jscoverage['plugins/table.action.js'][897] = 0;
  _$jscoverage['plugins/table.action.js'][899] = 0;
  _$jscoverage['plugins/table.action.js'][901] = 0;
  _$jscoverage['plugins/table.action.js'][908] = 0;
  _$jscoverage['plugins/table.action.js'][909] = 0;
  _$jscoverage['plugins/table.action.js'][910] = 0;
  _$jscoverage['plugins/table.action.js'][911] = 0;
  _$jscoverage['plugins/table.action.js'][912] = 0;
  _$jscoverage['plugins/table.action.js'][913] = 0;
  _$jscoverage['plugins/table.action.js'][914] = 0;
  _$jscoverage['plugins/table.action.js'][916] = 0;
  _$jscoverage['plugins/table.action.js'][919] = 0;
  _$jscoverage['plugins/table.action.js'][921] = 0;
  _$jscoverage['plugins/table.action.js'][930] = 0;
  _$jscoverage['plugins/table.action.js'][931] = 0;
  _$jscoverage['plugins/table.action.js'][932] = 0;
  _$jscoverage['plugins/table.action.js'][933] = 0;
  _$jscoverage['plugins/table.action.js'][935] = 0;
  _$jscoverage['plugins/table.action.js'][936] = 0;
  _$jscoverage['plugins/table.action.js'][938] = 0;
  _$jscoverage['plugins/table.action.js'][939] = 0;
  _$jscoverage['plugins/table.action.js'][941] = 0;
  _$jscoverage['plugins/table.action.js'][942] = 0;
  _$jscoverage['plugins/table.action.js'][944] = 0;
  _$jscoverage['plugins/table.action.js'][947] = 0;
  _$jscoverage['plugins/table.action.js'][949] = 0;
  _$jscoverage['plugins/table.action.js'][950] = 0;
  _$jscoverage['plugins/table.action.js'][952] = 0;
  _$jscoverage['plugins/table.action.js'][953] = 0;
  _$jscoverage['plugins/table.action.js'][954] = 0;
  _$jscoverage['plugins/table.action.js'][955] = 0;
  _$jscoverage['plugins/table.action.js'][956] = 0;
  _$jscoverage['plugins/table.action.js'][959] = 0;
  _$jscoverage['plugins/table.action.js'][960] = 0;
  _$jscoverage['plugins/table.action.js'][961] = 0;
  _$jscoverage['plugins/table.action.js'][962] = 0;
  _$jscoverage['plugins/table.action.js'][964] = 0;
  _$jscoverage['plugins/table.action.js'][965] = 0;
  _$jscoverage['plugins/table.action.js'][966] = 0;
  _$jscoverage['plugins/table.action.js'][972] = 0;
  _$jscoverage['plugins/table.action.js'][974] = 0;
  _$jscoverage['plugins/table.action.js'][975] = 0;
  _$jscoverage['plugins/table.action.js'][978] = 0;
  _$jscoverage['plugins/table.action.js'][979] = 0;
  _$jscoverage['plugins/table.action.js'][982] = 0;
  _$jscoverage['plugins/table.action.js'][983] = 0;
  _$jscoverage['plugins/table.action.js'][985] = 0;
  _$jscoverage['plugins/table.action.js'][986] = 0;
  _$jscoverage['plugins/table.action.js'][987] = 0;
  _$jscoverage['plugins/table.action.js'][988] = 0;
  _$jscoverage['plugins/table.action.js'][989] = 0;
  _$jscoverage['plugins/table.action.js'][991] = 0;
  _$jscoverage['plugins/table.action.js'][992] = 0;
  _$jscoverage['plugins/table.action.js'][993] = 0;
  _$jscoverage['plugins/table.action.js'][994] = 0;
  _$jscoverage['plugins/table.action.js'][996] = 0;
  _$jscoverage['plugins/table.action.js'][997] = 0;
  _$jscoverage['plugins/table.action.js'][998] = 0;
  _$jscoverage['plugins/table.action.js'][999] = 0;
  _$jscoverage['plugins/table.action.js'][1000] = 0;
  _$jscoverage['plugins/table.action.js'][1002] = 0;
  _$jscoverage['plugins/table.action.js'][1003] = 0;
  _$jscoverage['plugins/table.action.js'][1004] = 0;
  _$jscoverage['plugins/table.action.js'][1005] = 0;
  _$jscoverage['plugins/table.action.js'][1007] = 0;
  _$jscoverage['plugins/table.action.js'][1008] = 0;
  _$jscoverage['plugins/table.action.js'][1012] = 0;
  _$jscoverage['plugins/table.action.js'][1013] = 0;
  _$jscoverage['plugins/table.action.js'][1014] = 0;
  _$jscoverage['plugins/table.action.js'][1016] = 0;
  _$jscoverage['plugins/table.action.js'][1020] = 0;
  _$jscoverage['plugins/table.action.js'][1021] = 0;
  _$jscoverage['plugins/table.action.js'][1022] = 0;
  _$jscoverage['plugins/table.action.js'][1023] = 0;
  _$jscoverage['plugins/table.action.js'][1024] = 0;
  _$jscoverage['plugins/table.action.js'][1025] = 0;
  _$jscoverage['plugins/table.action.js'][1028] = 0;
  _$jscoverage['plugins/table.action.js'][1031] = 0;
  _$jscoverage['plugins/table.action.js'][1032] = 0;
  _$jscoverage['plugins/table.action.js'][1034] = 0;
  _$jscoverage['plugins/table.action.js'][1035] = 0;
  _$jscoverage['plugins/table.action.js'][1036] = 0;
  _$jscoverage['plugins/table.action.js'][1038] = 0;
  _$jscoverage['plugins/table.action.js'][1040] = 0;
  _$jscoverage['plugins/table.action.js'][1041] = 0;
  _$jscoverage['plugins/table.action.js'][1043] = 0;
  _$jscoverage['plugins/table.action.js'][1044] = 0;
  _$jscoverage['plugins/table.action.js'][1047] = 0;
  _$jscoverage['plugins/table.action.js'][1048] = 0;
  _$jscoverage['plugins/table.action.js'][1050] = 0;
  _$jscoverage['plugins/table.action.js'][1051] = 0;
  _$jscoverage['plugins/table.action.js'][1054] = 0;
  _$jscoverage['plugins/table.action.js'][1055] = 0;
  _$jscoverage['plugins/table.action.js'][1056] = 0;
  _$jscoverage['plugins/table.action.js'][1057] = 0;
  _$jscoverage['plugins/table.action.js'][1058] = 0;
  _$jscoverage['plugins/table.action.js'][1059] = 0;
  _$jscoverage['plugins/table.action.js'][1060] = 0;
  _$jscoverage['plugins/table.action.js'][1063] = 0;
  _$jscoverage['plugins/table.action.js'][1065] = 0;
  _$jscoverage['plugins/table.action.js'][1066] = 0;
  _$jscoverage['plugins/table.action.js'][1067] = 0;
  _$jscoverage['plugins/table.action.js'][1068] = 0;
  _$jscoverage['plugins/table.action.js'][1070] = 0;
  _$jscoverage['plugins/table.action.js'][1073] = 0;
  _$jscoverage['plugins/table.action.js'][1074] = 0;
  _$jscoverage['plugins/table.action.js'][1075] = 0;
  _$jscoverage['plugins/table.action.js'][1078] = 0;
  _$jscoverage['plugins/table.action.js'][1079] = 0;
  _$jscoverage['plugins/table.action.js'][1083] = 0;
  _$jscoverage['plugins/table.action.js'][1084] = 0;
  _$jscoverage['plugins/table.action.js'][1086] = 0;
  _$jscoverage['plugins/table.action.js'][1089] = 0;
  _$jscoverage['plugins/table.action.js'][1090] = 0;
  _$jscoverage['plugins/table.action.js'][1092] = 0;
  _$jscoverage['plugins/table.action.js'][1094] = 0;
  _$jscoverage['plugins/table.action.js'][1097] = 0;
  _$jscoverage['plugins/table.action.js'][1098] = 0;
  _$jscoverage['plugins/table.action.js'][1099] = 0;
  _$jscoverage['plugins/table.action.js'][1100] = 0;
  _$jscoverage['plugins/table.action.js'][1101] = 0;
  _$jscoverage['plugins/table.action.js'][1102] = 0;
  _$jscoverage['plugins/table.action.js'][1104] = 0;
  _$jscoverage['plugins/table.action.js'][1105] = 0;
  _$jscoverage['plugins/table.action.js'][1109] = 0;
  _$jscoverage['plugins/table.action.js'][1112] = 0;
  _$jscoverage['plugins/table.action.js'][1113] = 0;
  _$jscoverage['plugins/table.action.js'][1115] = 0;
  _$jscoverage['plugins/table.action.js'][1116] = 0;
  _$jscoverage['plugins/table.action.js'][1117] = 0;
  _$jscoverage['plugins/table.action.js'][1120] = 0;
  _$jscoverage['plugins/table.action.js'][1121] = 0;
  _$jscoverage['plugins/table.action.js'][1122] = 0;
  _$jscoverage['plugins/table.action.js'][1125] = 0;
  _$jscoverage['plugins/table.action.js'][1126] = 0;
  _$jscoverage['plugins/table.action.js'][1127] = 0;
  _$jscoverage['plugins/table.action.js'][1128] = 0;
  _$jscoverage['plugins/table.action.js'][1129] = 0;
  _$jscoverage['plugins/table.action.js'][1138] = 0;
  _$jscoverage['plugins/table.action.js'][1139] = 0;
  _$jscoverage['plugins/table.action.js'][1140] = 0;
  _$jscoverage['plugins/table.action.js'][1141] = 0;
  _$jscoverage['plugins/table.action.js'][1143] = 0;
  _$jscoverage['plugins/table.action.js'][1144] = 0;
  _$jscoverage['plugins/table.action.js'][1145] = 0;
  _$jscoverage['plugins/table.action.js'][1146] = 0;
  _$jscoverage['plugins/table.action.js'][1149] = 0;
  _$jscoverage['plugins/table.action.js'][1150] = 0;
  _$jscoverage['plugins/table.action.js'][1151] = 0;
  _$jscoverage['plugins/table.action.js'][1157] = 0;
  _$jscoverage['plugins/table.action.js'][1158] = 0;
  _$jscoverage['plugins/table.action.js'][1159] = 0;
  _$jscoverage['plugins/table.action.js'][1160] = 0;
  _$jscoverage['plugins/table.action.js'][1161] = 0;
  _$jscoverage['plugins/table.action.js'][1164] = 0;
  _$jscoverage['plugins/table.action.js'][1165] = 0;
  _$jscoverage['plugins/table.action.js'][1171] = 0;
  _$jscoverage['plugins/table.action.js'][1172] = 0;
  _$jscoverage['plugins/table.action.js'][1173] = 0;
  _$jscoverage['plugins/table.action.js'][1174] = 0;
  _$jscoverage['plugins/table.action.js'][1183] = 0;
  _$jscoverage['plugins/table.action.js'][1186] = 0;
  _$jscoverage['plugins/table.action.js'][1187] = 0;
  _$jscoverage['plugins/table.action.js'][1188] = 0;
  _$jscoverage['plugins/table.action.js'][1189] = 0;
  _$jscoverage['plugins/table.action.js'][1190] = 0;
  _$jscoverage['plugins/table.action.js'][1199] = 0;
  _$jscoverage['plugins/table.action.js'][1200] = 0;
  _$jscoverage['plugins/table.action.js'][1201] = 0;
  _$jscoverage['plugins/table.action.js'][1207] = 0;
  _$jscoverage['plugins/table.action.js'][1209] = 0;
  _$jscoverage['plugins/table.action.js'][1210] = 0;
  _$jscoverage['plugins/table.action.js'][1211] = 0;
  _$jscoverage['plugins/table.action.js'][1213] = 0;
  _$jscoverage['plugins/table.action.js'][1215] = 0;
  _$jscoverage['plugins/table.action.js'][1216] = 0;
  _$jscoverage['plugins/table.action.js'][1226] = 0;
  _$jscoverage['plugins/table.action.js'][1227] = 0;
  _$jscoverage['plugins/table.action.js'][1228] = 0;
  _$jscoverage['plugins/table.action.js'][1229] = 0;
  _$jscoverage['plugins/table.action.js'][1230] = 0;
  _$jscoverage['plugins/table.action.js'][1231] = 0;
  _$jscoverage['plugins/table.action.js'][1232] = 0;
  _$jscoverage['plugins/table.action.js'][1233] = 0;
  _$jscoverage['plugins/table.action.js'][1234] = 0;
  _$jscoverage['plugins/table.action.js'][1236] = 0;
  _$jscoverage['plugins/table.action.js'][1243] = 0;
  _$jscoverage['plugins/table.action.js'][1244] = 0;
  _$jscoverage['plugins/table.action.js'][1245] = 0;
  _$jscoverage['plugins/table.action.js'][1248] = 0;
  _$jscoverage['plugins/table.action.js'][1249] = 0;
  _$jscoverage['plugins/table.action.js'][1251] = 0;
}
_$jscoverage['plugins/table.action.js'].source = ["<span class=\"c\">/**</span>","<span class=\"c\"> * Created with JetBrains PhpStorm.</span>","<span class=\"c\"> * User: taoqili</span>","<span class=\"c\"> * Date: 12-10-12</span>","<span class=\"c\"> * Time: &#19978;&#21320;10:05</span>","<span class=\"c\"> * To change this template use File | Settings | File Templates.</span>","<span class=\"c\"> */</span>","UE<span class=\"k\">.</span>plugins<span class=\"k\">[</span><span class=\"s\">'table'</span><span class=\"k\">]</span> <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","    <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">,</span>","        debug <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">,</span>","        UT <span class=\"k\">=</span> UE<span class=\"k\">.</span>UETable<span class=\"k\">,</span>","        getUETable <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>tdOrTable<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> UT<span class=\"k\">.</span>getUETable<span class=\"k\">(</span>tdOrTable<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">,</span>","        getUETableBySelected <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>editor<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> UT<span class=\"k\">.</span>getUETableBySelected<span class=\"k\">(</span>editor<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">,</span>","        getDefaultValue <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>editor<span class=\"k\">,</span> table<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> UT<span class=\"k\">.</span>getDefaultValue<span class=\"k\">(</span>editor<span class=\"k\">,</span> table<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">,</span>","        removeSelectedClass <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cells<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> UT<span class=\"k\">.</span>removeSelectedClass<span class=\"k\">(</span>cells<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">;</span>","","    <span class=\"k\">function</span> showError<span class=\"k\">(</span>e<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>debug<span class=\"k\">)</span> <span class=\"k\">throw</span> e<span class=\"k\">;</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">//&#22788;&#29702;&#25302;&#21160;&#21450;&#26694;&#36873;&#30456;&#20851;&#26041;&#27861;</span>","    <span class=\"k\">var</span> startTd <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">,</span> <span class=\"c\">//&#40736;&#26631;&#25353;&#19979;&#26102;&#30340;&#38170;&#28857;td</span>","        currentTd <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">,</span> <span class=\"c\">//&#24403;&#21069;&#40736;&#26631;&#32463;&#36807;&#26102;&#30340;td</span>","        onDrag <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"c\">//&#25351;&#31034;&#24403;&#21069;&#25302;&#21160;&#29366;&#24577;&#65292;&#20854;&#20540;&#21487;&#20026;\"\",\"h\",\"v\" ,&#20998;&#21035;&#34920;&#31034;&#26410;&#25302;&#21160;&#29366;&#24577;&#65292;&#27178;&#21521;&#25302;&#21160;&#29366;&#24577;&#65292;&#32437;&#21521;&#25302;&#21160;&#29366;&#24577;&#65292;&#29992;&#20110;&#40736;&#26631;&#31227;&#21160;&#36807;&#31243;&#20013;&#30340;&#21028;&#26029;</span>","        onBorder <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"c\">//&#26816;&#27979;&#40736;&#26631;&#25353;&#19979;&#26102;&#26159;&#21542;&#22788;&#22312;&#21333;&#20803;&#26684;&#36793;&#32536;&#20301;&#32622;</span>","        dragButton <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">,</span>","        dragOver <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">,</span>","        dragLine <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">,</span> <span class=\"c\">//&#27169;&#25311;&#30340;&#25302;&#21160;&#32447;</span>","        dragTd <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>    <span class=\"c\">//&#21457;&#29983;&#25302;&#21160;&#30340;&#30446;&#26631;td</span>","","    <span class=\"k\">var</span> mousedown <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">,</span>","    <span class=\"c\">//todo &#21028;&#26029;&#28151;&#20081;&#27169;&#24335;</span>","        needIEHack <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","","    me<span class=\"k\">.</span>setOpt<span class=\"k\">(</span><span class=\"k\">{</span>","        <span class=\"s\">'maxColNum'</span><span class=\"k\">:</span><span class=\"s\">20</span><span class=\"k\">,</span>","        <span class=\"s\">'maxRowNum'</span><span class=\"k\">:</span><span class=\"s\">100</span><span class=\"k\">,</span>","        <span class=\"s\">'defaultCols'</span><span class=\"k\">:</span><span class=\"s\">5</span><span class=\"k\">,</span>","        <span class=\"s\">'defaultRows'</span><span class=\"k\">:</span><span class=\"s\">5</span><span class=\"k\">,</span>","        <span class=\"s\">'tdvalign'</span><span class=\"k\">:</span><span class=\"s\">'top'</span><span class=\"k\">,</span>","        <span class=\"s\">'cursorpath'</span><span class=\"k\">:</span>me<span class=\"k\">.</span>options<span class=\"k\">.</span>UEDITOR_HOME_URL <span class=\"k\">+</span> <span class=\"s\">\"themes/default/images/cursor_\"</span><span class=\"k\">,</span>","        <span class=\"s\">'tableDragable'</span><span class=\"k\">:</span><span class=\"k\">false</span><span class=\"k\">,</span>","        <span class=\"s\">'classList'</span><span class=\"k\">:[</span><span class=\"s\">\"back1\"</span><span class=\"k\">,</span><span class=\"s\">\"back2\"</span><span class=\"k\">]</span>","    <span class=\"k\">}</span><span class=\"k\">);</span>","    me<span class=\"k\">.</span>getUETable <span class=\"k\">=</span> getUETable<span class=\"k\">;</span>","    <span class=\"k\">var</span> commands <span class=\"k\">=</span> <span class=\"k\">{</span>","        <span class=\"s\">'deletetable'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'inserttable'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'cellvalign'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'insertcaption'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'deletecaption'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'inserttitle'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">'deletetitle'</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"mergeright\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"mergedown\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"mergecells\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertrow\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertrownext\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"deleterow\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertcol\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertcolnext\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"deletecol\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"splittocells\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"splittorows\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"splittocols\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"adaptbytext\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"adaptbywindow\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"adaptbycustomer\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertparagraph\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"insertparagraphbeforetable\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"averagedistributecol\"</span><span class=\"k\">:</span><span class=\"s\">1</span><span class=\"k\">,</span>","        <span class=\"s\">\"averagedistributerow\"</span><span class=\"k\">:</span><span class=\"s\">1</span>","    <span class=\"k\">}</span><span class=\"k\">;</span>","    me<span class=\"k\">.</span>ready<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","        utils<span class=\"k\">.</span>cssRule<span class=\"k\">(</span><span class=\"s\">'table'</span><span class=\"k\">,</span>","            <span class=\"c\">//&#36873;&#20013;&#30340;td&#19978;&#30340;&#26679;&#24335;</span>","            <span class=\"s\">'.selectTdClass{background-color:#edf5fa !important}'</span> <span class=\"k\">+</span>","                <span class=\"s\">'table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}'</span> <span class=\"k\">+</span>","                <span class=\"c\">//&#25554;&#20837;&#30340;&#34920;&#26684;&#30340;&#40664;&#35748;&#26679;&#24335;</span>","                <span class=\"s\">'table{margin-bottom:10px;border-collapse:collapse;display:table;}'</span> <span class=\"k\">+</span>","                <span class=\"s\">'td,th{padding: 5px 10px;border: 1px solid #DDD;}'</span> <span class=\"k\">+</span>","                <span class=\"s\">'caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}'</span> <span class=\"k\">+</span>","                <span class=\"s\">'th{border-top:2px solid #BBB;background:#F7F7F7;}'</span> <span class=\"k\">+</span>","                <span class=\"s\">'td p{margin:0;padding:0;}'</span><span class=\"k\">,</span> me<span class=\"k\">.</span>document<span class=\"k\">);</span>","","        <span class=\"k\">var</span> tableCopyList<span class=\"k\">,</span> isFullCol<span class=\"k\">,</span> isFullRow<span class=\"k\">;</span>","        <span class=\"c\">//&#27880;&#20876;del/backspace&#20107;&#20214;</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'keydown'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cmd<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> keyCode <span class=\"k\">=</span> evt<span class=\"k\">.</span>keyCode <span class=\"k\">||</span> evt<span class=\"k\">.</span>which<span class=\"k\">;</span>","","            <span class=\"k\">if</span> <span class=\"k\">(</span>keyCode <span class=\"k\">==</span> <span class=\"s\">8</span><span class=\"k\">)</span> <span class=\"k\">{</span>","","                <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>ut <span class=\"k\">&amp;&amp;</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">.</span>length<span class=\"k\">)</span> <span class=\"k\">{</span>","                    me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">.</span>isFullCol<span class=\"k\">())</span> <span class=\"k\">{</span>","                        me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'deletecol'</span><span class=\"k\">)</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">.</span>isFullRow<span class=\"k\">())</span> <span class=\"k\">{</span>","                        me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'deleterow'</span><span class=\"k\">)</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                        me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'delcells'</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                    domUtils<span class=\"k\">.</span>preventDefault<span class=\"k\">(</span>evt<span class=\"k\">);</span>","                <span class=\"k\">}</span>","","                <span class=\"k\">var</span> caption <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getStart<span class=\"k\">(),</span> <span class=\"s\">'caption'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">),</span>","                    range <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>range<span class=\"k\">.</span>collapsed <span class=\"k\">&amp;&amp;</span> caption <span class=\"k\">&amp;&amp;</span> isEmptyBlock<span class=\"k\">(</span>caption<span class=\"k\">))</span> <span class=\"k\">{</span>","                    me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    <span class=\"k\">var</span> table <span class=\"k\">=</span> caption<span class=\"k\">.</span>parentNode<span class=\"k\">;</span>","                    domUtils<span class=\"k\">.</span>remove<span class=\"k\">(</span>caption<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                        range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","","            <span class=\"k\">if</span> <span class=\"k\">(</span>keyCode <span class=\"k\">==</span> <span class=\"s\">46</span><span class=\"k\">)</span> <span class=\"k\">{</span>","","                ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","                    me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> ci<span class=\"k\">;</span> ci <span class=\"k\">=</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                        domUtils<span class=\"k\">.</span>fillNode<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> ci<span class=\"k\">)</span>","                    <span class=\"k\">}</span>","                    me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    domUtils<span class=\"k\">.</span>preventDefault<span class=\"k\">(</span>evt<span class=\"k\">);</span>","","                <span class=\"k\">}</span>","","            <span class=\"k\">}</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>keyCode <span class=\"k\">==</span> <span class=\"s\">13</span><span class=\"k\">)</span> <span class=\"k\">{</span>","","                <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">(),</span>","                    caption <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>rng<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"s\">'caption'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>caption<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>caption<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(!</span>rng<span class=\"k\">.</span>collapsed<span class=\"k\">)</span> <span class=\"k\">{</span>","","                        rng<span class=\"k\">.</span>deleteContents<span class=\"k\">();</span>","                        me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>caption<span class=\"k\">)</span> <span class=\"k\">{</span>","                            rng<span class=\"k\">.</span>setStart<span class=\"k\">(</span>table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                    domUtils<span class=\"k\">.</span>preventDefault<span class=\"k\">(</span>evt<span class=\"k\">);</span>","                    <span class=\"k\">return</span><span class=\"k\">;</span>","                <span class=\"k\">}</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>rng<span class=\"k\">.</span>collapsed<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>rng<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> cell <span class=\"k\">=</span> table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span>","                            start <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getStart<span class=\"k\">(),</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">),</span>","                            preNode <span class=\"k\">=</span> table<span class=\"k\">.</span>previousSibling<span class=\"k\">;</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>cell <span class=\"k\">===</span> start <span class=\"k\">&amp;&amp;</span> <span class=\"k\">(!</span>preNode <span class=\"k\">||</span> preNode<span class=\"k\">.</span>nodeType <span class=\"k\">==</span> <span class=\"s\">1</span> <span class=\"k\">&amp;&amp;</span> preNode<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">'TABLE'</span> <span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> domUtils<span class=\"k\">.</span>isStartInblock<span class=\"k\">(</span>rng<span class=\"k\">))</span> <span class=\"k\">{</span>","                            me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'insertparagraphbeforetable'</span><span class=\"k\">);</span>","                            domUtils<span class=\"k\">.</span>preventDefault<span class=\"k\">(</span>evt<span class=\"k\">);</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span>","","            <span class=\"k\">if</span> <span class=\"k\">((</span>evt<span class=\"k\">.</span>ctrlKey <span class=\"k\">||</span> evt<span class=\"k\">.</span>metaKey<span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> evt<span class=\"k\">.</span>keyCode <span class=\"k\">==</span> <span class=\"s\">'67'</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                tableCopyList <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>","                <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> tds <span class=\"k\">=</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">;</span>","                    isFullCol <span class=\"k\">=</span> ut<span class=\"k\">.</span>isFullCol<span class=\"k\">();</span>","                    isFullRow <span class=\"k\">=</span> ut<span class=\"k\">.</span>isFullRow<span class=\"k\">();</span>","                    tableCopyList <span class=\"k\">=</span> <span class=\"k\">[</span>","                        <span class=\"k\">[</span>ut<span class=\"k\">.</span>cloneCell<span class=\"k\">(</span>tds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">])]</span>","                    <span class=\"k\">];</span>","                    <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">1</span><span class=\"k\">,</span> ci<span class=\"k\">;</span> ci <span class=\"k\">=</span> tds<span class=\"k\">[</span>i<span class=\"k\">];</span> i<span class=\"k\">++)</span> <span class=\"k\">{</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>ci<span class=\"k\">.</span>parentNode <span class=\"k\">!==</span> tds<span class=\"k\">[</span>i <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">].</span>parentNode<span class=\"k\">)</span> <span class=\"k\">{</span>","                            tableCopyList<span class=\"k\">.</span>push<span class=\"k\">([</span>ut<span class=\"k\">.</span>cloneCell<span class=\"k\">(</span>ci<span class=\"k\">)]);</span>","                        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                            tableCopyList<span class=\"k\">[</span>tableCopyList<span class=\"k\">.</span>length <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">].</span>push<span class=\"k\">(</span>ut<span class=\"k\">.</span>cloneCell<span class=\"k\">(</span>ci<span class=\"k\">));</span>","                        <span class=\"k\">}</span>","","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"tablehasdeleted\"</span><span class=\"k\">,</span><span class=\"k\">function</span><span class=\"k\">()</span><span class=\"k\">{</span>","            toggleDraggableState<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"k\">null</span><span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>dragButton<span class=\"k\">)</span>domUtils<span class=\"k\">.</span>remove<span class=\"k\">(</span>dragButton<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'beforepaste'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cmd<span class=\"k\">,</span> html<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>rng<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"s\">'caption'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                <span class=\"k\">var</span> div <span class=\"k\">=</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>createElement<span class=\"k\">(</span><span class=\"s\">\"div\"</span><span class=\"k\">);</span>","                div<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> html<span class=\"k\">.</span>html<span class=\"k\">;</span>","                html<span class=\"k\">.</span>html <span class=\"k\">=</span> div<span class=\"k\">[</span>browser<span class=\"k\">.</span>ie <span class=\"k\">?</span> <span class=\"s\">'innerText'</span> <span class=\"k\">:</span> <span class=\"s\">'textContent'</span><span class=\"k\">];</span>","                <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","            <span class=\"k\">var</span> table <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>tableCopyList<span class=\"k\">)</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","                <span class=\"k\">var</span> td <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>rng<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">),</span> tmpNode<span class=\"k\">,</span> preNode<span class=\"k\">;</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>td<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>isFullRow<span class=\"k\">)</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> rowIndex <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellInfo<span class=\"k\">(</span>td<span class=\"k\">).</span>rowIndex<span class=\"k\">;</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>td<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">'TH'</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                            rowIndex<span class=\"k\">++;</span>","                        <span class=\"k\">}</span>","                        <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> ci<span class=\"k\">;</span> ci <span class=\"k\">=</span> tableCopyList<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                            <span class=\"k\">var</span> tr <span class=\"k\">=</span> ut<span class=\"k\">.</span>insertRow<span class=\"k\">(</span>rowIndex<span class=\"k\">++,</span> <span class=\"s\">\"td\"</span><span class=\"k\">);</span>","                            <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> j <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> cj<span class=\"k\">;</span> cj <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">];</span> j<span class=\"k\">++)</span> <span class=\"k\">{</span>","                                <span class=\"k\">var</span> cell <span class=\"k\">=</span> tr<span class=\"k\">.</span>cells<span class=\"k\">[</span>j<span class=\"k\">];</span>","                                <span class=\"k\">if</span> <span class=\"k\">(!</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                                    cell <span class=\"k\">=</span> tr<span class=\"k\">.</span>insertCell<span class=\"k\">(</span>j<span class=\"k\">)</span>","                                <span class=\"k\">}</span>","                                cell<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> cj<span class=\"k\">.</span>innerHTML<span class=\"k\">;</span>","                                cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">));</span>","                                cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">));</span>","                                cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">));</span>","                                cj<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">&amp;&amp;</span> <span class=\"k\">(</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> cj<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText<span class=\"k\">)</span>","                            <span class=\"k\">}</span>","                            <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> j <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> cj<span class=\"k\">;</span> cj <span class=\"k\">=</span> tr<span class=\"k\">.</span>cells<span class=\"k\">[</span>j<span class=\"k\">];</span> j<span class=\"k\">++)</span> <span class=\"k\">{</span>","                                <span class=\"k\">if</span> <span class=\"k\">(!</span>ci<span class=\"k\">[</span>j<span class=\"k\">])</span>","                                    <span class=\"k\">break</span><span class=\"k\">;</span>","                                cj<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">].</span>innerHTML<span class=\"k\">;</span>","                                ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cj<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">,</span> ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">));</span>","                                ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cj<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">,</span> ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">));</span>","                                ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> cj<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">,</span> ci<span class=\"k\">[</span>j<span class=\"k\">].</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">));</span>","                                ci<span class=\"k\">[</span>j<span class=\"k\">].</span>style<span class=\"k\">.</span>cssText <span class=\"k\">&amp;&amp;</span> <span class=\"k\">(</span>cj<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">].</span>style<span class=\"k\">.</span>cssText<span class=\"k\">)</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>isFullCol<span class=\"k\">)</span> <span class=\"k\">{</span>","                            cellInfo <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellInfo<span class=\"k\">(</span>td<span class=\"k\">);</span>","                            <span class=\"k\">var</span> maxColNum <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span>","                            <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> j <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> ci <span class=\"k\">=</span> tableCopyList<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> cj<span class=\"k\">;</span> cj <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                                maxColNum <span class=\"k\">+=</span> cj<span class=\"k\">.</span>colSpan <span class=\"k\">||</span> <span class=\"s\">1</span><span class=\"k\">;</span>","                            <span class=\"k\">}</span>","                            me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","                            <span class=\"k\">for</span> <span class=\"k\">(</span>i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span> i <span class=\"k\">&lt;</span> maxColNum<span class=\"k\">;</span> i<span class=\"k\">++)</span> <span class=\"k\">{</span>","                                me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'insertcol'</span><span class=\"k\">);</span>","                            <span class=\"k\">}</span>","                            me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","                            td <span class=\"k\">=</span> ut<span class=\"k\">.</span>table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>cells<span class=\"k\">[</span>cellInfo<span class=\"k\">.</span>cellIndex<span class=\"k\">];</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>td<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">'TH'</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                                td <span class=\"k\">=</span> ut<span class=\"k\">.</span>table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">1</span><span class=\"k\">].</span>cells<span class=\"k\">[</span>cellInfo<span class=\"k\">.</span>cellIndex<span class=\"k\">];</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                        <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> ci<span class=\"k\">;</span> ci <span class=\"k\">=</span> tableCopyList<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                            tmpNode <span class=\"k\">=</span> td<span class=\"k\">;</span>","                            <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> j <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> cj<span class=\"k\">;</span> cj <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                                <span class=\"k\">if</span> <span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","                                    td<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> cj<span class=\"k\">.</span>innerHTML<span class=\"k\">;</span>","                                    <span class=\"c\">//todo &#23450;&#21046;&#22788;&#29702;</span>","                                    cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> td<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'width'</span><span class=\"k\">));</span>","                                    cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> td<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'vAlign'</span><span class=\"k\">));</span>","                                    cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> td<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">,</span> cj<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">'align'</span><span class=\"k\">));</span>","                                    cj<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">&amp;&amp;</span> <span class=\"k\">(</span>td<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> cj<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText<span class=\"k\">);</span>","                                    preNode <span class=\"k\">=</span> td<span class=\"k\">;</span>","                                    td <span class=\"k\">=</span> td<span class=\"k\">.</span>nextSibling<span class=\"k\">;</span>","                                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                    <span class=\"k\">var</span> cloneTd <span class=\"k\">=</span> cj<span class=\"k\">.</span>cloneNode<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">);</span>","                                    domUtils<span class=\"k\">.</span>removeAttributes<span class=\"k\">(</span>cloneTd<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'class'</span><span class=\"k\">,</span> <span class=\"s\">'rowSpan'</span><span class=\"k\">,</span> <span class=\"s\">'colSpan'</span><span class=\"k\">]);</span>","","                                    preNode<span class=\"k\">.</span>parentNode<span class=\"k\">.</span>appendChild<span class=\"k\">(</span>cloneTd<span class=\"k\">)</span>","                                <span class=\"k\">}</span>","                            <span class=\"k\">}</span>","                            td <span class=\"k\">=</span> ut<span class=\"k\">.</span>getNextCell<span class=\"k\">(</span>tmpNode<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                            <span class=\"k\">if</span> <span class=\"k\">(!</span>tableCopyList<span class=\"k\">[</span>i<span class=\"k\">])</span>","                                <span class=\"k\">break</span><span class=\"k\">;</span>","                            <span class=\"k\">if</span> <span class=\"k\">(!</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","                                <span class=\"k\">var</span> cellInfo <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellInfo<span class=\"k\">(</span>tmpNode<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>table<span class=\"k\">.</span>insertRow<span class=\"k\">(</span>ut<span class=\"k\">.</span>table<span class=\"k\">.</span>rows<span class=\"k\">.</span>length<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>update<span class=\"k\">();</span>","                                td <span class=\"k\">=</span> ut<span class=\"k\">.</span>getVSideCell<span class=\"k\">(</span>tmpNode<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                    ut<span class=\"k\">.</span>update<span class=\"k\">();</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    table <span class=\"k\">=</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>createElement<span class=\"k\">(</span><span class=\"s\">'table'</span><span class=\"k\">);</span>","                    <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> ci<span class=\"k\">;</span> ci <span class=\"k\">=</span> tableCopyList<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> tr <span class=\"k\">=</span> table<span class=\"k\">.</span>insertRow<span class=\"k\">(</span>table<span class=\"k\">.</span>rows<span class=\"k\">.</span>length<span class=\"k\">);</span>","                        <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> j <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> cj<span class=\"k\">;</span> cj <span class=\"k\">=</span> ci<span class=\"k\">[</span>j<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                            cloneTd <span class=\"k\">=</span> UT<span class=\"k\">.</span>cloneCell<span class=\"k\">(</span>cj<span class=\"k\">);</span>","                            domUtils<span class=\"k\">.</span>removeAttributes<span class=\"k\">(</span>cloneTd<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'class'</span><span class=\"k\">]);</span>","                            tr<span class=\"k\">.</span>appendChild<span class=\"k\">(</span>cloneTd<span class=\"k\">)</span>","                        <span class=\"k\">}</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>j <span class=\"k\">==</span> <span class=\"s\">2</span> <span class=\"k\">&amp;&amp;</span> cloneTd<span class=\"k\">.</span>rowSpan <span class=\"k\">&gt;</span> <span class=\"s\">1</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                            cloneTd<span class=\"k\">.</span>rowSpan <span class=\"k\">=</span> <span class=\"s\">1</span><span class=\"k\">;</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","","                    <span class=\"k\">var</span> defaultValue <span class=\"k\">=</span> getDefaultValue<span class=\"k\">(</span>me<span class=\"k\">),</span>","                        width <span class=\"k\">=</span> me<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span>","                            <span class=\"k\">(</span>needIEHack <span class=\"k\">?</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">'margin-left'</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">)</span> <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">)</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tableBorder <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">-</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>options<span class=\"k\">.</span>offsetWidth <span class=\"k\">||</span> <span class=\"s\">0</span><span class=\"k\">);</span>","                    me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'insertHTML'</span><span class=\"k\">,</span> <span class=\"s\">'&lt;table  '</span> <span class=\"k\">+</span>","                        <span class=\"k\">(</span> isFullCol <span class=\"k\">&amp;&amp;</span> isFullRow <span class=\"k\">?</span> <span class=\"s\">'width=\"'</span> <span class=\"k\">+</span> width <span class=\"k\">+</span> <span class=\"s\">'\"'</span> <span class=\"k\">:</span> <span class=\"s\">''</span><span class=\"k\">)</span> <span class=\"k\">+</span>","                        <span class=\"s\">'&gt;'</span> <span class=\"k\">+</span> table<span class=\"k\">.</span>innerHTML<span class=\"k\">.</span>replace<span class=\"k\">(</span><span class=\"s\">/&gt;\\s*&lt;/g</span><span class=\"k\">,</span> <span class=\"s\">'&gt;&lt;'</span><span class=\"k\">).</span>replace<span class=\"k\">(</span><span class=\"s\">/\\bth\\b/gi</span><span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">'&lt;/table&gt;'</span><span class=\"k\">)</span>","                <span class=\"k\">}</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'contentchange'</span><span class=\"k\">);</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                html<span class=\"k\">.</span>html <span class=\"k\">=</span> <span class=\"s\">''</span><span class=\"k\">;</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                <span class=\"k\">var</span> div <span class=\"k\">=</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>createElement<span class=\"k\">(</span><span class=\"s\">\"div\"</span><span class=\"k\">),</span> tables<span class=\"k\">;</span>","                div<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> html<span class=\"k\">.</span>html<span class=\"k\">;</span>","                tables <span class=\"k\">=</span> div<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">\"table\"</span><span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getStart<span class=\"k\">(),</span> <span class=\"s\">'table'</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                    utils<span class=\"k\">.</span>each<span class=\"k\">(</span>tables<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>t<span class=\"k\">)</span> <span class=\"k\">{</span>","                        domUtils<span class=\"k\">.</span>remove<span class=\"k\">(</span>t<span class=\"k\">)</span>","                    <span class=\"k\">}</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getStart<span class=\"k\">(),</span> <span class=\"s\">'caption'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                        div<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> div<span class=\"k\">[</span>browser<span class=\"k\">.</span>ie <span class=\"k\">?</span> <span class=\"s\">'innerText'</span> <span class=\"k\">:</span> <span class=\"s\">'textContent'</span><span class=\"k\">];</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    utils<span class=\"k\">.</span>each<span class=\"k\">(</span>tables<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                        removeStyleSize<span class=\"k\">(</span>table<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                        domUtils<span class=\"k\">.</span>removeAttributes<span class=\"k\">(</span>table<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'style'</span><span class=\"k\">,</span> <span class=\"s\">'border'</span><span class=\"k\">]);</span>","                        utils<span class=\"k\">.</span>each<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>table<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>isEmptyBlock<span class=\"k\">(</span>td<span class=\"k\">))</span> <span class=\"k\">{</span>","                                domUtils<span class=\"k\">.</span>fillNode<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> td<span class=\"k\">);</span>","                            <span class=\"k\">}</span>","                            removeStyleSize<span class=\"k\">(</span>td<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","<span class=\"c\">//                            domUtils.removeAttributes(td, ['style'])</span>","                        <span class=\"k\">}</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span><span class=\"k\">);</span>","                <span class=\"k\">}</span>","                html<span class=\"k\">.</span>html <span class=\"k\">=</span> div<span class=\"k\">.</span>innerHTML<span class=\"k\">;</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'afterpaste'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            utils<span class=\"k\">.</span>each<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">.</span>offsetWidth <span class=\"k\">&gt;</span> me<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> defaultValue <span class=\"k\">=</span> getDefaultValue<span class=\"k\">(</span>me<span class=\"k\">,</span> table<span class=\"k\">);</span>","                    table<span class=\"k\">.</span>style<span class=\"k\">.</span>width <span class=\"k\">=</span> me<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span> <span class=\"k\">(</span>needIEHack <span class=\"k\">?</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">'margin-left'</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">)</span> <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">)</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tableBorder <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">-</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>options<span class=\"k\">.</span>offsetWidth <span class=\"k\">||</span> <span class=\"s\">0</span><span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">'px'</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span><span class=\"k\">)</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'blur'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            tableCopyList <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        <span class=\"k\">var</span> timer<span class=\"k\">;</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'keydown'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            clearTimeout<span class=\"k\">(</span>timer<span class=\"k\">);</span>","            timer <span class=\"k\">=</span> setTimeout<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">(),</span>","                    cell <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>rng<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'th'</span><span class=\"k\">,</span> <span class=\"s\">'td'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> table <span class=\"k\">=</span> cell<span class=\"k\">.</span>parentNode<span class=\"k\">.</span>parentNode<span class=\"k\">.</span>parentNode<span class=\"k\">;</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">.</span>offsetWidth <span class=\"k\">&gt;</span> table<span class=\"k\">.</span>getAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                        cell<span class=\"k\">.</span>style<span class=\"k\">.</span>wordBreak <span class=\"k\">=</span> <span class=\"s\">\"break-all\"</span><span class=\"k\">;</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","","            <span class=\"k\">}</span><span class=\"k\">,</span> <span class=\"s\">100</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"selectionchange\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            toggleDraggableState<span class=\"k\">(</span>me<span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"k\">null</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","","        <span class=\"c\">//&#20869;&#23481;&#21464;&#21270;&#26102;&#35302;&#21457;&#32034;&#24341;&#26356;&#26032;</span>","        <span class=\"c\">//todo &#21487;&#21542;&#32771;&#34385;&#26631;&#35760;&#26816;&#27979;&#65292;&#22914;&#26524;&#19981;&#28041;&#21450;&#34920;&#26684;&#30340;&#21464;&#21270;&#23601;&#19981;&#36827;&#34892;&#32034;&#24341;&#37325;&#24314;&#21644;&#26356;&#26032;</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"contentchange\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","            <span class=\"c\">//&#23613;&#21487;&#33021;&#25490;&#38500;&#19968;&#20123;&#19981;&#38656;&#35201;&#26356;&#26032;&#30340;&#29366;&#20917;</span>","            hideDragLine<span class=\"k\">(</span>me<span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">))</span><span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","            <span class=\"k\">var</span> start <span class=\"k\">=</span> rng<span class=\"k\">.</span>startContainer<span class=\"k\">;</span>","            start <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>start<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","            utils<span class=\"k\">.</span>each<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"excludetable\"</span><span class=\"k\">,</span> table<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","                table<span class=\"k\">.</span>ueTable <span class=\"k\">=</span> <span class=\"k\">new</span> UT<span class=\"k\">(</span>table<span class=\"k\">);</span>","                utils<span class=\"k\">.</span>each<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> <span class=\"s\">'td'</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","","                    <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>isEmptyBlock<span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> td <span class=\"k\">!==</span> start<span class=\"k\">)</span> <span class=\"k\">{</span>","                        domUtils<span class=\"k\">.</span>fillNode<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> td<span class=\"k\">);</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> browser<span class=\"k\">.</span>version <span class=\"k\">==</span> <span class=\"s\">6</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                            td<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> <span class=\"s\">'&amp;nbsp;'</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span><span class=\"k\">);</span>","                utils<span class=\"k\">.</span>each<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>th<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>isEmptyBlock<span class=\"k\">(</span>th<span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> th <span class=\"k\">!==</span> start<span class=\"k\">)</span> <span class=\"k\">{</span>","                        domUtils<span class=\"k\">.</span>fillNode<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> th<span class=\"k\">);</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> browser<span class=\"k\">.</span>version <span class=\"k\">==</span> <span class=\"s\">6</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                            th<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> <span class=\"s\">'&amp;nbsp;'</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span><span class=\"k\">);</span>","                table<span class=\"k\">.</span>onmousemove <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                    me<span class=\"k\">.</span>options<span class=\"k\">.</span>tableDragable <span class=\"k\">&amp;&amp;</span> toggleDragButton<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">,</span> <span class=\"k\">this</span><span class=\"k\">,</span> me<span class=\"k\">);</span>","                <span class=\"k\">}</span><span class=\"k\">;</span>","                table<span class=\"k\">.</span>onmouseout <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                    toggleDraggableState<span class=\"k\">(</span>me<span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"k\">null</span><span class=\"k\">);</span>","                    hideDragLine<span class=\"k\">(</span>me<span class=\"k\">);</span>","                <span class=\"k\">}</span><span class=\"k\">;</span>","                table<span class=\"k\">.</span>onclick <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","                    evt <span class=\"k\">=</span> me<span class=\"k\">.</span>window<span class=\"k\">.</span>event <span class=\"k\">||</span> evt<span class=\"k\">;</span>","                    <span class=\"k\">var</span> target <span class=\"k\">=</span> getParentTdOrTh<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(!</span>target<span class=\"k\">)</span><span class=\"k\">return</span><span class=\"k\">;</span>","                    <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>target<span class=\"k\">),</span>","                        table <span class=\"k\">=</span> ut<span class=\"k\">.</span>table<span class=\"k\">,</span>","                        cellInfo <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellInfo<span class=\"k\">(</span>target<span class=\"k\">),</span>","                        cellsRange<span class=\"k\">,</span>","                        rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","<span class=\"c\">//                    if (\"topLeft\" == inPosition(table, mouseCoords(evt))) {</span>","<span class=\"c\">//                        cellsRange = ut.getCellsRange(ut.table.rows[0].cells[0], ut.getLastCell());</span>","<span class=\"c\">//                        ut.setSelected(cellsRange);</span>","<span class=\"c\">//                        return;</span>","<span class=\"c\">//                    }</span>","<span class=\"c\">//                    if (\"bottomRight\" == inPosition(table, mouseCoords(evt))) {</span>","<span class=\"c\">//</span>","<span class=\"c\">//                        return;</span>","<span class=\"c\">//                    }</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>inTableSide<span class=\"k\">(</span>table<span class=\"k\">,</span> target<span class=\"k\">,</span> evt<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> endTdCol <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCell<span class=\"k\">(</span>ut<span class=\"k\">.</span>indexTable<span class=\"k\">[</span>ut<span class=\"k\">.</span>rowsNum <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">][</span>cellInfo<span class=\"k\">.</span>colIndex<span class=\"k\">].</span>rowIndex<span class=\"k\">,</span> ut<span class=\"k\">.</span>indexTable<span class=\"k\">[</span>ut<span class=\"k\">.</span>rowsNum <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">][</span>cellInfo<span class=\"k\">.</span>colIndex<span class=\"k\">].</span>cellIndex<span class=\"k\">);</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>shiftKey <span class=\"k\">&amp;&amp;</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">.</span>length<span class=\"k\">)</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">]</span> <span class=\"k\">!==</span> endTdCol<span class=\"k\">)</span> <span class=\"k\">{</span>","                                cellsRange <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> endTdCol<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>cellsRange<span class=\"k\">);</span>","                            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                rng <span class=\"k\">&amp;&amp;</span> rng<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>endTdCol<span class=\"k\">).</span>select<span class=\"k\">();</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>target <span class=\"k\">!==</span> endTdCol<span class=\"k\">)</span> <span class=\"k\">{</span>","                                cellsRange <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>target<span class=\"k\">,</span> endTdCol<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>cellsRange<span class=\"k\">);</span>","                            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                rng <span class=\"k\">&amp;&amp;</span> rng<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>endTdCol<span class=\"k\">).</span>select<span class=\"k\">();</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                        <span class=\"k\">return</span><span class=\"k\">;</span>","                    <span class=\"k\">}</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>inTableSide<span class=\"k\">(</span>table<span class=\"k\">,</span> target<span class=\"k\">,</span> evt<span class=\"k\">))</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> endTdRow <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCell<span class=\"k\">(</span>ut<span class=\"k\">.</span>indexTable<span class=\"k\">[</span>cellInfo<span class=\"k\">.</span>rowIndex<span class=\"k\">][</span>ut<span class=\"k\">.</span>colsNum <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">].</span>rowIndex<span class=\"k\">,</span> ut<span class=\"k\">.</span>indexTable<span class=\"k\">[</span>cellInfo<span class=\"k\">.</span>rowIndex<span class=\"k\">][</span>ut<span class=\"k\">.</span>colsNum <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">].</span>cellIndex<span class=\"k\">);</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>shiftKey <span class=\"k\">&amp;&amp;</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">.</span>length<span class=\"k\">)</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">]</span> <span class=\"k\">!==</span> endTdRow<span class=\"k\">)</span> <span class=\"k\">{</span>","                                cellsRange <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> endTdRow<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>cellsRange<span class=\"k\">);</span>","                            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                rng <span class=\"k\">&amp;&amp;</span> rng<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>endTdRow<span class=\"k\">).</span>select<span class=\"k\">();</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>target <span class=\"k\">!==</span> endTdRow<span class=\"k\">)</span> <span class=\"k\">{</span>","                                cellsRange <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>target<span class=\"k\">,</span> endTdRow<span class=\"k\">);</span>","                                ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>cellsRange<span class=\"k\">);</span>","                            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                rng <span class=\"k\">&amp;&amp;</span> rng<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>endTdRow<span class=\"k\">).</span>select<span class=\"k\">();</span>","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span><span class=\"k\">;</span>","                table<span class=\"k\">.</span>ondblclick <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","                    evt <span class=\"k\">=</span> me<span class=\"k\">.</span>window<span class=\"k\">.</span>event <span class=\"k\">||</span> evt<span class=\"k\">;</span>","                    <span class=\"k\">var</span> target <span class=\"k\">=</span> getParentTdOrTh<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>target<span class=\"k\">)</span> <span class=\"k\">{</span>","                        <span class=\"k\">var</span> h<span class=\"k\">;</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>h <span class=\"k\">=</span> getRelation<span class=\"k\">(</span>target<span class=\"k\">,</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">)))</span> <span class=\"k\">{</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>h <span class=\"k\">==</span> <span class=\"s\">'h1'</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                                h <span class=\"k\">=</span> <span class=\"s\">'h'</span><span class=\"k\">;</span>","                                <span class=\"k\">if</span> <span class=\"k\">(</span>inTableSide<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>target<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">),</span> target<span class=\"k\">,</span> evt<span class=\"k\">))</span> <span class=\"k\">{</span>","                                    me<span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'adaptbywindow'</span><span class=\"k\">);</span>","                                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                                    target <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>target<span class=\"k\">).</span>getPreviewCell<span class=\"k\">(</span>target<span class=\"k\">);</span>","                                    <span class=\"k\">if</span> <span class=\"k\">(</span>target<span class=\"k\">)</span> <span class=\"k\">{</span>","                                        <span class=\"k\">var</span> rng <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","                                        rng<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>target<span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span>","                                    <span class=\"k\">}</span>","                                <span class=\"k\">}</span>","                            <span class=\"k\">}</span>","                            <span class=\"k\">if</span> <span class=\"k\">(</span>h <span class=\"k\">==</span> <span class=\"s\">'h'</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                                <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>target<span class=\"k\">),</span>","                                    cells <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameEndPosCells<span class=\"k\">(</span>target<span class=\"k\">,</span> <span class=\"s\">\"x\"</span><span class=\"k\">),</span>","                                    table <span class=\"k\">=</span> ut<span class=\"k\">.</span>table<span class=\"k\">;</span>","                                table<span class=\"k\">.</span>removeAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">);</span>","                                utils<span class=\"k\">.</span>each<span class=\"k\">(</span>cells<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                                    cell<span class=\"k\">.</span>removeAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">);</span>","                                <span class=\"k\">}</span><span class=\"k\">);</span>","                                setTimeout<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                                    <span class=\"k\">var</span> width <span class=\"k\">=</span> cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>offsetWidth <span class=\"k\">-</span> <span class=\"s\">20</span><span class=\"k\">;</span>","                                    utils<span class=\"k\">.</span>each<span class=\"k\">(</span>cells<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                                        cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> width<span class=\"k\">);</span>","                                    <span class=\"k\">}</span><span class=\"k\">)</span>","                                    table<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> table<span class=\"k\">.</span>offsetWidth<span class=\"k\">);</span>","                                <span class=\"k\">}</span><span class=\"k\">)</span>","","                            <span class=\"k\">}</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span><span class=\"k\">);</span>","","            switchBorderColor<span class=\"k\">(</span>me<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","        <span class=\"c\">//&#20165;IE8&#20197;&#19978;&#25903;&#25345;</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>browser<span class=\"k\">.</span>ie <span class=\"k\">||</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> browser<span class=\"k\">.</span>version <span class=\"k\">&gt;</span> <span class=\"s\">7</span><span class=\"k\">))</span> <span class=\"k\">{</span>","            domUtils<span class=\"k\">.</span>on<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> <span class=\"s\">\"mousemove\"</span><span class=\"k\">,</span> mouseMoveEvent<span class=\"k\">);</span>","        <span class=\"k\">}</span>","        domUtils<span class=\"k\">.</span>on<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> <span class=\"s\">\"mouseout\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> target <span class=\"k\">=</span> evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>target<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TABLE\"</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                toggleDraggableState<span class=\"k\">(</span>me<span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"k\">null</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"interlacetable\"</span><span class=\"k\">,</span><span class=\"k\">function</span><span class=\"k\">(</span>type<span class=\"k\">,</span>table<span class=\"k\">,</span>classList<span class=\"k\">)</span><span class=\"k\">{</span>","            <span class=\"k\">if</span><span class=\"k\">(!</span>table<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">,</span>","                rows <span class=\"k\">=</span> table<span class=\"k\">.</span>rows<span class=\"k\">,</span>","                len <span class=\"k\">=</span> rows<span class=\"k\">.</span>length<span class=\"k\">,</span>","                getClass <span class=\"k\">=</span> <span class=\"k\">function</span><span class=\"k\">(</span>list<span class=\"k\">,</span>index<span class=\"k\">,</span>repeat<span class=\"k\">)</span><span class=\"k\">{</span>","                    <span class=\"k\">return</span> list<span class=\"k\">[</span>index<span class=\"k\">]</span> <span class=\"k\">?</span> list<span class=\"k\">[</span>index<span class=\"k\">]</span> <span class=\"k\">:</span> repeat <span class=\"k\">?</span> list<span class=\"k\">[</span>index <span class=\"k\">%</span> list<span class=\"k\">.</span>length<span class=\"k\">]:</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","                <span class=\"k\">}</span><span class=\"k\">;</span>","            <span class=\"k\">for</span><span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span>i<span class=\"k\">&lt;</span>len<span class=\"k\">;</span>i<span class=\"k\">++)</span><span class=\"k\">{</span>","                rows<span class=\"k\">[</span>i<span class=\"k\">].</span>className <span class=\"k\">=</span> getClass<span class=\"k\">(</span> classList<span class=\"k\">||</span> me<span class=\"k\">.</span>options<span class=\"k\">.</span>classList<span class=\"k\">,</span>i<span class=\"k\">,</span><span class=\"k\">true</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"uninterlacetable\"</span><span class=\"k\">,</span><span class=\"k\">function</span><span class=\"k\">(</span>type<span class=\"k\">,</span>table<span class=\"k\">)</span><span class=\"k\">{</span>","            <span class=\"k\">if</span><span class=\"k\">(!</span>table<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">,</span>","                rows <span class=\"k\">=</span> table<span class=\"k\">.</span>rows<span class=\"k\">,</span>","                len <span class=\"k\">=</span> rows<span class=\"k\">.</span>length<span class=\"k\">;</span>","            <span class=\"k\">for</span><span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span>i<span class=\"k\">&lt;</span>len<span class=\"k\">;</span>i<span class=\"k\">++)</span><span class=\"k\">{</span>","                rows<span class=\"k\">[</span>i<span class=\"k\">].</span>className <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","","","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"mousedown\"</span><span class=\"k\">,</span> mouseDownEvent<span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"mouseup\"</span><span class=\"k\">,</span> mouseUpEvent<span class=\"k\">);</span>","","        <span class=\"k\">var</span> currentRowIndex <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"mousedown\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            currentRowIndex <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'tabkeydown'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> range <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">(),</span>","                common <span class=\"k\">=</span> range<span class=\"k\">.</span>getCommonAncestor<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">),</span>","                table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>common<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>common<span class=\"k\">,</span> <span class=\"s\">'caption'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> cell <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>table<span class=\"k\">,</span> <span class=\"s\">'th td'</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>cell <span class=\"k\">&amp;&amp;</span> cell<span class=\"k\">.</span>length<span class=\"k\">)</span> <span class=\"k\">{</span>","                        range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>cell<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> cell <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>common<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">),</span>","                        ua <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>cell<span class=\"k\">);</span>","                    currentRowIndex <span class=\"k\">=</span> cell<span class=\"k\">.</span>rowSpan <span class=\"k\">&gt;</span> <span class=\"s\">1</span> <span class=\"k\">?</span> currentRowIndex <span class=\"k\">:</span> ua<span class=\"k\">.</span>getCellInfo<span class=\"k\">(</span>cell<span class=\"k\">).</span>rowIndex<span class=\"k\">;</span>","                    <span class=\"k\">var</span> nextCell <span class=\"k\">=</span> ua<span class=\"k\">.</span>getTabNextCell<span class=\"k\">(</span>cell<span class=\"k\">,</span> currentRowIndex<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>nextCell<span class=\"k\">)</span> <span class=\"k\">{</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>isEmptyBlock<span class=\"k\">(</span>nextCell<span class=\"k\">))</span> <span class=\"k\">{</span>","                            range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>nextCell<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span>","                        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                            range<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>nextCell<span class=\"k\">).</span>select<span class=\"k\">()</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                        me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                        me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","                        <span class=\"k\">this</span><span class=\"k\">.</span>execCommand<span class=\"k\">(</span><span class=\"s\">'insertrownext'</span><span class=\"k\">);</span>","                        me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","                        range <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">();</span>","                        range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>table<span class=\"k\">.</span>rows<span class=\"k\">[</span>table<span class=\"k\">.</span>rows<span class=\"k\">.</span>length <span class=\"k\">-</span> <span class=\"s\">1</span><span class=\"k\">].</span>cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">();</span>","                        me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'saveScene'</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","                <span class=\"k\">return</span> <span class=\"k\">true</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","","        <span class=\"k\">}</span><span class=\"k\">);</span>","        browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'selectionchange'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            toggleDraggableState<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> <span class=\"k\">null</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"keydown\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","            <span class=\"c\">//&#22788;&#29702;&#22312;&#34920;&#26684;&#30340;&#26368;&#21518;&#19968;&#20010;&#36755;&#20837;tab&#20135;&#29983;&#26032;&#30340;&#34920;&#26684;</span>","            <span class=\"k\">var</span> keyCode <span class=\"k\">=</span> evt<span class=\"k\">.</span>keyCode <span class=\"k\">||</span> evt<span class=\"k\">.</span>which<span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>keyCode <span class=\"k\">==</span> <span class=\"s\">8</span> <span class=\"k\">||</span> keyCode <span class=\"k\">==</span> <span class=\"s\">46</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","            <span class=\"k\">var</span> notCtrlKey <span class=\"k\">=</span> <span class=\"k\">!</span>evt<span class=\"k\">.</span>ctrlKey <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>evt<span class=\"k\">.</span>metaKey <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>evt<span class=\"k\">.</span>shiftKey <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>evt<span class=\"k\">.</span>altKey<span class=\"k\">;</span>","            notCtrlKey <span class=\"k\">&amp;&amp;</span> removeSelectedClass<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">));</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(!</span>ut<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","            notCtrlKey <span class=\"k\">&amp;&amp;</span> ut<span class=\"k\">.</span>clearSelected<span class=\"k\">();</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"beforegetcontent\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            switchBorderColor<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">,</span> <span class=\"k\">false</span><span class=\"k\">);</span>","            browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> utils<span class=\"k\">.</span>each<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">.</span>document<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">'caption'</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>ci<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>isEmptyNode<span class=\"k\">(</span>ci<span class=\"k\">))</span> <span class=\"k\">{</span>","                    ci<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> <span class=\"s\">'&amp;nbsp;'</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"aftergetcontent\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            switchBorderColor<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"getAllHtml\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","            removeSelectedClass<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">\"td\"</span><span class=\"k\">));</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        <span class=\"c\">//&#20462;&#27491;&#20840;&#23631;&#29366;&#24577;&#19979;&#25554;&#20837;&#30340;&#34920;&#26684;&#23485;&#24230;&#22312;&#38750;&#20840;&#23631;&#29366;&#24577;&#19979;&#25745;&#24320;&#32534;&#36753;&#22120;&#30340;&#24773;&#20917;</span>","        me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">\"fullscreenchanged\"</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>type<span class=\"k\">,</span> fullscreen<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">if</span> <span class=\"k\">(!</span>fullscreen<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">var</span> ratio <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth <span class=\"k\">/</span> document<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth<span class=\"k\">,</span>","                    tables <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"k\">this</span><span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">);</span>","                utils<span class=\"k\">.</span>each<span class=\"k\">(</span>tables<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>table<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">.</span>offsetWidth <span class=\"k\">&lt;</span> me<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth<span class=\"k\">)</span> <span class=\"k\">return</span> <span class=\"k\">false</span><span class=\"k\">;</span>","                    <span class=\"k\">var</span> tds <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>table<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">),</span>","                        backWidths <span class=\"k\">=</span> <span class=\"k\">[];</span>","                    utils<span class=\"k\">.</span>each<span class=\"k\">(</span>tds<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>td<span class=\"k\">)</span> <span class=\"k\">{</span>","                        backWidths<span class=\"k\">.</span>push<span class=\"k\">(</span>td<span class=\"k\">.</span>offsetWidth<span class=\"k\">);</span>","                    <span class=\"k\">}</span><span class=\"k\">);</span>","                    <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> td<span class=\"k\">;</span> td <span class=\"k\">=</span> tds<span class=\"k\">[</span>i<span class=\"k\">];</span> i<span class=\"k\">++)</span> <span class=\"k\">{</span>","                        td<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> Math<span class=\"k\">.</span>floor<span class=\"k\">(</span>backWidths<span class=\"k\">[</span>i<span class=\"k\">]</span> <span class=\"k\">*</span> ratio<span class=\"k\">));</span>","                    <span class=\"k\">}</span>","                    table<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> Math<span class=\"k\">.</span>floor<span class=\"k\">(</span>getTableWidth<span class=\"k\">(</span>me<span class=\"k\">,</span> needIEHack<span class=\"k\">,</span> getDefaultValue<span class=\"k\">(</span>me<span class=\"k\">))))</span>","                <span class=\"k\">}</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","","        <span class=\"c\">//&#37325;&#20889;execCommand&#21629;&#20196;&#65292;&#29992;&#20110;&#22788;&#29702;&#26694;&#36873;&#26102;&#30340;&#22788;&#29702;</span>","        <span class=\"k\">var</span> oldExecCommand <span class=\"k\">=</span> me<span class=\"k\">.</span>execCommand<span class=\"k\">;</span>","        me<span class=\"k\">.</span>execCommand <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cmd<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","            cmd <span class=\"k\">=</span> cmd<span class=\"k\">.</span>toLowerCase<span class=\"k\">();</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">),</span> tds<span class=\"k\">,</span>","                range <span class=\"k\">=</span> <span class=\"k\">new</span> dom<span class=\"k\">.</span>Range<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">),</span>","                cmdFun <span class=\"k\">=</span> me<span class=\"k\">.</span>commands<span class=\"k\">[</span>cmd<span class=\"k\">]</span> <span class=\"k\">||</span> UE<span class=\"k\">.</span>commands<span class=\"k\">[</span>cmd<span class=\"k\">],</span>","                result<span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(!</span>cmdFun<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>ut <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>commands<span class=\"k\">[</span>cmd<span class=\"k\">]</span> <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>cmdFun<span class=\"k\">.</span>notNeedUndo <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>me<span class=\"k\">.</span>__hasEnterExecCommand<span class=\"k\">)</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"beforeexeccommand\"</span><span class=\"k\">,</span> cmd<span class=\"k\">);</span>","                tds <span class=\"k\">=</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">;</span>","                <span class=\"k\">var</span> lastState <span class=\"k\">=</span> <span class=\"k\">-</span><span class=\"s\">2</span><span class=\"k\">,</span> lastValue <span class=\"k\">=</span> <span class=\"k\">-</span><span class=\"s\">2</span><span class=\"k\">,</span> value<span class=\"k\">,</span> state<span class=\"k\">;</span>","                <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> td<span class=\"k\">;</span> td <span class=\"k\">=</span> tds<span class=\"k\">[</span>i<span class=\"k\">];</span> i<span class=\"k\">++)</span> <span class=\"k\">{</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>isEmptyBlock<span class=\"k\">(</span>td<span class=\"k\">))</span> <span class=\"k\">{</span>","                        range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>td<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span>","                    <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                        range<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>td<span class=\"k\">).</span>select<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                    state <span class=\"k\">=</span> me<span class=\"k\">.</span>queryCommandState<span class=\"k\">(</span>cmd<span class=\"k\">);</span>","                    value <span class=\"k\">=</span> me<span class=\"k\">.</span>queryCommandValue<span class=\"k\">(</span>cmd<span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>state <span class=\"k\">!=</span> <span class=\"k\">-</span><span class=\"s\">1</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>lastState <span class=\"k\">!==</span> state <span class=\"k\">||</span> lastValue <span class=\"k\">!==</span> value<span class=\"k\">)</span> <span class=\"k\">{</span>","                            me<span class=\"k\">.</span>_ignoreContentChange <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","                            result <span class=\"k\">=</span> oldExecCommand<span class=\"k\">.</span>apply<span class=\"k\">(</span>me<span class=\"k\">,</span> arguments<span class=\"k\">);</span>","                            me<span class=\"k\">.</span>_ignoreContentChange <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","","                        <span class=\"k\">}</span>","                        lastState <span class=\"k\">=</span> me<span class=\"k\">.</span>queryCommandState<span class=\"k\">(</span>cmd<span class=\"k\">);</span>","                        lastValue <span class=\"k\">=</span> me<span class=\"k\">.</span>queryCommandValue<span class=\"k\">(</span>cmd<span class=\"k\">);</span>","                        <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>isEmptyBlock<span class=\"k\">(</span>td<span class=\"k\">))</span> <span class=\"k\">{</span>","                            domUtils<span class=\"k\">.</span>fillNode<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">,</span> td<span class=\"k\">)</span>","                        <span class=\"k\">}</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","                range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>tds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span> <span class=\"s\">0</span><span class=\"k\">).</span>shrinkBoundary<span class=\"k\">(</span><span class=\"k\">true</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'contentchange'</span><span class=\"k\">);</span>","                me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"afterexeccommand\"</span><span class=\"k\">,</span> cmd<span class=\"k\">);</span>","                me<span class=\"k\">.</span>__hasEnterExecCommand <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","                me<span class=\"k\">.</span>_selectionChange<span class=\"k\">();</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                result <span class=\"k\">=</span> oldExecCommand<span class=\"k\">.</span>apply<span class=\"k\">(</span>me<span class=\"k\">,</span> arguments<span class=\"k\">);</span>","            <span class=\"k\">}</span>","            <span class=\"k\">return</span> result<span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">;</span>","","","    <span class=\"k\">}</span><span class=\"k\">);</span>","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#21024;&#38500;obj&#30340;&#23485;&#39640;style&#65292;&#25913;&#25104;&#23646;&#24615;&#23485;&#39640;</span>","<span class=\"c\">     * @param obj</span>","<span class=\"c\">     * @param replaceToProperty</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> removeStyleSize<span class=\"k\">(</span>obj<span class=\"k\">,</span> replaceToProperty<span class=\"k\">)</span> <span class=\"k\">{</span>","        removeStyle<span class=\"k\">(</span>obj<span class=\"k\">,</span> <span class=\"s\">\"width\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        removeStyle<span class=\"k\">(</span>obj<span class=\"k\">,</span> <span class=\"s\">\"height\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> removeStyle<span class=\"k\">(</span>obj<span class=\"k\">,</span> styleName<span class=\"k\">,</span> replaceToProperty<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>obj<span class=\"k\">.</span>style<span class=\"k\">[</span>styleName<span class=\"k\">])</span> <span class=\"k\">{</span>","            replaceToProperty <span class=\"k\">&amp;&amp;</span> obj<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span>styleName<span class=\"k\">,</span> parseInt<span class=\"k\">(</span>obj<span class=\"k\">.</span>style<span class=\"k\">[</span>styleName<span class=\"k\">],</span> <span class=\"s\">10</span><span class=\"k\">));</span>","            obj<span class=\"k\">.</span>style<span class=\"k\">[</span>styleName<span class=\"k\">]</span> <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> getParentTdOrTh<span class=\"k\">(</span>ele<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>ele<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TD\"</span> <span class=\"k\">||</span> ele<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TH\"</span><span class=\"k\">)</span> <span class=\"k\">return</span> ele<span class=\"k\">;</span>","        <span class=\"k\">var</span> td<span class=\"k\">;</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>td <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>ele<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">||</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>ele<span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">return</span> td<span class=\"k\">;</span>","        <span class=\"k\">return</span> <span class=\"k\">null</span><span class=\"k\">;</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> isEmptyBlock<span class=\"k\">(</span>node<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> reg <span class=\"k\">=</span> <span class=\"k\">new</span> RegExp<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>fillChar<span class=\"k\">,</span> <span class=\"s\">'g'</span><span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>node<span class=\"k\">[</span>browser<span class=\"k\">.</span>ie <span class=\"k\">?</span> <span class=\"s\">'innerText'</span> <span class=\"k\">:</span> <span class=\"s\">'textContent'</span><span class=\"k\">].</span>replace<span class=\"k\">(</span><span class=\"s\">/^\\s*$/</span><span class=\"k\">,</span> <span class=\"s\">''</span><span class=\"k\">).</span>replace<span class=\"k\">(</span>reg<span class=\"k\">,</span> <span class=\"s\">''</span><span class=\"k\">).</span>length <span class=\"k\">&gt;</span> <span class=\"s\">0</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"s\">0</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> n <span class=\"k\">in</span> dtd<span class=\"k\">.</span>$isNotEmpty<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>node<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>n<span class=\"k\">).</span>length<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">return</span> <span class=\"s\">0</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span>","        <span class=\"k\">return</span> <span class=\"s\">1</span><span class=\"k\">;</span>","    <span class=\"k\">}</span>","","","    <span class=\"k\">function</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>pageX <span class=\"k\">||</span> evt<span class=\"k\">.</span>pageY<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"k\">{</span> x<span class=\"k\">:</span>evt<span class=\"k\">.</span>pageX<span class=\"k\">,</span> y<span class=\"k\">:</span>evt<span class=\"k\">.</span>pageY <span class=\"k\">}</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"k\">return</span> <span class=\"k\">{</span>","            x<span class=\"k\">:</span>evt<span class=\"k\">.</span>clientX <span class=\"k\">+</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>scrollLeft <span class=\"k\">-</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>clientLeft<span class=\"k\">,</span>","            y<span class=\"k\">:</span>evt<span class=\"k\">.</span>clientY <span class=\"k\">+</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>scrollTop <span class=\"k\">-</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>clientTop","        <span class=\"k\">}</span><span class=\"k\">;</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> mouseMoveEvent<span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">try</span> <span class=\"k\">{</span>","            <span class=\"c\">//&#26222;&#36890;&#29366;&#24577;&#19979;&#40736;&#26631;&#31227;&#21160;</span>","            <span class=\"k\">var</span> target <span class=\"k\">=</span> getParentTdOrTh<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">),</span>","                pos<span class=\"k\">;</span>","            <span class=\"c\">//&#20462;&#25913;&#21333;&#20803;&#26684;&#22823;&#23567;&#26102;&#30340;&#40736;&#26631;&#31227;&#21160;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>onDrag <span class=\"k\">&amp;&amp;</span> dragTd<span class=\"k\">)</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>webkitUserSelect <span class=\"k\">=</span> <span class=\"s\">'none'</span><span class=\"k\">;</span>","                me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getNative<span class=\"k\">()[</span>browser<span class=\"k\">.</span>ie <span class=\"k\">?</span> <span class=\"s\">'empty'</span> <span class=\"k\">:</span> <span class=\"s\">'removeAllRanges'</span><span class=\"k\">]();</span>","                pos <span class=\"k\">=</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">);</span>","                toggleDraggableState<span class=\"k\">(</span>me<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">,</span> pos<span class=\"k\">,</span> target<span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>onDrag <span class=\"k\">==</span> <span class=\"s\">\"h\"</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                    dragLine<span class=\"k\">.</span>style<span class=\"k\">.</span>left <span class=\"k\">=</span> getPermissionX<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">\"px\"</span><span class=\"k\">;</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"k\">(</span>onDrag <span class=\"k\">==</span> <span class=\"s\">\"v\"</span><span class=\"k\">)</span> <span class=\"k\">{</span>","                    dragLine<span class=\"k\">.</span>style<span class=\"k\">.</span>top <span class=\"k\">=</span> getPermissionY<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">\"px\"</span><span class=\"k\">;</span>","                <span class=\"k\">}</span>","                <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">}</span>","            <span class=\"c\">//&#24403;&#40736;&#26631;&#22788;&#20110;table&#19978;&#26102;&#65292;&#20462;&#25913;&#31227;&#21160;&#36807;&#31243;&#20013;&#30340;&#20809;&#26631;&#29366;&#24577;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>target<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"c\">//&#38024;&#23545;&#20351;&#29992;table&#20316;&#20026;&#23481;&#22120;&#30340;&#32452;&#20214;&#19981;&#35302;&#21457;&#25302;&#25341;&#25928;&#26524;</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">'excludetable'</span><span class=\"k\">,</span> target<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span>","                    <span class=\"k\">return</span><span class=\"k\">;</span>","                pos <span class=\"k\">=</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">);</span>","                <span class=\"k\">var</span> state <span class=\"k\">=</span> getRelation<span class=\"k\">(</span>target<span class=\"k\">,</span> pos<span class=\"k\">),</span>","                    table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>target<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","","                <span class=\"k\">if</span> <span class=\"k\">(</span>inTableSide<span class=\"k\">(</span>table<span class=\"k\">,</span> target<span class=\"k\">,</span> evt<span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                    <span class=\"c\">//toggleCursor(pos,true,\"_h\");</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"excludetable\"</span><span class=\"k\">,</span> table<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","                    me<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>cursor <span class=\"k\">=</span> <span class=\"s\">\"url(\"</span> <span class=\"k\">+</span> me<span class=\"k\">.</span>options<span class=\"k\">.</span>cursorpath <span class=\"k\">+</span> <span class=\"s\">\"h.png),pointer\"</span><span class=\"k\">;</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">if</span> <span class=\"k\">(</span>inTableSide<span class=\"k\">(</span>table<span class=\"k\">,</span> target<span class=\"k\">,</span> evt<span class=\"k\">))</span> <span class=\"k\">{</span>","                    <span class=\"c\">//toggleCursor(pos,true,\"_v\");</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"excludetable\"</span><span class=\"k\">,</span> table<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","                    me<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>cursor <span class=\"k\">=</span> <span class=\"s\">\"url(\"</span> <span class=\"k\">+</span> me<span class=\"k\">.</span>options<span class=\"k\">.</span>cursorpath <span class=\"k\">+</span> <span class=\"s\">\"v.png),pointer\"</span><span class=\"k\">;</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    <span class=\"c\">//toggleCursor(pos,false,\"\");</span>","                    me<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>cursor <span class=\"k\">=</span> <span class=\"s\">\"text\"</span><span class=\"k\">;</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span><span class=\"s\">/\\d/</span><span class=\"k\">.</span>test<span class=\"k\">(</span>state<span class=\"k\">))</span> <span class=\"k\">{</span>","                        state <span class=\"k\">=</span> state<span class=\"k\">.</span>replace<span class=\"k\">(</span><span class=\"s\">/\\d/</span><span class=\"k\">,</span> <span class=\"s\">''</span><span class=\"k\">);</span>","                        target <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>target<span class=\"k\">).</span>getPreviewCell<span class=\"k\">(</span>target<span class=\"k\">,</span> state <span class=\"k\">==</span> <span class=\"s\">\"v\"</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                    <span class=\"c\">//&#20301;&#20110;&#31532;&#19968;&#34892;&#30340;&#39030;&#37096;&#25110;&#32773;&#31532;&#19968;&#21015;&#30340;&#24038;&#36793;&#26102;&#19981;&#21487;&#25302;&#21160;</span>","                    toggleDraggableState<span class=\"k\">(</span>me<span class=\"k\">,</span> target <span class=\"k\">?</span> <span class=\"k\">!!</span>state <span class=\"k\">:</span> <span class=\"k\">false</span><span class=\"k\">,</span> target <span class=\"k\">?</span> state <span class=\"k\">:</span> <span class=\"s\">''</span><span class=\"k\">,</span> pos<span class=\"k\">,</span> target<span class=\"k\">);</span>","                <span class=\"k\">}</span>","<span class=\"c\">//                toggleDragButton(inTable(pos,table),table);</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                toggleDragButton<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> table<span class=\"k\">,</span> me<span class=\"k\">);</span>","            <span class=\"k\">}</span>","","        <span class=\"k\">}</span> <span class=\"k\">catch</span> <span class=\"k\">(</span>e<span class=\"k\">)</span> <span class=\"k\">{</span>","            showError<span class=\"k\">(</span>e<span class=\"k\">);</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">var</span> dragButtonTimer<span class=\"k\">;</span>","","    <span class=\"k\">function</span> toggleDragButton<span class=\"k\">(</span>show<span class=\"k\">,</span> table<span class=\"k\">,</span> editor<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>show<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>dragOver<span class=\"k\">)</span><span class=\"k\">return</span><span class=\"k\">;</span>","            dragButtonTimer <span class=\"k\">=</span> setTimeout<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                <span class=\"k\">!</span>dragOver <span class=\"k\">&amp;&amp;</span> dragButton <span class=\"k\">&amp;&amp;</span> dragButton<span class=\"k\">.</span>parentNode <span class=\"k\">&amp;&amp;</span> dragButton<span class=\"k\">.</span>parentNode<span class=\"k\">.</span>removeChild<span class=\"k\">(</span>dragButton<span class=\"k\">);</span>","            <span class=\"k\">}</span><span class=\"k\">,</span> <span class=\"s\">2000</span><span class=\"k\">);</span>","        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","            createDragButton<span class=\"k\">(</span>table<span class=\"k\">,</span> editor<span class=\"k\">);</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> createDragButton<span class=\"k\">(</span>table<span class=\"k\">,</span> editor<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> pos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>table<span class=\"k\">),</span>","            doc <span class=\"k\">=</span> table<span class=\"k\">.</span>ownerDocument<span class=\"k\">;</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>dragButton <span class=\"k\">&amp;&amp;</span> dragButton<span class=\"k\">.</span>parentNode<span class=\"k\">)</span><span class=\"k\">return</span> dragButton<span class=\"k\">;</span>","        dragButton <span class=\"k\">=</span> doc<span class=\"k\">.</span>createElement<span class=\"k\">(</span><span class=\"s\">\"div\"</span><span class=\"k\">);</span>","        dragButton<span class=\"k\">.</span>contentEditable <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","        dragButton<span class=\"k\">.</span>innerHTML <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","        dragButton<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> <span class=\"s\">\"width:15px;height:15px;background-image:url(\"</span> <span class=\"k\">+</span> editor<span class=\"k\">.</span>options<span class=\"k\">.</span>UEDITOR_HOME_URL <span class=\"k\">+</span> <span class=\"s\">\"dialogs/table/dragicon.png);position: absolute;cursor:move;top:\"</span> <span class=\"k\">+</span> <span class=\"k\">(</span>pos<span class=\"k\">.</span>y <span class=\"k\">-</span> <span class=\"s\">15</span><span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">\"px;left:\"</span> <span class=\"k\">+</span> <span class=\"k\">(</span>pos<span class=\"k\">.</span>x<span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">\"px;\"</span><span class=\"k\">;</span>","        domUtils<span class=\"k\">.</span>unSelectable<span class=\"k\">(</span>dragButton<span class=\"k\">);</span>","        dragButton<span class=\"k\">.</span>onmouseover <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            dragOver <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">;</span>","        dragButton<span class=\"k\">.</span>onmouseout <span class=\"k\">=</span> <span class=\"k\">function</span> <span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            dragOver <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">;</span>","        domUtils<span class=\"k\">.</span>on<span class=\"k\">(</span>dragButton<span class=\"k\">,</span> <span class=\"s\">'click'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            doClick<span class=\"k\">(</span>evt<span class=\"k\">,</span> <span class=\"k\">this</span><span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        domUtils<span class=\"k\">.</span>on<span class=\"k\">(</span>dragButton<span class=\"k\">,</span> <span class=\"s\">'dblclick'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            doDblClick<span class=\"k\">(</span>evt<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        domUtils<span class=\"k\">.</span>on<span class=\"k\">(</span>dragButton<span class=\"k\">,</span> <span class=\"s\">'dragstart'</span><span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            domUtils<span class=\"k\">.</span>preventDefault<span class=\"k\">(</span>evt<span class=\"k\">);</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        <span class=\"k\">var</span> timer<span class=\"k\">;</span>","","        <span class=\"k\">function</span> doClick<span class=\"k\">(</span>evt<span class=\"k\">,</span> button<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"c\">// &#37096;&#20998;&#27983;&#35272;&#22120;&#19979;&#38656;&#35201;&#28165;&#29702;</span>","            clearTimeout<span class=\"k\">(</span>timer<span class=\"k\">);</span>","            timer <span class=\"k\">=</span> setTimeout<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                editor<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"tableClicked\"</span><span class=\"k\">,</span> table<span class=\"k\">,</span> button<span class=\"k\">);</span>","            <span class=\"k\">}</span><span class=\"k\">,</span> <span class=\"s\">300</span><span class=\"k\">);</span>","        <span class=\"k\">}</span>","","        <span class=\"k\">function</span> doDblClick<span class=\"k\">(</span>evt<span class=\"k\">)</span> <span class=\"k\">{</span>","            clearTimeout<span class=\"k\">(</span>timer<span class=\"k\">);</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>table<span class=\"k\">),</span>","                start <span class=\"k\">=</span> table<span class=\"k\">.</span>rows<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">],</span>","                end <span class=\"k\">=</span> ut<span class=\"k\">.</span>getLastCell<span class=\"k\">(),</span>","                range <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>start<span class=\"k\">,</span> end<span class=\"k\">);</span>","            editor<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">().</span>setStart<span class=\"k\">(</span>start<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","            ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>range<span class=\"k\">);</span>","        <span class=\"k\">}</span>","","        doc<span class=\"k\">.</span>body<span class=\"k\">.</span>appendChild<span class=\"k\">(</span>dragButton<span class=\"k\">);</span>","    <span class=\"k\">}</span>","","","<span class=\"c\">//    function inPosition(table, pos) {</span>","<span class=\"c\">//        var tablePos = domUtils.getXY(table),</span>","<span class=\"c\">//            width = table.offsetWidth,</span>","<span class=\"c\">//            height = table.offsetHeight;</span>","<span class=\"c\">//        if (pos.x - tablePos.x &lt; 5 &amp;&amp; pos.y - tablePos.y &lt; 5) {</span>","<span class=\"c\">//            return \"topLeft\";</span>","<span class=\"c\">//        } else if (tablePos.x + width - pos.x &lt; 5 &amp;&amp; tablePos.y + height - pos.y &lt; 5) {</span>","<span class=\"c\">//            return \"bottomRight\";</span>","<span class=\"c\">//        }</span>","<span class=\"c\">//    }</span>","","    <span class=\"k\">function</span> inTableSide<span class=\"k\">(</span>table<span class=\"k\">,</span> cell<span class=\"k\">,</span> evt<span class=\"k\">,</span> top<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> pos <span class=\"k\">=</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">),</span>","            state <span class=\"k\">=</span> getRelation<span class=\"k\">(</span>cell<span class=\"k\">,</span> pos<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>top<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> caption <span class=\"k\">=</span> table<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">\"caption\"</span><span class=\"k\">)[</span><span class=\"s\">0</span><span class=\"k\">],</span>","                capHeight <span class=\"k\">=</span> caption <span class=\"k\">?</span> caption<span class=\"k\">.</span>offsetHeight <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">;</span>","            <span class=\"k\">return</span> <span class=\"k\">(</span>state <span class=\"k\">==</span> <span class=\"s\">\"v1\"</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> <span class=\"k\">((</span>pos<span class=\"k\">.</span>y <span class=\"k\">-</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>table<span class=\"k\">).</span>y <span class=\"k\">-</span> capHeight<span class=\"k\">)</span> <span class=\"k\">&lt;</span> <span class=\"s\">8</span><span class=\"k\">);</span>","        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"k\">(</span>state <span class=\"k\">==</span> <span class=\"s\">\"h1\"</span><span class=\"k\">)</span> <span class=\"k\">&amp;&amp;</span> <span class=\"k\">((</span>pos<span class=\"k\">.</span>x <span class=\"k\">-</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>table<span class=\"k\">).</span>x<span class=\"k\">)</span> <span class=\"k\">&lt;</span> <span class=\"s\">8</span><span class=\"k\">);</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#33719;&#21462;&#25302;&#21160;&#26102;&#20801;&#35768;&#30340;X&#36724;&#22352;&#26631;</span>","<span class=\"c\">     * @param dragTd</span>","<span class=\"c\">     * @param evt</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> getPermissionX<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>dragTd<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> preTd <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameEndPosCells<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> <span class=\"s\">\"x\"</span><span class=\"k\">)[</span><span class=\"s\">0</span><span class=\"k\">],</span>","                nextTd <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameStartPosXCells<span class=\"k\">(</span>dragTd<span class=\"k\">)[</span><span class=\"s\">0</span><span class=\"k\">],</span>","                mouseX <span class=\"k\">=</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">).</span>x<span class=\"k\">,</span>","                left <span class=\"k\">=</span> <span class=\"k\">(</span>preTd <span class=\"k\">?</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>preTd<span class=\"k\">).</span>x <span class=\"k\">:</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>ut<span class=\"k\">.</span>table<span class=\"k\">).</span>x<span class=\"k\">)</span> <span class=\"k\">+</span> <span class=\"s\">20</span> <span class=\"k\">,</span>","                right <span class=\"k\">=</span> nextTd <span class=\"k\">?</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>nextTd<span class=\"k\">).</span>x <span class=\"k\">+</span> nextTd<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span> <span class=\"s\">20</span> <span class=\"k\">:</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">.</span>offsetWidth <span class=\"k\">+</span> <span class=\"s\">5</span> <span class=\"k\">||</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"width\"</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">));</span>","            <span class=\"k\">return</span> mouseX <span class=\"k\">&lt;</span> left <span class=\"k\">?</span> left <span class=\"k\">:</span> mouseX <span class=\"k\">&gt;</span> right <span class=\"k\">?</span> right <span class=\"k\">:</span> mouseX<span class=\"k\">;</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#33719;&#21462;&#25302;&#21160;&#26102;&#20801;&#35768;&#30340;Y&#36724;&#22352;&#26631;</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> getPermissionY<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">try</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> top <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>dragTd<span class=\"k\">).</span>y<span class=\"k\">,</span>","                mousePosY <span class=\"k\">=</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">).</span>y<span class=\"k\">;</span>","            <span class=\"k\">return</span> mousePosY <span class=\"k\">&lt;</span> top <span class=\"k\">?</span> top <span class=\"k\">:</span> mousePosY<span class=\"k\">;</span>","        <span class=\"k\">}</span> <span class=\"k\">catch</span> <span class=\"k\">(</span>e<span class=\"k\">)</span> <span class=\"k\">{</span>","            showError<span class=\"k\">(</span>e<span class=\"k\">);</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#31227;&#21160;&#29366;&#24577;&#20999;&#25442;</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> toggleDraggableState<span class=\"k\">(</span>editor<span class=\"k\">,</span> draggable<span class=\"k\">,</span> dir<span class=\"k\">,</span> mousePos<span class=\"k\">,</span> cell<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">try</span> <span class=\"k\">{</span>","            editor<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>cursor <span class=\"k\">=</span> dir <span class=\"k\">==</span> <span class=\"s\">\"h\"</span> <span class=\"k\">?</span> <span class=\"s\">\"col-resize\"</span> <span class=\"k\">:</span> dir <span class=\"k\">==</span> <span class=\"s\">\"v\"</span> <span class=\"k\">?</span> <span class=\"s\">\"row-resize\"</span> <span class=\"k\">:</span> <span class=\"s\">\"text\"</span><span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>dir <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>mousedown <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>getUETableBySelected<span class=\"k\">(</span>editor<span class=\"k\">))</span> <span class=\"k\">{</span>","                    getDragLine<span class=\"k\">(</span>editor<span class=\"k\">,</span> editor<span class=\"k\">.</span>document<span class=\"k\">);</span>","                    showDragLineAt<span class=\"k\">(</span>dir<span class=\"k\">,</span> cell<span class=\"k\">);</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    hideDragLine<span class=\"k\">(</span>editor<span class=\"k\">)</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span>","            onBorder <span class=\"k\">=</span> draggable<span class=\"k\">;</span>","        <span class=\"k\">}</span> <span class=\"k\">catch</span> <span class=\"k\">(</span>e<span class=\"k\">)</span> <span class=\"k\">{</span>","            showError<span class=\"k\">(</span>e<span class=\"k\">);</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#33719;&#21462;&#40736;&#26631;&#19982;&#24403;&#21069;&#21333;&#20803;&#26684;&#30340;&#30456;&#23545;&#20301;&#32622;</span>","<span class=\"c\">     * @param ele</span>","<span class=\"c\">     * @param mousePos</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> getRelation<span class=\"k\">(</span>ele<span class=\"k\">,</span> mousePos<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> elePos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>ele<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>elePos<span class=\"k\">.</span>x <span class=\"k\">+</span> ele<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span> mousePos<span class=\"k\">.</span>x <span class=\"k\">&lt;</span> <span class=\"s\">4</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"s\">\"h\"</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>mousePos<span class=\"k\">.</span>x <span class=\"k\">-</span> elePos<span class=\"k\">.</span>x <span class=\"k\">&lt;</span> <span class=\"s\">4</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"s\">'h1'</span>","        <span class=\"k\">}</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>elePos<span class=\"k\">.</span>y <span class=\"k\">+</span> ele<span class=\"k\">.</span>offsetHeight <span class=\"k\">-</span> mousePos<span class=\"k\">.</span>y <span class=\"k\">&lt;</span> <span class=\"s\">4</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"s\">\"v\"</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>mousePos<span class=\"k\">.</span>y <span class=\"k\">-</span> elePos<span class=\"k\">.</span>y <span class=\"k\">&lt;</span> <span class=\"s\">4</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span> <span class=\"s\">'v1'</span>","        <span class=\"k\">}</span>","        <span class=\"k\">return</span> <span class=\"s\">''</span><span class=\"k\">;</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> mouseDownEvent<span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"c\">//&#21491;&#38190;&#33756;&#21333;&#21333;&#29420;&#22788;&#29702;</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>button <span class=\"k\">==</span> <span class=\"s\">2</span><span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETableBySelected<span class=\"k\">(</span>me<span class=\"k\">),</span>","                flag <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">var</span> td <span class=\"k\">=</span> getTargetTd<span class=\"k\">(</span>me<span class=\"k\">,</span> evt<span class=\"k\">);</span>","                utils<span class=\"k\">.</span>each<span class=\"k\">(</span>ut<span class=\"k\">.</span>selectedTds<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>ti<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>ti <span class=\"k\">===</span> td<span class=\"k\">)</span> <span class=\"k\">{</span>","                        flag <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span><span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(!</span>flag<span class=\"k\">)</span> <span class=\"k\">{</span>","                    removeSelectedClass<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">));</span>","                    removeSelectedClass<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">));</span>","                    ut<span class=\"k\">.</span>clearSelected<span class=\"k\">()</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    td <span class=\"k\">=</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">];</span>","                    setTimeout<span class=\"k\">(</span><span class=\"k\">function</span> <span class=\"k\">()</span> <span class=\"k\">{</span>","                        me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">().</span>setStart<span class=\"k\">(</span>td<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span><span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">);</span>","","                <span class=\"k\">}</span>","","            <span class=\"k\">}</span>","            <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>shiftKey<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","","        removeSelectedClass<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">));</span>","        removeSelectedClass<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>me<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">));</span>","        <span class=\"c\">//trace:3113</span>","        <span class=\"c\">//&#36873;&#20013;&#21333;&#20803;&#26684;&#65292;&#28857;&#20987;table&#22806;&#37096;&#65292;&#19981;&#20250;&#28165;&#25481;table&#19978;&#25346;&#30340;ueTable,&#20250;&#24341;&#36215;getUETableBySelected&#26041;&#27861;&#36820;&#22238;&#20540;</span>","        utils<span class=\"k\">.</span>each<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">'table'</span><span class=\"k\">),</span> <span class=\"k\">function</span> <span class=\"k\">(</span>t<span class=\"k\">)</span> <span class=\"k\">{</span>","            t<span class=\"k\">.</span>ueTable <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        startTd <span class=\"k\">=</span> getTargetTd<span class=\"k\">(</span>me<span class=\"k\">,</span> evt<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>startTd<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>startTd<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>table<span class=\"k\">);</span>","        ut <span class=\"k\">&amp;&amp;</span> ut<span class=\"k\">.</span>clearSelected<span class=\"k\">();</span>","        <span class=\"c\">//&#21028;&#26029;&#24403;&#21069;&#40736;&#26631;&#29366;&#24577;</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>onBorder<span class=\"k\">)</span> <span class=\"k\">{</span>","            me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>webkitUserSelect <span class=\"k\">=</span> <span class=\"s\">''</span><span class=\"k\">;</span>","            mousedown <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","            me<span class=\"k\">.</span>addListener<span class=\"k\">(</span><span class=\"s\">'mouseover'</span><span class=\"k\">,</span> mouseOverEvent<span class=\"k\">);</span>","        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> browser<span class=\"k\">.</span>version <span class=\"k\">&lt;</span> <span class=\"s\">8</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","            <span class=\"k\">var</span> state <span class=\"k\">=</span> getRelation<span class=\"k\">(</span>startTd<span class=\"k\">,</span> mouseCoords<span class=\"k\">(</span>evt<span class=\"k\">));</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span><span class=\"s\">/\\d/</span><span class=\"k\">.</span>test<span class=\"k\">(</span>state<span class=\"k\">))</span> <span class=\"k\">{</span>","                state <span class=\"k\">=</span> state<span class=\"k\">.</span>replace<span class=\"k\">(</span><span class=\"s\">/\\d/</span><span class=\"k\">,</span> <span class=\"s\">''</span><span class=\"k\">);</span>","                startTd <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>startTd<span class=\"k\">).</span>getPreviewCell<span class=\"k\">(</span>startTd<span class=\"k\">,</span> state <span class=\"k\">==</span> <span class=\"s\">'v'</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","            hideDragLine<span class=\"k\">(</span>me<span class=\"k\">);</span>","            getDragLine<span class=\"k\">(</span>me<span class=\"k\">,</span> me<span class=\"k\">.</span>document<span class=\"k\">);</span>","            showDragLineAt<span class=\"k\">(</span>state<span class=\"k\">,</span> startTd<span class=\"k\">);</span>","            mousedown <span class=\"k\">=</span> <span class=\"k\">true</span><span class=\"k\">;</span>","            <span class=\"c\">//&#25302;&#21160;&#24320;&#22987;</span>","            onDrag <span class=\"k\">=</span> state<span class=\"k\">;</span>","            dragTd <span class=\"k\">=</span> startTd<span class=\"k\">;</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> mouseUpEvent<span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>button <span class=\"k\">==</span> <span class=\"s\">2</span><span class=\"k\">)</span><span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">;</span>","        <span class=\"c\">//&#28165;&#38500;&#34920;&#26684;&#19978;&#21407;&#29983;&#36328;&#36873;&#38382;&#39064;</span>","        <span class=\"k\">var</span> range <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">(),</span>","            start <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">),</span>","            end <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>endContainer<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","","        <span class=\"k\">if</span> <span class=\"k\">(</span>start <span class=\"k\">||</span> end<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>start <span class=\"k\">===</span> end<span class=\"k\">)</span> <span class=\"k\">{</span>","                start <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">,</span> <span class=\"s\">'caption'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                end <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>endContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">,</span> <span class=\"s\">'caption'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>start <span class=\"k\">!==</span> end<span class=\"k\">)</span> <span class=\"k\">{</span>","                    me<span class=\"k\">.</span>selection<span class=\"k\">.</span>clearRange<span class=\"k\">()</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>selection<span class=\"k\">.</span>clearRange<span class=\"k\">()</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span>","        mousedown <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">;</span>","        me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>webkitUserSelect <span class=\"k\">=</span> <span class=\"s\">''</span><span class=\"k\">;</span>","        <span class=\"c\">//&#25302;&#25341;&#29366;&#24577;&#19979;&#30340;mouseUP</span>","        <span class=\"k\">if</span> <span class=\"k\">((!</span>browser<span class=\"k\">.</span>ie <span class=\"k\">||</span> <span class=\"k\">(</span>browser<span class=\"k\">.</span>ie <span class=\"k\">&amp;&amp;</span> browser<span class=\"k\">.</span>version <span class=\"k\">&gt;</span> <span class=\"s\">7</span><span class=\"k\">))</span> <span class=\"k\">&amp;&amp;</span> onDrag <span class=\"k\">&amp;&amp;</span> dragTd<span class=\"k\">)</span> <span class=\"k\">{</span>","            dragLine <span class=\"k\">=</span> me<span class=\"k\">.</span>document<span class=\"k\">.</span>getElementById<span class=\"k\">(</span><span class=\"s\">'ue_tableDragLine'</span><span class=\"k\">);</span>","            <span class=\"k\">var</span> dragTdPos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>dragTd<span class=\"k\">),</span>","                dragLinePos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>dragLine<span class=\"k\">);</span>","            <span class=\"k\">switch</span> <span class=\"k\">(</span>onDrag<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">case</span> <span class=\"s\">\"h\"</span><span class=\"k\">:</span>","                    changeColWidth<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> dragLinePos<span class=\"k\">.</span>x <span class=\"k\">-</span> dragTdPos<span class=\"k\">.</span>x <span class=\"k\">-</span> dragTd<span class=\"k\">.</span>offsetWidth<span class=\"k\">);</span>","                    <span class=\"k\">break</span><span class=\"k\">;</span>","                <span class=\"k\">case</span> <span class=\"s\">\"v\"</span><span class=\"k\">:</span>","                    changeRowHeight<span class=\"k\">(</span>dragTd<span class=\"k\">,</span> dragLinePos<span class=\"k\">.</span>y <span class=\"k\">-</span> dragTdPos<span class=\"k\">.</span>y <span class=\"k\">-</span> dragTd<span class=\"k\">.</span>offsetHeight<span class=\"k\">);</span>","                    <span class=\"k\">break</span><span class=\"k\">;</span>","                <span class=\"k\">default</span><span class=\"k\">:</span>","            <span class=\"k\">}</span>","            onDrag <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","            dragTd <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>","","            hideDragLine<span class=\"k\">(</span>me<span class=\"k\">);</span>","            <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">}</span>","        <span class=\"c\">//&#27491;&#24120;&#29366;&#24577;&#19979;&#30340;mouseup</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>startTd<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> target <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(!</span>target<span class=\"k\">)</span> target <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>target <span class=\"k\">&amp;&amp;</span> <span class=\"k\">(</span>target<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TD\"</span> <span class=\"k\">||</span> target<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TH\"</span><span class=\"k\">))</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>me<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"excludetable\"</span><span class=\"k\">,</span> target<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","                range <span class=\"k\">=</span> <span class=\"k\">new</span> dom<span class=\"k\">.</span>Range<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">);</span>","                range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>target<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>startTd<span class=\"k\">),</span>","                cell <span class=\"k\">=</span> ut <span class=\"k\">?</span> ut<span class=\"k\">.</span>selectedTds<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">]</span> <span class=\"k\">:</span> <span class=\"k\">null</span><span class=\"k\">;</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                range <span class=\"k\">=</span> <span class=\"k\">new</span> dom<span class=\"k\">.</span>Range<span class=\"k\">(</span>me<span class=\"k\">.</span>document<span class=\"k\">);</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>domUtils<span class=\"k\">.</span>isEmptyBlock<span class=\"k\">(</span>cell<span class=\"k\">))</span> <span class=\"k\">{</span>","                    range<span class=\"k\">.</span>setStart<span class=\"k\">(</span>cell<span class=\"k\">,</span> <span class=\"s\">0</span><span class=\"k\">).</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    range<span class=\"k\">.</span>selectNodeContents<span class=\"k\">(</span>cell<span class=\"k\">).</span>shrinkBoundary<span class=\"k\">().</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                range <span class=\"k\">=</span> me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getRange<span class=\"k\">().</span>shrinkBoundary<span class=\"k\">();</span>","                <span class=\"k\">if</span> <span class=\"k\">(!</span>range<span class=\"k\">.</span>collapsed<span class=\"k\">)</span> <span class=\"k\">{</span>","                    <span class=\"k\">var</span> start <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>startContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">),</span>","                        end <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>range<span class=\"k\">.</span>endContainer<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">'td'</span><span class=\"k\">,</span> <span class=\"s\">'th'</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                    <span class=\"c\">//&#22312;table&#37324;&#36793;&#30340;&#19981;&#33021;&#28165;&#38500;</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span>start <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!</span>end <span class=\"k\">||</span> <span class=\"k\">!</span>start <span class=\"k\">&amp;&amp;</span> end <span class=\"k\">||</span> start <span class=\"k\">&amp;&amp;</span> end <span class=\"k\">&amp;&amp;</span> start <span class=\"k\">!==</span> end<span class=\"k\">)</span> <span class=\"k\">{</span>","                        range<span class=\"k\">.</span>setCursor<span class=\"k\">(</span><span class=\"k\">false</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","                    <span class=\"k\">}</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span>","            startTd <span class=\"k\">=</span> <span class=\"k\">null</span><span class=\"k\">;</span>","            me<span class=\"k\">.</span>removeListener<span class=\"k\">(</span><span class=\"s\">'mouseover'</span><span class=\"k\">,</span> mouseOverEvent<span class=\"k\">);</span>","        <span class=\"k\">}</span>","        me<span class=\"k\">.</span>_selectionChange<span class=\"k\">(</span><span class=\"s\">250</span><span class=\"k\">,</span> evt<span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> mouseOverEvent<span class=\"k\">(</span>type<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> me <span class=\"k\">=</span> <span class=\"k\">this</span><span class=\"k\">,</span>","            tar <span class=\"k\">=</span> evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">;</span>","        currentTd <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>tar<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">||</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>tar<span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">,</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        <span class=\"c\">//&#38656;&#35201;&#21028;&#26029;&#20004;&#20010;TD&#26159;&#21542;&#20301;&#20110;&#21516;&#19968;&#20010;&#34920;&#26684;&#20869;</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>startTd <span class=\"k\">&amp;&amp;</span> currentTd <span class=\"k\">&amp;&amp;</span>","            <span class=\"k\">((</span>startTd<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TD\"</span> <span class=\"k\">&amp;&amp;</span> currentTd<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TD\"</span><span class=\"k\">)</span> <span class=\"k\">||</span> <span class=\"k\">(</span>startTd<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TH\"</span> <span class=\"k\">&amp;&amp;</span> currentTd<span class=\"k\">.</span>tagName <span class=\"k\">==</span> <span class=\"s\">\"TH\"</span><span class=\"k\">))</span> <span class=\"k\">&amp;&amp;</span>","            domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>startTd<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">)</span> <span class=\"k\">==</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>currentTd<span class=\"k\">,</span> <span class=\"s\">'table'</span><span class=\"k\">))</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>currentTd<span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>startTd <span class=\"k\">!=</span> currentTd<span class=\"k\">)</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>webkitUserSelect <span class=\"k\">=</span> <span class=\"s\">'none'</span><span class=\"k\">;</span>","                me<span class=\"k\">.</span>selection<span class=\"k\">.</span>getNative<span class=\"k\">()[</span>browser<span class=\"k\">.</span>ie <span class=\"k\">?</span> <span class=\"s\">'empty'</span> <span class=\"k\">:</span> <span class=\"s\">'removeAllRanges'</span><span class=\"k\">]();</span>","                <span class=\"k\">var</span> range <span class=\"k\">=</span> ut<span class=\"k\">.</span>getCellsRange<span class=\"k\">(</span>startTd<span class=\"k\">,</span> currentTd<span class=\"k\">);</span>","                ut<span class=\"k\">.</span>setSelected<span class=\"k\">(</span>range<span class=\"k\">);</span>","            <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                me<span class=\"k\">.</span>document<span class=\"k\">.</span>body<span class=\"k\">.</span>style<span class=\"k\">.</span>webkitUserSelect <span class=\"k\">=</span> <span class=\"s\">''</span><span class=\"k\">;</span>","                ut<span class=\"k\">.</span>clearSelected<span class=\"k\">();</span>","            <span class=\"k\">}</span>","","        <span class=\"k\">}</span>","        evt<span class=\"k\">.</span>preventDefault <span class=\"k\">?</span> evt<span class=\"k\">.</span>preventDefault<span class=\"k\">()</span> <span class=\"k\">:</span> <span class=\"k\">(</span>evt<span class=\"k\">.</span>returnValue <span class=\"k\">=</span> <span class=\"k\">false</span><span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> setCellHeight<span class=\"k\">(</span>cell<span class=\"k\">,</span> height<span class=\"k\">,</span> backHeight<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> lineHight <span class=\"k\">=</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>cell<span class=\"k\">,</span> <span class=\"s\">\"line-height\"</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">),</span>","            tmpHeight <span class=\"k\">=</span> backHeight <span class=\"k\">+</span> height<span class=\"k\">;</span>","        height <span class=\"k\">=</span> tmpHeight <span class=\"k\">&lt;</span> lineHight <span class=\"k\">?</span> lineHight <span class=\"k\">:</span> tmpHeight<span class=\"k\">;</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>height<span class=\"k\">)</span> cell<span class=\"k\">.</span>style<span class=\"k\">.</span>height <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","        cell<span class=\"k\">.</span>rowSpan <span class=\"k\">==</span> <span class=\"s\">1</span> <span class=\"k\">?</span> cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"height\"</span><span class=\"k\">,</span> height<span class=\"k\">)</span> <span class=\"k\">:</span> <span class=\"k\">(</span>cell<span class=\"k\">.</span>removeAttribute <span class=\"k\">&amp;&amp;</span> cell<span class=\"k\">.</span>removeAttribute<span class=\"k\">(</span><span class=\"s\">\"height\"</span><span class=\"k\">));</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> getWidth<span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>cell<span class=\"k\">)</span><span class=\"k\">return</span> <span class=\"s\">0</span><span class=\"k\">;</span>","        <span class=\"k\">return</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>cell<span class=\"k\">,</span> <span class=\"s\">\"width\"</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> changeColWidth<span class=\"k\">(</span>cell<span class=\"k\">,</span> changeValue<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>Math<span class=\"k\">.</span>abs<span class=\"k\">(</span>changeValue<span class=\"k\">)</span> <span class=\"k\">&lt;</span> <span class=\"s\">10</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>cell<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> table <span class=\"k\">=</span> ut<span class=\"k\">.</span>table<span class=\"k\">,</span>","                backTableWidth <span class=\"k\">=</span> getWidth<span class=\"k\">(</span>table<span class=\"k\">),</span>","                defaultValue <span class=\"k\">=</span> getDefaultValue<span class=\"k\">(</span>me<span class=\"k\">,</span> table<span class=\"k\">),</span>","            <span class=\"c\">//&#36825;&#37324;&#19981;&#32771;&#34385;&#19968;&#20010;&#37117;&#27809;&#26377;&#24773;&#20917;&#65292;&#22914;&#26524;&#19968;&#20010;&#37117;&#27809;&#26377;&#65292;&#21487;&#20197;&#35748;&#20026;&#35813;&#34920;&#26684;&#30340;&#32467;&#26500;&#21487;&#20197;&#31934;&#31616;</span>","                leftCells <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameEndPosCells<span class=\"k\">(</span>cell<span class=\"k\">,</span> <span class=\"s\">\"x\"</span><span class=\"k\">),</span>","                backLeftWidth <span class=\"k\">=</span> getWidth<span class=\"k\">(</span>leftCells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">])</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tdPadding <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tdBorder<span class=\"k\">,</span>","                rightCells <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameStartPosXCells<span class=\"k\">(</span>cell<span class=\"k\">),</span>","                backRightWidth <span class=\"k\">=</span> getWidth<span class=\"k\">(</span>rightCells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">])</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tdPadding <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tdBorder<span class=\"k\">;</span>","            <span class=\"c\">//&#25972;&#21015;&#34987;rowspan&#26102;&#23384;&#22312;</span>","            utils<span class=\"k\">.</span>each<span class=\"k\">(</span>leftCells<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>width<span class=\"k\">)</span> cell<span class=\"k\">.</span>style<span class=\"k\">.</span>width <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>changeValue <span class=\"k\">&lt;</span> <span class=\"s\">0</span><span class=\"k\">)</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>wordBreak <span class=\"k\">=</span> <span class=\"s\">\"break-all\"</span><span class=\"k\">;</span>","                cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> backLeftWidth <span class=\"k\">+</span> changeValue<span class=\"k\">);</span>","            <span class=\"k\">}</span><span class=\"k\">);</span>","            utils<span class=\"k\">.</span>each<span class=\"k\">(</span>rightCells<span class=\"k\">,</span> <span class=\"k\">function</span> <span class=\"k\">(</span>cell<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>width<span class=\"k\">)</span> cell<span class=\"k\">.</span>style<span class=\"k\">.</span>width <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>changeValue <span class=\"k\">&gt;</span> <span class=\"s\">0</span><span class=\"k\">)</span>cell<span class=\"k\">.</span>style<span class=\"k\">.</span>wordBreak <span class=\"k\">=</span> <span class=\"s\">\"break-all\"</span><span class=\"k\">;</span>","                cell<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> backRightWidth <span class=\"k\">-</span> changeValue<span class=\"k\">);</span>","            <span class=\"k\">}</span><span class=\"k\">);</span>","            <span class=\"c\">//&#22914;&#26524;&#26159;&#22312;&#34920;&#26684;&#26368;&#21491;&#36793;&#25302;&#21160;&#65292;&#21017;&#36824;&#38656;&#35201;&#35843;&#25972;&#34920;&#26684;&#23485;&#24230;&#65292;&#21542;&#21017;&#22312;&#21512;&#24182;&#36807;&#30340;&#21333;&#20803;&#26684;&#20013;&#36755;&#20837;&#25991;&#23383;&#65292;&#34920;&#26684;&#20250;&#34987;&#25745;&#24320;</span>","            <span class=\"k\">if</span> <span class=\"k\">(!</span>cell<span class=\"k\">.</span>nextSibling<span class=\"k\">)</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>table<span class=\"k\">.</span>style<span class=\"k\">.</span>width<span class=\"k\">)</span> table<span class=\"k\">.</span>style<span class=\"k\">.</span>width <span class=\"k\">=</span> <span class=\"s\">\"\"</span><span class=\"k\">;</span>","                table<span class=\"k\">.</span>setAttribute<span class=\"k\">(</span><span class=\"s\">\"width\"</span><span class=\"k\">,</span> backTableWidth <span class=\"k\">+</span> changeValue<span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span>","","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> changeRowHeight<span class=\"k\">(</span>td<span class=\"k\">,</span> changeValue<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>Math<span class=\"k\">.</span>abs<span class=\"k\">(</span>changeValue<span class=\"k\">)</span> <span class=\"k\">&lt;</span> <span class=\"s\">10</span><span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> ut <span class=\"k\">=</span> getUETable<span class=\"k\">(</span>td<span class=\"k\">);</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>ut<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> cells <span class=\"k\">=</span> ut<span class=\"k\">.</span>getSameEndPosCells<span class=\"k\">(</span>td<span class=\"k\">,</span> <span class=\"s\">\"y\"</span><span class=\"k\">),</span>","            <span class=\"c\">//&#22791;&#20221;&#38656;&#35201;&#36830;&#24102;&#21464;&#21270;&#30340;td&#30340;&#21407;&#22987;&#39640;&#24230;&#65292;&#21542;&#21017;&#21518;&#26399;&#26080;&#27861;&#33719;&#21462;&#27491;&#30830;&#30340;&#20540;</span>","                backHeight <span class=\"k\">=</span> cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">]</span> <span class=\"k\">?</span> cells<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>offsetHeight <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">;</span>","            <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> cell<span class=\"k\">;</span> cell <span class=\"k\">=</span> cells<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","                setCellHeight<span class=\"k\">(</span>cell<span class=\"k\">,</span> changeValue<span class=\"k\">,</span> backHeight<span class=\"k\">);</span>","            <span class=\"k\">}</span>","        <span class=\"k\">}</span>","","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> getDragLine<span class=\"k\">(</span>editor<span class=\"k\">,</span> doc<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>mousedown<span class=\"k\">)</span><span class=\"k\">return</span><span class=\"k\">;</span>","        dragLine <span class=\"k\">=</span> editor<span class=\"k\">.</span>document<span class=\"k\">.</span>createElement<span class=\"k\">(</span><span class=\"s\">\"div\"</span><span class=\"k\">);</span>","        domUtils<span class=\"k\">.</span>setAttributes<span class=\"k\">(</span>dragLine<span class=\"k\">,</span> <span class=\"k\">{</span>","            id<span class=\"k\">:</span><span class=\"s\">\"ue_tableDragLine\"</span><span class=\"k\">,</span>","            unselectable<span class=\"k\">:</span><span class=\"s\">'on'</span><span class=\"k\">,</span>","            contenteditable<span class=\"k\">:</span><span class=\"k\">false</span><span class=\"k\">,</span>","            <span class=\"s\">'onresizestart'</span><span class=\"k\">:</span><span class=\"s\">'return false'</span><span class=\"k\">,</span>","            <span class=\"s\">'ondragstart'</span><span class=\"k\">:</span><span class=\"s\">'return false'</span><span class=\"k\">,</span>","            <span class=\"s\">'onselectstart'</span><span class=\"k\">:</span><span class=\"s\">'return false'</span><span class=\"k\">,</span>","            style<span class=\"k\">:</span><span class=\"s\">\"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)\"</span>","        <span class=\"k\">}</span><span class=\"k\">);</span>","        editor<span class=\"k\">.</span>body<span class=\"k\">.</span>appendChild<span class=\"k\">(</span>dragLine<span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> hideDragLine<span class=\"k\">(</span>editor<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(</span>mousedown<span class=\"k\">)</span><span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> line<span class=\"k\">;</span>","        <span class=\"k\">while</span> <span class=\"k\">(</span>line <span class=\"k\">=</span> editor<span class=\"k\">.</span>document<span class=\"k\">.</span>getElementById<span class=\"k\">(</span><span class=\"s\">'ue_tableDragLine'</span><span class=\"k\">))</span> <span class=\"k\">{</span>","            domUtils<span class=\"k\">.</span>remove<span class=\"k\">(</span>line<span class=\"k\">)</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#20381;&#25454;state&#65288;v|h&#65289;&#22312;cell&#20301;&#32622;&#26174;&#31034;&#27178;&#32447;</span>","<span class=\"c\">     * @param state</span>","<span class=\"c\">     * @param cell</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> showDragLineAt<span class=\"k\">(</span>state<span class=\"k\">,</span> cell<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">if</span> <span class=\"k\">(!</span>cell<span class=\"k\">)</span> <span class=\"k\">return</span><span class=\"k\">;</span>","        <span class=\"k\">var</span> table <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>cell<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">),</span>","            caption <span class=\"k\">=</span> table<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span><span class=\"s\">'caption'</span><span class=\"k\">),</span>","            width <span class=\"k\">=</span> table<span class=\"k\">.</span>offsetWidth<span class=\"k\">,</span>","            height <span class=\"k\">=</span> table<span class=\"k\">.</span>offsetHeight <span class=\"k\">-</span> <span class=\"k\">(</span>caption<span class=\"k\">.</span>length <span class=\"k\">&gt;</span> <span class=\"s\">0</span> <span class=\"k\">?</span> caption<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>offsetHeight <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">),</span>","            tablePos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>table<span class=\"k\">),</span>","            cellPos <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getXY<span class=\"k\">(</span>cell<span class=\"k\">),</span> css<span class=\"k\">;</span>","        <span class=\"k\">switch</span> <span class=\"k\">(</span>state<span class=\"k\">)</span> <span class=\"k\">{</span>","            <span class=\"k\">case</span> <span class=\"s\">\"h\"</span><span class=\"k\">:</span>","                css <span class=\"k\">=</span> <span class=\"s\">'height:'</span> <span class=\"k\">+</span> height <span class=\"k\">+</span> <span class=\"s\">'px;top:'</span> <span class=\"k\">+</span> <span class=\"k\">(</span>tablePos<span class=\"k\">.</span>y <span class=\"k\">+</span> <span class=\"k\">(</span>caption<span class=\"k\">.</span>length <span class=\"k\">&gt;</span> <span class=\"s\">0</span> <span class=\"k\">?</span> caption<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>offsetHeight <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">))</span> <span class=\"k\">+</span> <span class=\"s\">'px;left:'</span> <span class=\"k\">+</span> <span class=\"k\">(</span>cellPos<span class=\"k\">.</span>x <span class=\"k\">+</span> cell<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span> <span class=\"s\">2</span><span class=\"k\">);</span>","                dragLine<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> css <span class=\"k\">+</span> <span class=\"s\">'px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)'</span><span class=\"k\">;</span>","                <span class=\"k\">break</span><span class=\"k\">;</span>","            <span class=\"k\">case</span> <span class=\"s\">\"v\"</span><span class=\"k\">:</span>","                css <span class=\"k\">=</span> <span class=\"s\">'width:'</span> <span class=\"k\">+</span> width <span class=\"k\">+</span> <span class=\"s\">'px;left:'</span> <span class=\"k\">+</span> tablePos<span class=\"k\">.</span>x <span class=\"k\">+</span> <span class=\"s\">'px;top:'</span> <span class=\"k\">+</span> <span class=\"k\">(</span>cellPos<span class=\"k\">.</span>y <span class=\"k\">+</span> cell<span class=\"k\">.</span>offsetHeight <span class=\"k\">-</span> <span class=\"s\">2</span> <span class=\"k\">);</span>","                <span class=\"c\">//&#24517;&#39035;&#21152;&#19978;border:0&#21644;color:blue&#65292;&#21542;&#21017;&#20302;&#29256;ie&#19981;&#25903;&#25345;&#32972;&#26223;&#33394;&#26174;&#31034;</span>","                dragLine<span class=\"k\">.</span>style<span class=\"k\">.</span>cssText <span class=\"k\">=</span> css <span class=\"k\">+</span> <span class=\"s\">'px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)'</span><span class=\"k\">;</span>","                <span class=\"k\">break</span><span class=\"k\">;</span>","            <span class=\"k\">default</span><span class=\"k\">:</span>","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"c\">/**</span>","<span class=\"c\">     * &#24403;&#34920;&#26684;&#36793;&#26694;&#39068;&#33394;&#20026;&#30333;&#33394;&#26102;&#35774;&#32622;&#20026;&#34394;&#32447;,true&#20026;&#28155;&#21152;&#34394;&#32447;</span>","<span class=\"c\">     * @param editor</span>","<span class=\"c\">     * @param flag</span>","<span class=\"c\">     */</span>","    <span class=\"k\">function</span> switchBorderColor<span class=\"k\">(</span>editor<span class=\"k\">,</span> flag<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> tableArr <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>editor<span class=\"k\">.</span>body<span class=\"k\">,</span> <span class=\"s\">\"table\"</span><span class=\"k\">),</span> color<span class=\"k\">;</span>","        <span class=\"k\">for</span> <span class=\"k\">(</span><span class=\"k\">var</span> i <span class=\"k\">=</span> <span class=\"s\">0</span><span class=\"k\">,</span> node<span class=\"k\">;</span> node <span class=\"k\">=</span> tableArr<span class=\"k\">[</span>i<span class=\"k\">++];)</span> <span class=\"k\">{</span>","            <span class=\"k\">var</span> td <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>getElementsByTagName<span class=\"k\">(</span>node<span class=\"k\">,</span> <span class=\"s\">\"td\"</span><span class=\"k\">);</span>","            <span class=\"k\">if</span> <span class=\"k\">(</span>td<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">])</span> <span class=\"k\">{</span>","                <span class=\"k\">if</span> <span class=\"k\">(</span>flag<span class=\"k\">)</span> <span class=\"k\">{</span>","                    color <span class=\"k\">=</span> <span class=\"k\">(</span>td<span class=\"k\">[</span><span class=\"s\">0</span><span class=\"k\">].</span>style<span class=\"k\">.</span>borderColor<span class=\"k\">).</span>replace<span class=\"k\">(</span><span class=\"s\">/\\s/g</span><span class=\"k\">,</span> <span class=\"s\">\"\"</span><span class=\"k\">);</span>","                    <span class=\"k\">if</span> <span class=\"k\">(</span><span class=\"s\">/(#ffffff)|(rgb\\(255,f55,255\\))/ig</span><span class=\"k\">.</span>test<span class=\"k\">(</span>color<span class=\"k\">))</span>","                        domUtils<span class=\"k\">.</span>addClass<span class=\"k\">(</span>node<span class=\"k\">,</span> <span class=\"s\">\"noBorderTable\"</span><span class=\"k\">)</span>","                <span class=\"k\">}</span> <span class=\"k\">else</span> <span class=\"k\">{</span>","                    domUtils<span class=\"k\">.</span>removeClasses<span class=\"k\">(</span>node<span class=\"k\">,</span> <span class=\"s\">\"noBorderTable\"</span><span class=\"k\">)</span>","                <span class=\"k\">}</span>","            <span class=\"k\">}</span>","","        <span class=\"k\">}</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> getTableWidth<span class=\"k\">(</span>editor<span class=\"k\">,</span> needIEHack<span class=\"k\">,</span> defaultValue<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> body <span class=\"k\">=</span> editor<span class=\"k\">.</span>body<span class=\"k\">;</span>","        <span class=\"k\">return</span> body<span class=\"k\">.</span>offsetWidth <span class=\"k\">-</span> <span class=\"k\">(</span>needIEHack <span class=\"k\">?</span> parseInt<span class=\"k\">(</span>domUtils<span class=\"k\">.</span>getComputedStyle<span class=\"k\">(</span>body<span class=\"k\">,</span> <span class=\"s\">'margin-left'</span><span class=\"k\">),</span> <span class=\"s\">10</span><span class=\"k\">)</span> <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">:</span> <span class=\"s\">0</span><span class=\"k\">)</span> <span class=\"k\">-</span> defaultValue<span class=\"k\">.</span>tableBorder <span class=\"k\">*</span> <span class=\"s\">2</span> <span class=\"k\">-</span> <span class=\"k\">(</span>editor<span class=\"k\">.</span>options<span class=\"k\">.</span>offsetWidth <span class=\"k\">||</span> <span class=\"s\">0</span><span class=\"k\">);</span>","    <span class=\"k\">}</span>","","    <span class=\"k\">function</span> getTargetTd<span class=\"k\">(</span>editor<span class=\"k\">,</span> evt<span class=\"k\">)</span> <span class=\"k\">{</span>","        <span class=\"k\">var</span> target <span class=\"k\">=</span> domUtils<span class=\"k\">.</span>findParentByTagName<span class=\"k\">(</span>evt<span class=\"k\">.</span>target <span class=\"k\">||</span> evt<span class=\"k\">.</span>srcElement<span class=\"k\">,</span> <span class=\"k\">[</span><span class=\"s\">\"td\"</span><span class=\"k\">,</span> <span class=\"s\">\"th\"</span><span class=\"k\">],</span> <span class=\"k\">true</span><span class=\"k\">);</span>","        <span class=\"c\">//&#25490;&#38500;&#20102;&#38750;td&#20869;&#37096;&#20197;&#21450;&#29992;&#20110;&#20195;&#30721;&#39640;&#20142;&#37096;&#20998;&#30340;td</span>","        <span class=\"k\">return</span> target <span class=\"k\">&amp;&amp;</span> <span class=\"k\">!(</span>editor<span class=\"k\">.</span>fireEvent<span class=\"k\">(</span><span class=\"s\">\"excludetable\"</span><span class=\"k\">,</span> target<span class=\"k\">)</span> <span class=\"k\">===</span> <span class=\"k\">true</span><span class=\"k\">)</span> <span class=\"k\">?</span> target <span class=\"k\">:</span> <span class=\"k\">null</span><span class=\"k\">;</span>","    <span class=\"k\">}</span>","<span class=\"k\">}</span><span class=\"k\">;</span>"];
_$jscoverage['plugins/table.action.js'][8]++;
UE.plugins.table = (function () {
  _$jscoverage['plugins/table.action.js'][9]++;
  var me = this, debug = true, UT = UE.UETable, getUETable = (function (tdOrTable) {
  _$jscoverage['plugins/table.action.js'][13]++;
  return UT.getUETable(tdOrTable);
}), getUETableBySelected = (function (editor) {
  _$jscoverage['plugins/table.action.js'][16]++;
  return UT.getUETableBySelected(editor);
}), getDefaultValue = (function (editor, table) {
  _$jscoverage['plugins/table.action.js'][19]++;
  return UT.getDefaultValue(editor, table);
}), removeSelectedClass = (function (cells) {
  _$jscoverage['plugins/table.action.js'][22]++;
  return UT.removeSelectedClass(cells);
});
  _$jscoverage['plugins/table.action.js'][25]++;
  function showError(e) {
    _$jscoverage['plugins/table.action.js'][26]++;
    if (debug) {
      _$jscoverage['plugins/table.action.js'][26]++;
      throw e;
    }
}
  _$jscoverage['plugins/table.action.js'][30]++;
  var startTd = null, currentTd = null, onDrag = "", onBorder = false, dragButton = null, dragOver = false, dragLine = null, dragTd = null;
  _$jscoverage['plugins/table.action.js'][39]++;
  var mousedown = false, needIEHack = true;
  _$jscoverage['plugins/table.action.js'][43]++;
  me.setOpt({"maxColNum": 20, "maxRowNum": 100, "defaultCols": 5, "defaultRows": 5, "tdvalign": "top", "cursorpath": (me.options.UEDITOR_HOME_URL + "themes/default/images/cursor_"), "tableDragable": false, "classList": ["back1", "back2"]});
  _$jscoverage['plugins/table.action.js'][53]++;
  me.getUETable = getUETable;
  _$jscoverage['plugins/table.action.js'][54]++;
  var commands = {"deletetable": 1, "inserttable": 1, "cellvalign": 1, "insertcaption": 1, "deletecaption": 1, "inserttitle": 1, "deletetitle": 1, "mergeright": 1, "mergedown": 1, "mergecells": 1, "insertrow": 1, "insertrownext": 1, "deleterow": 1, "insertcol": 1, "insertcolnext": 1, "deletecol": 1, "splittocells": 1, "splittorows": 1, "splittocols": 1, "adaptbytext": 1, "adaptbywindow": 1, "adaptbycustomer": 1, "insertparagraph": 1, "insertparagraphbeforetable": 1, "averagedistributecol": 1, "averagedistributerow": 1};
  _$jscoverage['plugins/table.action.js'][82]++;
  me.ready((function () {
  _$jscoverage['plugins/table.action.js'][83]++;
  utils.cssRule("table", ".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:2px solid #BBB;background:#F7F7F7;}td p{margin:0;padding:0;}", me.document);
  _$jscoverage['plugins/table.action.js'][94]++;
  var tableCopyList, isFullCol, isFullRow;
  _$jscoverage['plugins/table.action.js'][96]++;
  me.addListener("keydown", (function (cmd, evt) {
  _$jscoverage['plugins/table.action.js'][97]++;
  var me = this;
  _$jscoverage['plugins/table.action.js'][98]++;
  var keyCode = (evt.keyCode || evt.which);
  _$jscoverage['plugins/table.action.js'][100]++;
  if ((keyCode == 8)) {
    _$jscoverage['plugins/table.action.js'][102]++;
    var ut = getUETableBySelected(me);
    _$jscoverage['plugins/table.action.js'][103]++;
    if ((ut && ut.selectedTds.length)) {
      _$jscoverage['plugins/table.action.js'][104]++;
      me.fireEvent("saveScene");
      _$jscoverage['plugins/table.action.js'][105]++;
      if (ut.isFullCol()) {
        _$jscoverage['plugins/table.action.js'][106]++;
        me.execCommand("deletecol");
      }
      else {
        _$jscoverage['plugins/table.action.js'][107]++;
        if (ut.isFullRow()) {
          _$jscoverage['plugins/table.action.js'][108]++;
          me.execCommand("deleterow");
        }
        else {
          _$jscoverage['plugins/table.action.js'][110]++;
          me.fireEvent("delcells");
        }
      }
      _$jscoverage['plugins/table.action.js'][112]++;
      domUtils.preventDefault(evt);
    }
    _$jscoverage['plugins/table.action.js'][115]++;
    var caption = domUtils.findParentByTagName(me.selection.getStart(), "caption", true), range = me.selection.getRange();
    _$jscoverage['plugins/table.action.js'][117]++;
    if ((range.collapsed && caption && isEmptyBlock(caption))) {
      _$jscoverage['plugins/table.action.js'][118]++;
      me.fireEvent("saveScene");
      _$jscoverage['plugins/table.action.js'][119]++;
      var table = caption.parentNode;
      _$jscoverage['plugins/table.action.js'][120]++;
      domUtils.remove(caption);
      _$jscoverage['plugins/table.action.js'][121]++;
      if (table) {
        _$jscoverage['plugins/table.action.js'][122]++;
        range.setStart(table.rows[0].cells[0], 0).setCursor(false, true);
      }
    }
    _$jscoverage['plugins/table.action.js'][125]++;
    me.fireEvent("saveScene");
  }
  _$jscoverage['plugins/table.action.js'][128]++;
  if ((keyCode == 46)) {
    _$jscoverage['plugins/table.action.js'][130]++;
    ut = getUETableBySelected(me);
    _$jscoverage['plugins/table.action.js'][131]++;
    if (ut) {
      _$jscoverage['plugins/table.action.js'][132]++;
      me.fireEvent("saveScene");
      _$jscoverage['plugins/table.action.js'][133]++;
      for (var i = 0, ci; (ci = ut.selectedTds[(i++)]);) {
        _$jscoverage['plugins/table.action.js'][134]++;
        domUtils.fillNode(me.document, ci);
}
      _$jscoverage['plugins/table.action.js'][136]++;
      me.fireEvent("saveScene");
      _$jscoverage['plugins/table.action.js'][137]++;
      domUtils.preventDefault(evt);
    }
  }
  _$jscoverage['plugins/table.action.js'][142]++;
  if ((keyCode == 13)) {
    _$jscoverage['plugins/table.action.js'][144]++;
    var rng = me.selection.getRange(), caption = domUtils.findParentByTagName(rng.startContainer, "caption", true);
    _$jscoverage['plugins/table.action.js'][146]++;
    if (caption) {
      _$jscoverage['plugins/table.action.js'][147]++;
      var table = domUtils.findParentByTagName(caption, "table");
      _$jscoverage['plugins/table.action.js'][148]++;
      if ((! rng.collapsed)) {
        _$jscoverage['plugins/table.action.js'][150]++;
        rng.deleteContents();
        _$jscoverage['plugins/table.action.js'][151]++;
        me.fireEvent("saveScene");
      }
      else {
        _$jscoverage['plugins/table.action.js'][153]++;
        if (caption) {
          _$jscoverage['plugins/table.action.js'][154]++;
          rng.setStart(table.rows[0].cells[0], 0).setCursor(false, true);
        }
      }
      _$jscoverage['plugins/table.action.js'][157]++;
      domUtils.preventDefault(evt);
      _$jscoverage['plugins/table.action.js'][158]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][160]++;
    if (rng.collapsed) {
      _$jscoverage['plugins/table.action.js'][161]++;
      var table = domUtils.findParentByTagName(rng.startContainer, "table");
      _$jscoverage['plugins/table.action.js'][162]++;
      if (table) {
        _$jscoverage['plugins/table.action.js'][163]++;
        var cell = table.rows[0].cells[0], start = domUtils.findParentByTagName(me.selection.getStart(), ["td", "th"], true), preNode = table.previousSibling;
        _$jscoverage['plugins/table.action.js'][166]++;
        if (((cell === start) && ((! preNode) || ((preNode.nodeType == 1) && (preNode.tagName == "TABLE"))) && domUtils.isStartInblock(rng))) {
          _$jscoverage['plugins/table.action.js'][167]++;
          me.execCommand("insertparagraphbeforetable");
          _$jscoverage['plugins/table.action.js'][168]++;
          domUtils.preventDefault(evt);
        }
      }
    }
  }
  _$jscoverage['plugins/table.action.js'][174]++;
  if (((evt.ctrlKey || evt.metaKey) && (evt.keyCode == "67"))) {
    _$jscoverage['plugins/table.action.js'][175]++;
    tableCopyList = null;
    _$jscoverage['plugins/table.action.js'][176]++;
    var ut = getUETableBySelected(me);
    _$jscoverage['plugins/table.action.js'][177]++;
    if (ut) {
      _$jscoverage['plugins/table.action.js'][178]++;
      var tds = ut.selectedTds;
      _$jscoverage['plugins/table.action.js'][179]++;
      isFullCol = ut.isFullCol();
      _$jscoverage['plugins/table.action.js'][180]++;
      isFullRow = ut.isFullRow();
      _$jscoverage['plugins/table.action.js'][181]++;
      tableCopyList = [[ut.cloneCell(tds[0])]];
      _$jscoverage['plugins/table.action.js'][184]++;
      for (var i = 1, ci = ci; (ci = tds[i]); (i++)) {
        _$jscoverage['plugins/table.action.js'][185]++;
        if ((ci.parentNode !== tds[(i - 1)].parentNode)) {
          _$jscoverage['plugins/table.action.js'][186]++;
          tableCopyList.push([ut.cloneCell(ci)]);
        }
        else {
          _$jscoverage['plugins/table.action.js'][188]++;
          tableCopyList[(tableCopyList.length - 1)].push(ut.cloneCell(ci));
        }
}
    }
  }
}));
  _$jscoverage['plugins/table.action.js'][195]++;
  me.addListener("tablehasdeleted", (function () {
  _$jscoverage['plugins/table.action.js'][196]++;
  toggleDraggableState(this, false, "", null);
  _$jscoverage['plugins/table.action.js'][197]++;
  if (dragButton) {
    _$jscoverage['plugins/table.action.js'][197]++;
    domUtils.remove(dragButton);
  }
}));
  _$jscoverage['plugins/table.action.js'][200]++;
  me.addListener("beforepaste", (function (cmd, html) {
  _$jscoverage['plugins/table.action.js'][201]++;
  var me = this;
  _$jscoverage['plugins/table.action.js'][202]++;
  var rng = me.selection.getRange();
  _$jscoverage['plugins/table.action.js'][203]++;
  if (domUtils.findParentByTagName(rng.startContainer, "caption", true)) {
    _$jscoverage['plugins/table.action.js'][204]++;
    var div = me.document.createElement("div");
    _$jscoverage['plugins/table.action.js'][205]++;
    div.innerHTML = html.html;
    _$jscoverage['plugins/table.action.js'][206]++;
    html.html = div[(browser.ie? "innerText": "textContent")];
    _$jscoverage['plugins/table.action.js'][207]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][209]++;
  var table = getUETableBySelected(me);
  _$jscoverage['plugins/table.action.js'][210]++;
  if (tableCopyList) {
    _$jscoverage['plugins/table.action.js'][211]++;
    me.fireEvent("saveScene");
    _$jscoverage['plugins/table.action.js'][212]++;
    var rng = me.selection.getRange();
    _$jscoverage['plugins/table.action.js'][213]++;
    var td = domUtils.findParentByTagName(rng.startContainer, ["td", "th"], true), tmpNode, preNode;
    _$jscoverage['plugins/table.action.js'][214]++;
    if (td) {
      _$jscoverage['plugins/table.action.js'][215]++;
      var ut = getUETable(td);
      _$jscoverage['plugins/table.action.js'][216]++;
      if (isFullRow) {
        _$jscoverage['plugins/table.action.js'][217]++;
        var rowIndex = ut.getCellInfo(td).rowIndex;
        _$jscoverage['plugins/table.action.js'][218]++;
        if ((td.tagName == "TH")) {
          _$jscoverage['plugins/table.action.js'][219]++;
          (rowIndex++);
        }
        _$jscoverage['plugins/table.action.js'][221]++;
        for (var i = 0, ci; (ci = tableCopyList[(i++)]);) {
          _$jscoverage['plugins/table.action.js'][222]++;
          var tr = ut.insertRow((rowIndex++), "td");
          _$jscoverage['plugins/table.action.js'][223]++;
          for (var j = 0, cj; (cj = ci[j]); (j++)) {
            _$jscoverage['plugins/table.action.js'][224]++;
            var cell = tr.cells[j];
            _$jscoverage['plugins/table.action.js'][225]++;
            if ((! cell)) {
              _$jscoverage['plugins/table.action.js'][226]++;
              cell = tr.insertCell(j);
            }
            _$jscoverage['plugins/table.action.js'][228]++;
            cell.innerHTML = cj.innerHTML;
            _$jscoverage['plugins/table.action.js'][229]++;
            (cj.getAttribute("width") && cell.setAttribute("width", cj.getAttribute("width")));
            _$jscoverage['plugins/table.action.js'][230]++;
            (cj.getAttribute("vAlign") && cell.setAttribute("vAlign", cj.getAttribute("vAlign")));
            _$jscoverage['plugins/table.action.js'][231]++;
            (cj.getAttribute("align") && cell.setAttribute("align", cj.getAttribute("align")));
            _$jscoverage['plugins/table.action.js'][232]++;
            (cj.style.cssText && (cell.style.cssText = cj.style.cssText));
}
          _$jscoverage['plugins/table.action.js'][234]++;
          for (var j = 0, cj = cj; (cj = tr.cells[j]); (j++)) {
            _$jscoverage['plugins/table.action.js'][235]++;
            if ((! ci[j])) {
              _$jscoverage['plugins/table.action.js'][236]++;
              break;
            }
            _$jscoverage['plugins/table.action.js'][237]++;
            cj.innerHTML = ci[j].innerHTML;
            _$jscoverage['plugins/table.action.js'][238]++;
            (ci[j].getAttribute("width") && cj.setAttribute("width", ci[j].getAttribute("width")));
            _$jscoverage['plugins/table.action.js'][239]++;
            (ci[j].getAttribute("vAlign") && cj.setAttribute("vAlign", ci[j].getAttribute("vAlign")));
            _$jscoverage['plugins/table.action.js'][240]++;
            (ci[j].getAttribute("align") && cj.setAttribute("align", ci[j].getAttribute("align")));
            _$jscoverage['plugins/table.action.js'][241]++;
            (ci[j].style.cssText && (cj.style.cssText = ci[j].style.cssText));
}
}
      }
      else {
        _$jscoverage['plugins/table.action.js'][245]++;
        if (isFullCol) {
          _$jscoverage['plugins/table.action.js'][246]++;
          cellInfo = ut.getCellInfo(td);
          _$jscoverage['plugins/table.action.js'][247]++;
          var maxColNum = 0;
          _$jscoverage['plugins/table.action.js'][248]++;
          for (var j = 0, ci = tableCopyList[0], cj = cj; (cj = ci[(j++)]);) {
            _$jscoverage['plugins/table.action.js'][249]++;
            maxColNum += (cj.colSpan || 1);
}
          _$jscoverage['plugins/table.action.js'][251]++;
          me.__hasEnterExecCommand = true;
          _$jscoverage['plugins/table.action.js'][252]++;
          for (i = 0; (i < maxColNum); (i++)) {
            _$jscoverage['plugins/table.action.js'][253]++;
            me.execCommand("insertcol");
}
          _$jscoverage['plugins/table.action.js'][255]++;
          me.__hasEnterExecCommand = false;
          _$jscoverage['plugins/table.action.js'][256]++;
          td = ut.table.rows[0].cells[cellInfo.cellIndex];
          _$jscoverage['plugins/table.action.js'][257]++;
          if ((td.tagName == "TH")) {
            _$jscoverage['plugins/table.action.js'][258]++;
            td = ut.table.rows[1].cells[cellInfo.cellIndex];
          }
        }
        _$jscoverage['plugins/table.action.js'][261]++;
        for (var i = 0, ci = ci; (ci = tableCopyList[(i++)]);) {
          _$jscoverage['plugins/table.action.js'][262]++;
          tmpNode = td;
          _$jscoverage['plugins/table.action.js'][263]++;
          for (var j = 0, cj = cj; (cj = ci[(j++)]);) {
            _$jscoverage['plugins/table.action.js'][264]++;
            if (td) {
              _$jscoverage['plugins/table.action.js'][265]++;
              td.innerHTML = cj.innerHTML;
              _$jscoverage['plugins/table.action.js'][267]++;
              (cj.getAttribute("width") && td.setAttribute("width", cj.getAttribute("width")));
              _$jscoverage['plugins/table.action.js'][268]++;
              (cj.getAttribute("vAlign") && td.setAttribute("vAlign", cj.getAttribute("vAlign")));
              _$jscoverage['plugins/table.action.js'][269]++;
              (cj.getAttribute("align") && td.setAttribute("align", cj.getAttribute("align")));
              _$jscoverage['plugins/table.action.js'][270]++;
              (cj.style.cssText && (td.style.cssText = cj.style.cssText));
              _$jscoverage['plugins/table.action.js'][271]++;
              preNode = td;
              _$jscoverage['plugins/table.action.js'][272]++;
              td = td.nextSibling;
            }
            else {
              _$jscoverage['plugins/table.action.js'][274]++;
              var cloneTd = cj.cloneNode(true);
              _$jscoverage['plugins/table.action.js'][275]++;
              domUtils.removeAttributes(cloneTd, ["class", "rowSpan", "colSpan"]);
              _$jscoverage['plugins/table.action.js'][277]++;
              preNode.parentNode.appendChild(cloneTd);
            }
}
          _$jscoverage['plugins/table.action.js'][280]++;
          td = ut.getNextCell(tmpNode, true, true);
          _$jscoverage['plugins/table.action.js'][281]++;
          if ((! tableCopyList[i])) {
            _$jscoverage['plugins/table.action.js'][282]++;
            break;
          }
          _$jscoverage['plugins/table.action.js'][283]++;
          if ((! td)) {
            _$jscoverage['plugins/table.action.js'][284]++;
            var cellInfo = ut.getCellInfo(tmpNode);
            _$jscoverage['plugins/table.action.js'][285]++;
            ut.table.insertRow(ut.table.rows.length);
            _$jscoverage['plugins/table.action.js'][286]++;
            ut.update();
            _$jscoverage['plugins/table.action.js'][287]++;
            td = ut.getVSideCell(tmpNode, true);
          }
}
      }
      _$jscoverage['plugins/table.action.js'][291]++;
      ut.update();
    }
    else {
      _$jscoverage['plugins/table.action.js'][293]++;
      table = me.document.createElement("table");
      _$jscoverage['plugins/table.action.js'][294]++;
      for (var i = 0, ci = ci; (ci = tableCopyList[(i++)]);) {
        _$jscoverage['plugins/table.action.js'][295]++;
        var tr = table.insertRow(table.rows.length);
        _$jscoverage['plugins/table.action.js'][296]++;
        for (var j = 0, cj = cj; (cj = ci[(j++)]);) {
          _$jscoverage['plugins/table.action.js'][297]++;
          cloneTd = UT.cloneCell(cj);
          _$jscoverage['plugins/table.action.js'][298]++;
          domUtils.removeAttributes(cloneTd, ["class"]);
          _$jscoverage['plugins/table.action.js'][299]++;
          tr.appendChild(cloneTd);
}
        _$jscoverage['plugins/table.action.js'][301]++;
        if (((j == 2) && (cloneTd.rowSpan > 1))) {
          _$jscoverage['plugins/table.action.js'][302]++;
          cloneTd.rowSpan = 1;
        }
}
      _$jscoverage['plugins/table.action.js'][306]++;
      var defaultValue = getDefaultValue(me), width = (me.body.offsetWidth - (needIEHack? (parseInt(domUtils.getComputedStyle(me.body, "margin-left"), 10) * 2): 0) - (defaultValue.tableBorder * 2) - (me.options.offsetWidth || 0));
      _$jscoverage['plugins/table.action.js'][309]++;
      me.execCommand("insertHTML", ("<table  " + ((isFullCol && isFullRow)? ("width=\"" + width + "\""): "") + ">" + table.innerHTML.replace(/>\s*</g, "><").replace(/\bth\b/gi, "td") + "</table>"));
    }
    _$jscoverage['plugins/table.action.js'][313]++;
    me.fireEvent("contentchange");
    _$jscoverage['plugins/table.action.js'][314]++;
    me.fireEvent("saveScene");
    _$jscoverage['plugins/table.action.js'][315]++;
    html.html = "";
  }
  else {
    _$jscoverage['plugins/table.action.js'][317]++;
    var div = me.document.createElement("div"), tables;
    _$jscoverage['plugins/table.action.js'][318]++;
    div.innerHTML = html.html;
    _$jscoverage['plugins/table.action.js'][319]++;
    tables = div.getElementsByTagName("table");
    _$jscoverage['plugins/table.action.js'][320]++;
    if (domUtils.findParentByTagName(me.selection.getStart(), "table")) {
      _$jscoverage['plugins/table.action.js'][321]++;
      utils.each(tables, (function (t) {
  _$jscoverage['plugins/table.action.js'][322]++;
  domUtils.remove(t);
}));
      _$jscoverage['plugins/table.action.js'][324]++;
      if (domUtils.findParentByTagName(me.selection.getStart(), "caption", true)) {
        _$jscoverage['plugins/table.action.js'][325]++;
        div.innerHTML = div[(browser.ie? "innerText": "textContent")];
      }
    }
    else {
      _$jscoverage['plugins/table.action.js'][328]++;
      utils.each(tables, (function (table) {
  _$jscoverage['plugins/table.action.js'][329]++;
  removeStyleSize(table, true);
  _$jscoverage['plugins/table.action.js'][330]++;
  domUtils.removeAttributes(table, ["style", "border"]);
  _$jscoverage['plugins/table.action.js'][331]++;
  utils.each(domUtils.getElementsByTagName(table, "td"), (function (td) {
  _$jscoverage['plugins/table.action.js'][332]++;
  if (isEmptyBlock(td)) {
    _$jscoverage['plugins/table.action.js'][333]++;
    domUtils.fillNode(me.document, td);
  }
  _$jscoverage['plugins/table.action.js'][335]++;
  removeStyleSize(td, true);
}));
}));
    }
    _$jscoverage['plugins/table.action.js'][340]++;
    html.html = div.innerHTML;
  }
}));
  _$jscoverage['plugins/table.action.js'][344]++;
  me.addListener("afterpaste", (function () {
  _$jscoverage['plugins/table.action.js'][345]++;
  utils.each(domUtils.getElementsByTagName(me.body, "table"), (function (table) {
  _$jscoverage['plugins/table.action.js'][346]++;
  if ((table.offsetWidth > me.body.offsetWidth)) {
    _$jscoverage['plugins/table.action.js'][347]++;
    var defaultValue = getDefaultValue(me, table);
    _$jscoverage['plugins/table.action.js'][348]++;
    table.style.width = ((me.body.offsetWidth - (needIEHack? (parseInt(domUtils.getComputedStyle(me.body, "margin-left"), 10) * 2): 0) - (defaultValue.tableBorder * 2) - (me.options.offsetWidth || 0)) + "px");
  }
}));
}));
  _$jscoverage['plugins/table.action.js'][352]++;
  me.addListener("blur", (function () {
  _$jscoverage['plugins/table.action.js'][353]++;
  tableCopyList = null;
}));
  _$jscoverage['plugins/table.action.js'][355]++;
  var timer;
  _$jscoverage['plugins/table.action.js'][356]++;
  me.addListener("keydown", (function () {
  _$jscoverage['plugins/table.action.js'][357]++;
  clearTimeout(timer);
  _$jscoverage['plugins/table.action.js'][358]++;
  timer = setTimeout((function () {
  _$jscoverage['plugins/table.action.js'][359]++;
  var rng = me.selection.getRange(), cell = domUtils.findParentByTagName(rng.startContainer, ["th", "td"], true);
  _$jscoverage['plugins/table.action.js'][361]++;
  if (cell) {
    _$jscoverage['plugins/table.action.js'][362]++;
    var table = cell.parentNode.parentNode.parentNode;
    _$jscoverage['plugins/table.action.js'][363]++;
    if ((table.offsetWidth > table.getAttribute("width"))) {
      _$jscoverage['plugins/table.action.js'][364]++;
      cell.style.wordBreak = "break-all";
    }
  }
}), 100);
}));
  _$jscoverage['plugins/table.action.js'][370]++;
  me.addListener("selectionchange", (function () {
  _$jscoverage['plugins/table.action.js'][371]++;
  toggleDraggableState(me, false, "", null);
}));
  _$jscoverage['plugins/table.action.js'][377]++;
  me.addListener("contentchange", (function () {
  _$jscoverage['plugins/table.action.js'][378]++;
  var me = this;
  _$jscoverage['plugins/table.action.js'][380]++;
  hideDragLine(me);
  _$jscoverage['plugins/table.action.js'][381]++;
  if (getUETableBySelected(me)) {
    _$jscoverage['plugins/table.action.js'][381]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][382]++;
  var rng = me.selection.getRange();
  _$jscoverage['plugins/table.action.js'][383]++;
  var start = rng.startContainer;
  _$jscoverage['plugins/table.action.js'][384]++;
  start = domUtils.findParentByTagName(start, ["td", "th"], true);
  _$jscoverage['plugins/table.action.js'][385]++;
  utils.each(domUtils.getElementsByTagName(me.document, "table"), (function (table) {
  _$jscoverage['plugins/table.action.js'][386]++;
  if ((me.fireEvent("excludetable", table) === true)) {
    _$jscoverage['plugins/table.action.js'][386]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][387]++;
  table.ueTable = new UT(table);
  _$jscoverage['plugins/table.action.js'][388]++;
  utils.each(domUtils.getElementsByTagName(me.document, "td"), (function (td) {
  _$jscoverage['plugins/table.action.js'][390]++;
  if ((domUtils.isEmptyBlock(td) && (td !== start))) {
    _$jscoverage['plugins/table.action.js'][391]++;
    domUtils.fillNode(me.document, td);
    _$jscoverage['plugins/table.action.js'][392]++;
    if ((browser.ie && (browser.version == 6))) {
      _$jscoverage['plugins/table.action.js'][393]++;
      td.innerHTML = "&nbsp;";
    }
  }
}));
  _$jscoverage['plugins/table.action.js'][397]++;
  utils.each(domUtils.getElementsByTagName(me.document, "th"), (function (th) {
  _$jscoverage['plugins/table.action.js'][398]++;
  if ((domUtils.isEmptyBlock(th) && (th !== start))) {
    _$jscoverage['plugins/table.action.js'][399]++;
    domUtils.fillNode(me.document, th);
    _$jscoverage['plugins/table.action.js'][400]++;
    if ((browser.ie && (browser.version == 6))) {
      _$jscoverage['plugins/table.action.js'][401]++;
      th.innerHTML = "&nbsp;";
    }
  }
}));
  _$jscoverage['plugins/table.action.js'][405]++;
  table.onmousemove = (function () {
  _$jscoverage['plugins/table.action.js'][406]++;
  (me.options.tableDragable && toggleDragButton(true, this, me));
});
  _$jscoverage['plugins/table.action.js'][408]++;
  table.onmouseout = (function () {
  _$jscoverage['plugins/table.action.js'][409]++;
  toggleDraggableState(me, false, "", null);
  _$jscoverage['plugins/table.action.js'][410]++;
  hideDragLine(me);
});
  _$jscoverage['plugins/table.action.js'][412]++;
  table.onclick = (function (evt) {
  _$jscoverage['plugins/table.action.js'][413]++;
  evt = (me.window.event || evt);
  _$jscoverage['plugins/table.action.js'][414]++;
  var target = getParentTdOrTh((evt.target || evt.srcElement));
  _$jscoverage['plugins/table.action.js'][415]++;
  if ((! target)) {
    _$jscoverage['plugins/table.action.js'][415]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][416]++;
  var ut = getUETable(target), table = ut.table, cellInfo = ut.getCellInfo(target), cellsRange, rng = me.selection.getRange();
  _$jscoverage['plugins/table.action.js'][430]++;
  if (inTableSide(table, target, evt, true)) {
    _$jscoverage['plugins/table.action.js'][431]++;
    var endTdCol = ut.getCell(ut.indexTable[(ut.rowsNum - 1)][cellInfo.colIndex].rowIndex, ut.indexTable[(ut.rowsNum - 1)][cellInfo.colIndex].cellIndex);
    _$jscoverage['plugins/table.action.js'][432]++;
    if ((evt.shiftKey && ut.selectedTds.length)) {
      _$jscoverage['plugins/table.action.js'][433]++;
      if ((ut.selectedTds[0] !== endTdCol)) {
        _$jscoverage['plugins/table.action.js'][434]++;
        cellsRange = ut.getCellsRange(ut.selectedTds[0], endTdCol);
        _$jscoverage['plugins/table.action.js'][435]++;
        ut.setSelected(cellsRange);
      }
      else {
        _$jscoverage['plugins/table.action.js'][437]++;
        (rng && rng.selectNodeContents(endTdCol).select());
      }
    }
    else {
      _$jscoverage['plugins/table.action.js'][440]++;
      if ((target !== endTdCol)) {
        _$jscoverage['plugins/table.action.js'][441]++;
        cellsRange = ut.getCellsRange(target, endTdCol);
        _$jscoverage['plugins/table.action.js'][442]++;
        ut.setSelected(cellsRange);
      }
      else {
        _$jscoverage['plugins/table.action.js'][444]++;
        (rng && rng.selectNodeContents(endTdCol).select());
      }
    }
    _$jscoverage['plugins/table.action.js'][447]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][449]++;
  if (inTableSide(table, target, evt)) {
    _$jscoverage['plugins/table.action.js'][450]++;
    var endTdRow = ut.getCell(ut.indexTable[cellInfo.rowIndex][(ut.colsNum - 1)].rowIndex, ut.indexTable[cellInfo.rowIndex][(ut.colsNum - 1)].cellIndex);
    _$jscoverage['plugins/table.action.js'][451]++;
    if ((evt.shiftKey && ut.selectedTds.length)) {
      _$jscoverage['plugins/table.action.js'][452]++;
      if ((ut.selectedTds[0] !== endTdRow)) {
        _$jscoverage['plugins/table.action.js'][453]++;
        cellsRange = ut.getCellsRange(ut.selectedTds[0], endTdRow);
        _$jscoverage['plugins/table.action.js'][454]++;
        ut.setSelected(cellsRange);
      }
      else {
        _$jscoverage['plugins/table.action.js'][456]++;
        (rng && rng.selectNodeContents(endTdRow).select());
      }
    }
    else {
      _$jscoverage['plugins/table.action.js'][459]++;
      if ((target !== endTdRow)) {
        _$jscoverage['plugins/table.action.js'][460]++;
        cellsRange = ut.getCellsRange(target, endTdRow);
        _$jscoverage['plugins/table.action.js'][461]++;
        ut.setSelected(cellsRange);
      }
      else {
        _$jscoverage['plugins/table.action.js'][463]++;
        (rng && rng.selectNodeContents(endTdRow).select());
      }
    }
  }
});
  _$jscoverage['plugins/table.action.js'][468]++;
  table.ondblclick = (function (evt) {
  _$jscoverage['plugins/table.action.js'][469]++;
  evt = (me.window.event || evt);
  _$jscoverage['plugins/table.action.js'][470]++;
  var target = getParentTdOrTh((evt.target || evt.srcElement));
  _$jscoverage['plugins/table.action.js'][471]++;
  if (target) {
    _$jscoverage['plugins/table.action.js'][472]++;
    var h;
    _$jscoverage['plugins/table.action.js'][473]++;
    if ((h = getRelation(target, mouseCoords(evt)))) {
      _$jscoverage['plugins/table.action.js'][474]++;
      if ((h == "h1")) {
        _$jscoverage['plugins/table.action.js'][475]++;
        h = "h";
        _$jscoverage['plugins/table.action.js'][476]++;
        if (inTableSide(domUtils.findParentByTagName(target, "table"), target, evt)) {
          _$jscoverage['plugins/table.action.js'][477]++;
          me.execCommand("adaptbywindow");
        }
        else {
          _$jscoverage['plugins/table.action.js'][479]++;
          target = getUETable(target).getPreviewCell(target);
          _$jscoverage['plugins/table.action.js'][480]++;
          if (target) {
            _$jscoverage['plugins/table.action.js'][481]++;
            var rng = me.selection.getRange();
            _$jscoverage['plugins/table.action.js'][482]++;
            rng.selectNodeContents(target).setCursor(true, true);
          }
        }
      }
      _$jscoverage['plugins/table.action.js'][486]++;
      if ((h == "h")) {
        _$jscoverage['plugins/table.action.js'][487]++;
        var ut = getUETable(target), cells = ut.getSameEndPosCells(target, "x"), table = ut.table;
        _$jscoverage['plugins/table.action.js'][490]++;
        table.removeAttribute("width");
        _$jscoverage['plugins/table.action.js'][491]++;
        utils.each(cells, (function (cell) {
  _$jscoverage['plugins/table.action.js'][492]++;
  cell.removeAttribute("width");
}));
        _$jscoverage['plugins/table.action.js'][494]++;
        setTimeout((function () {
  _$jscoverage['plugins/table.action.js'][495]++;
  var width = (cells[0].offsetWidth - 20);
  _$jscoverage['plugins/table.action.js'][496]++;
  utils.each(cells, (function (cell) {
  _$jscoverage['plugins/table.action.js'][497]++;
  cell.setAttribute("width", width);
}));
  _$jscoverage['plugins/table.action.js'][499]++;
  table.setAttribute("width", table.offsetWidth);
}));
      }
    }
  }
});
}));
  _$jscoverage['plugins/table.action.js'][508]++;
  switchBorderColor(me, true);
}));
  _$jscoverage['plugins/table.action.js'][512]++;
  if (((! browser.ie) || (browser.ie && (browser.version > 7)))) {
    _$jscoverage['plugins/table.action.js'][513]++;
    domUtils.on(me.document, "mousemove", mouseMoveEvent);
  }
  _$jscoverage['plugins/table.action.js'][515]++;
  domUtils.on(me.document, "mouseout", (function (evt) {
  _$jscoverage['plugins/table.action.js'][516]++;
  var target = (evt.target || evt.srcElement);
  _$jscoverage['plugins/table.action.js'][517]++;
  if ((target.tagName == "TABLE")) {
    _$jscoverage['plugins/table.action.js'][518]++;
    toggleDraggableState(me, false, "", null);
  }
}));
  _$jscoverage['plugins/table.action.js'][521]++;
  me.addListener("interlacetable", (function (type, table, classList) {
  _$jscoverage['plugins/table.action.js'][522]++;
  if ((! table)) {
    _$jscoverage['plugins/table.action.js'][522]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][523]++;
  var me = this, rows = table.rows, len = rows.length, getClass = (function (list, index, repeat) {
  _$jscoverage['plugins/table.action.js'][527]++;
  return (list[index]? list[index]: (repeat? list[(index % list.length)]: ""));
});
  _$jscoverage['plugins/table.action.js'][529]++;
  for (var i = 0; (i < len); (i++)) {
    _$jscoverage['plugins/table.action.js'][530]++;
    rows[i].className = getClass((classList || me.options.classList), i, true);
}
}));
  _$jscoverage['plugins/table.action.js'][533]++;
  me.addListener("uninterlacetable", (function (type, table) {
  _$jscoverage['plugins/table.action.js'][534]++;
  if ((! table)) {
    _$jscoverage['plugins/table.action.js'][534]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][535]++;
  var me = this, rows = table.rows, len = rows.length;
  _$jscoverage['plugins/table.action.js'][538]++;
  for (var i = 0; (i < len); (i++)) {
    _$jscoverage['plugins/table.action.js'][539]++;
    rows[i].className = "";
}
}));
  _$jscoverage['plugins/table.action.js'][545]++;
  me.addListener("mousedown", mouseDownEvent);
  _$jscoverage['plugins/table.action.js'][546]++;
  me.addListener("mouseup", mouseUpEvent);
  _$jscoverage['plugins/table.action.js'][548]++;
  var currentRowIndex = 0;
  _$jscoverage['plugins/table.action.js'][549]++;
  me.addListener("mousedown", (function () {
  _$jscoverage['plugins/table.action.js'][550]++;
  currentRowIndex = 0;
}));
  _$jscoverage['plugins/table.action.js'][552]++;
  me.addListener("tabkeydown", (function () {
  _$jscoverage['plugins/table.action.js'][553]++;
  var range = this.selection.getRange(), common = range.getCommonAncestor(true, true), table = domUtils.findParentByTagName(common, "table");
  _$jscoverage['plugins/table.action.js'][556]++;
  if (table) {
    _$jscoverage['plugins/table.action.js'][557]++;
    if (domUtils.findParentByTagName(common, "caption", true)) {
      _$jscoverage['plugins/table.action.js'][558]++;
      var cell = domUtils.getElementsByTagName(table, "th td");
      _$jscoverage['plugins/table.action.js'][559]++;
      if ((cell && cell.length)) {
        _$jscoverage['plugins/table.action.js'][560]++;
        range.setStart(cell[0], 0).setCursor(false, true);
      }
    }
    else {
      _$jscoverage['plugins/table.action.js'][563]++;
      var cell = domUtils.findParentByTagName(common, ["td", "th"], true), ua = getUETable(cell);
      _$jscoverage['plugins/table.action.js'][565]++;
      currentRowIndex = ((cell.rowSpan > 1)? currentRowIndex: ua.getCellInfo(cell).rowIndex);
      _$jscoverage['plugins/table.action.js'][566]++;
      var nextCell = ua.getTabNextCell(cell, currentRowIndex);
      _$jscoverage['plugins/table.action.js'][567]++;
      if (nextCell) {
        _$jscoverage['plugins/table.action.js'][568]++;
        if (isEmptyBlock(nextCell)) {
          _$jscoverage['plugins/table.action.js'][569]++;
          range.setStart(nextCell, 0).setCursor(false, true);
        }
        else {
          _$jscoverage['plugins/table.action.js'][571]++;
          range.selectNodeContents(nextCell).select();
        }
      }
      else {
        _$jscoverage['plugins/table.action.js'][574]++;
        me.fireEvent("saveScene");
        _$jscoverage['plugins/table.action.js'][575]++;
        me.__hasEnterExecCommand = true;
        _$jscoverage['plugins/table.action.js'][576]++;
        this.execCommand("insertrownext");
        _$jscoverage['plugins/table.action.js'][577]++;
        me.__hasEnterExecCommand = false;
        _$jscoverage['plugins/table.action.js'][578]++;
        range = this.selection.getRange();
        _$jscoverage['plugins/table.action.js'][579]++;
        range.setStart(table.rows[(table.rows.length - 1)].cells[0], 0).setCursor();
        _$jscoverage['plugins/table.action.js'][580]++;
        me.fireEvent("saveScene");
      }
    }
    _$jscoverage['plugins/table.action.js'][583]++;
    return true;
  }
}));
  _$jscoverage['plugins/table.action.js'][587]++;
  (browser.ie && me.addListener("selectionchange", (function () {
  _$jscoverage['plugins/table.action.js'][588]++;
  toggleDraggableState(this, false, "", null);
})));
  _$jscoverage['plugins/table.action.js'][590]++;
  me.addListener("keydown", (function (type, evt) {
  _$jscoverage['plugins/table.action.js'][591]++;
  var me = this;
  _$jscoverage['plugins/table.action.js'][593]++;
  var keyCode = (evt.keyCode || evt.which);
  _$jscoverage['plugins/table.action.js'][594]++;
  if (((keyCode == 8) || (keyCode == 46))) {
    _$jscoverage['plugins/table.action.js'][595]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][597]++;
  var notCtrlKey = ((! evt.ctrlKey) && (! evt.metaKey) && (! evt.shiftKey) && (! evt.altKey));
  _$jscoverage['plugins/table.action.js'][598]++;
  (notCtrlKey && removeSelectedClass(domUtils.getElementsByTagName(me.body, "td")));
  _$jscoverage['plugins/table.action.js'][599]++;
  var ut = getUETableBySelected(me);
  _$jscoverage['plugins/table.action.js'][600]++;
  if ((! ut)) {
    _$jscoverage['plugins/table.action.js'][600]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][601]++;
  (notCtrlKey && ut.clearSelected());
}));
  _$jscoverage['plugins/table.action.js'][604]++;
  me.addListener("beforegetcontent", (function () {
  _$jscoverage['plugins/table.action.js'][605]++;
  switchBorderColor(this, false);
  _$jscoverage['plugins/table.action.js'][606]++;
  (browser.ie && utils.each(this.document.getElementsByTagName("caption"), (function (ci) {
  _$jscoverage['plugins/table.action.js'][607]++;
  if (domUtils.isEmptyNode(ci)) {
    _$jscoverage['plugins/table.action.js'][608]++;
    ci.innerHTML = "&nbsp;";
  }
})));
}));
  _$jscoverage['plugins/table.action.js'][612]++;
  me.addListener("aftergetcontent", (function () {
  _$jscoverage['plugins/table.action.js'][613]++;
  switchBorderColor(this, true);
}));
  _$jscoverage['plugins/table.action.js'][615]++;
  me.addListener("getAllHtml", (function () {
  _$jscoverage['plugins/table.action.js'][616]++;
  removeSelectedClass(me.document.getElementsByTagName("td"));
}));
  _$jscoverage['plugins/table.action.js'][619]++;
  me.addListener("fullscreenchanged", (function (type, fullscreen) {
  _$jscoverage['plugins/table.action.js'][620]++;
  if ((! fullscreen)) {
    _$jscoverage['plugins/table.action.js'][621]++;
    var ratio = (this.body.offsetWidth / document.body.offsetWidth), tables = domUtils.getElementsByTagName(this.body, "table");
    _$jscoverage['plugins/table.action.js'][623]++;
    utils.each(tables, (function (table) {
  _$jscoverage['plugins/table.action.js'][624]++;
  if ((table.offsetWidth < me.body.offsetWidth)) {
    _$jscoverage['plugins/table.action.js'][624]++;
    return false;
  }
  _$jscoverage['plugins/table.action.js'][625]++;
  var tds = domUtils.getElementsByTagName(table, "td"), backWidths = [];
  _$jscoverage['plugins/table.action.js'][627]++;
  utils.each(tds, (function (td) {
  _$jscoverage['plugins/table.action.js'][628]++;
  backWidths.push(td.offsetWidth);
}));
  _$jscoverage['plugins/table.action.js'][630]++;
  for (var i = 0, td; (td = tds[i]); (i++)) {
    _$jscoverage['plugins/table.action.js'][631]++;
    td.setAttribute("width", Math.floor((backWidths[i] * ratio)));
}
  _$jscoverage['plugins/table.action.js'][633]++;
  table.setAttribute("width", Math.floor(getTableWidth(me, needIEHack, getDefaultValue(me))));
}));
  }
}));
  _$jscoverage['plugins/table.action.js'][639]++;
  var oldExecCommand = me.execCommand;
  _$jscoverage['plugins/table.action.js'][640]++;
  me.execCommand = (function (cmd) {
  _$jscoverage['plugins/table.action.js'][641]++;
  var me = this;
  _$jscoverage['plugins/table.action.js'][642]++;
  cmd = cmd.toLowerCase();
  _$jscoverage['plugins/table.action.js'][643]++;
  var ut = getUETableBySelected(me), tds, range = new (dom.Range)(me.document), cmdFun = (me.commands[cmd] || UE.commands[cmd]), result;
  _$jscoverage['plugins/table.action.js'][647]++;
  if ((! cmdFun)) {
    _$jscoverage['plugins/table.action.js'][647]++;
    return;
  }
  _$jscoverage['plugins/table.action.js'][648]++;
  if ((ut && (! commands[cmd]) && (! cmdFun.notNeedUndo) && (! me.__hasEnterExecCommand))) {
    _$jscoverage['plugins/table.action.js'][649]++;
    me.__hasEnterExecCommand = true;
    _$jscoverage['plugins/table.action.js'][650]++;
    me.fireEvent("beforeexeccommand", cmd);
    _$jscoverage['plugins/table.action.js'][651]++;
    tds = ut.selectedTds;
    _$jscoverage['plugins/table.action.js'][652]++;
    var lastState = -2, lastValue = -2, value, state;
    _$jscoverage['plugins/table.action.js'][653]++;
    for (var i = 0, td; (td = tds[i]); (i++)) {
      _$jscoverage['plugins/table.action.js'][654]++;
      if (isEmptyBlock(td)) {
        _$jscoverage['plugins/table.action.js'][655]++;
        range.setStart(td, 0).setCursor(false, true);
      }
      else {
        _$jscoverage['plugins/table.action.js'][657]++;
        range.selectNodeContents(td).select(true);
      }
      _$jscoverage['plugins/table.action.js'][659]++;
      state = me.queryCommandState(cmd);
      _$jscoverage['plugins/table.action.js'][660]++;
      value = me.queryCommandValue(cmd);
      _$jscoverage['plugins/table.action.js'][661]++;
      if ((state != -1)) {
        _$jscoverage['plugins/table.action.js'][662]++;
        if (((lastState !== state) || (lastValue !== value))) {
          _$jscoverage['plugins/table.action.js'][663]++;
          me._ignoreContentChange = true;
          _$jscoverage['plugins/table.action.js'][664]++;
          result = oldExecCommand.apply(me, arguments);
          _$jscoverage['plugins/table.action.js'][665]++;
          me._ignoreContentChange = false;
        }
        _$jscoverage['plugins/table.action.js'][668]++;
        lastState = me.queryCommandState(cmd);
        _$jscoverage['plugins/table.action.js'][669]++;
        lastValue = me.queryCommandValue(cmd);
        _$jscoverage['plugins/table.action.js'][670]++;
        if (domUtils.isEmptyBlock(td)) {
          _$jscoverage['plugins/table.action.js'][671]++;
          domUtils.fillNode(me.document, td);
        }
      }
}
    _$jscoverage['plugins/table.action.js'][675]++;
    range.setStart(tds[0], 0).shrinkBoundary(true).setCursor(false, true);
    _$jscoverage['plugins/table.action.js'][676]++;
    me.fireEvent("contentchange");
    _$jscoverage['plugins/table.action.js'][677]++;
    me.fireEvent("afterexeccommand", cmd);
    _$jscoverage['plugins/table.action.js'][678]++;
    me.__hasEnterExecCommand = false;
    _$jscoverage['plugins/table.action.js'][679]++;
    me._selectionChange();
  }
  else {
    _$jscoverage['plugins/table.action.js'][681]++;
    result = oldExecCommand.apply(me, arguments);
  }
  _$jscoverage['plugins/table.action.js'][683]++;
  return result;
});
}));
  _$jscoverage['plugins/table.action.js'][693]++;
  function removeStyleSize(obj, replaceToProperty) {
    _$jscoverage['plugins/table.action.js'][694]++;
    removeStyle(obj, "width", true);
    _$jscoverage['plugins/table.action.js'][695]++;
    removeStyle(obj, "height", true);
}
  _$jscoverage['plugins/table.action.js'][698]++;
  function removeStyle(obj, styleName, replaceToProperty) {
    _$jscoverage['plugins/table.action.js'][699]++;
    if (obj.style[styleName]) {
      _$jscoverage['plugins/table.action.js'][700]++;
      (replaceToProperty && obj.setAttribute(styleName, parseInt(obj.style[styleName], 10)));
      _$jscoverage['plugins/table.action.js'][701]++;
      obj.style[styleName] = "";
    }
}
  _$jscoverage['plugins/table.action.js'][705]++;
  function getParentTdOrTh(ele) {
    _$jscoverage['plugins/table.action.js'][706]++;
    if (((ele.tagName == "TD") || (ele.tagName == "TH"))) {
      _$jscoverage['plugins/table.action.js'][706]++;
      return ele;
    }
    _$jscoverage['plugins/table.action.js'][707]++;
    var td;
    _$jscoverage['plugins/table.action.js'][708]++;
    if ((td = (domUtils.findParentByTagName(ele, "td", true) || domUtils.findParentByTagName(ele, "th", true)))) {
      _$jscoverage['plugins/table.action.js'][708]++;
      return td;
    }
    _$jscoverage['plugins/table.action.js'][709]++;
    return null;
}
  _$jscoverage['plugins/table.action.js'][712]++;
  function isEmptyBlock(node) {
    _$jscoverage['plugins/table.action.js'][713]++;
    var reg = new RegExp(domUtils.fillChar, "g");
    _$jscoverage['plugins/table.action.js'][714]++;
    if ((node[(browser.ie? "innerText": "textContent")].replace(/^\s*$/, "").replace(reg, "").length > 0)) {
      _$jscoverage['plugins/table.action.js'][715]++;
      return 0;
    }
    _$jscoverage['plugins/table.action.js'][717]++;
    for (var n in dtd.$isNotEmpty) {
      _$jscoverage['plugins/table.action.js'][718]++;
      if (node.getElementsByTagName(n).length) {
        _$jscoverage['plugins/table.action.js'][719]++;
        return 0;
      }
}
    _$jscoverage['plugins/table.action.js'][722]++;
    return 1;
}
  _$jscoverage['plugins/table.action.js'][726]++;
  function mouseCoords(evt) {
    _$jscoverage['plugins/table.action.js'][727]++;
    if ((evt.pageX || evt.pageY)) {
      _$jscoverage['plugins/table.action.js'][728]++;
      return ({x: evt.pageX, y: evt.pageY});
    }
    _$jscoverage['plugins/table.action.js'][730]++;
    return ({x: ((evt.clientX + me.document.body.scrollLeft) - me.document.body.clientLeft), y: ((evt.clientY + me.document.body.scrollTop) - me.document.body.clientTop)});
}
  _$jscoverage['plugins/table.action.js'][736]++;
  function mouseMoveEvent(evt) {
    _$jscoverage['plugins/table.action.js'][737]++;
    try {
      _$jscoverage['plugins/table.action.js'][739]++;
      var target = getParentTdOrTh((evt.target || evt.srcElement)), pos;
      _$jscoverage['plugins/table.action.js'][742]++;
      if ((onDrag && dragTd)) {
        _$jscoverage['plugins/table.action.js'][743]++;
        me.document.body.style.webkitUserSelect = "none";
        _$jscoverage['plugins/table.action.js'][744]++;
        (me.selection.getNative()[(browser.ie? "empty": "removeAllRanges")])();
        _$jscoverage['plugins/table.action.js'][745]++;
        pos = mouseCoords(evt);
        _$jscoverage['plugins/table.action.js'][746]++;
        toggleDraggableState(me, true, "", pos, target);
        _$jscoverage['plugins/table.action.js'][747]++;
        if ((onDrag == "h")) {
          _$jscoverage['plugins/table.action.js'][748]++;
          dragLine.style.left = (getPermissionX(dragTd, evt) + "px");
        }
        else {
          _$jscoverage['plugins/table.action.js'][749]++;
          if ((onDrag == "v")) {
            _$jscoverage['plugins/table.action.js'][750]++;
            dragLine.style.top = (getPermissionY(dragTd, evt) + "px");
          }
        }
        _$jscoverage['plugins/table.action.js'][752]++;
        return;
      }
      _$jscoverage['plugins/table.action.js'][755]++;
      if (target) {
        _$jscoverage['plugins/table.action.js'][757]++;
        if ((me.fireEvent("excludetable", target) === true)) {
          _$jscoverage['plugins/table.action.js'][758]++;
          return;
        }
        _$jscoverage['plugins/table.action.js'][759]++;
        pos = mouseCoords(evt);
        _$jscoverage['plugins/table.action.js'][760]++;
        var state = getRelation(target, pos), table = domUtils.findParentByTagName(target, "table", true);
        _$jscoverage['plugins/table.action.js'][763]++;
        if (inTableSide(table, target, evt, true)) {
          _$jscoverage['plugins/table.action.js'][765]++;
          if ((me.fireEvent("excludetable", table) === true)) {
            _$jscoverage['plugins/table.action.js'][765]++;
            return;
          }
          _$jscoverage['plugins/table.action.js'][766]++;
          me.body.style.cursor = ("url(" + me.options.cursorpath + "h.png),pointer");
        }
        else {
          _$jscoverage['plugins/table.action.js'][767]++;
          if (inTableSide(table, target, evt)) {
            _$jscoverage['plugins/table.action.js'][769]++;
            if ((me.fireEvent("excludetable", table) === true)) {
              _$jscoverage['plugins/table.action.js'][769]++;
              return;
            }
            _$jscoverage['plugins/table.action.js'][770]++;
            me.body.style.cursor = ("url(" + me.options.cursorpath + "v.png),pointer");
          }
          else {
            _$jscoverage['plugins/table.action.js'][773]++;
            me.body.style.cursor = "text";
            _$jscoverage['plugins/table.action.js'][774]++;
            if (/\d/.test(state)) {
              _$jscoverage['plugins/table.action.js'][775]++;
              state = state.replace(/\d/, "");
              _$jscoverage['plugins/table.action.js'][776]++;
              target = getUETable(target).getPreviewCell(target, (state == "v"));
            }
            _$jscoverage['plugins/table.action.js'][779]++;
            toggleDraggableState(me, (target? (! (! state)): false), (target? state: ""), pos, target);
          }
        }
      }
      else {
        _$jscoverage['plugins/table.action.js'][783]++;
        toggleDragButton(false, table, me);
      }
    }
    catch (e) {
      _$jscoverage['plugins/table.action.js'][787]++;
      showError(e);
    }
}
  _$jscoverage['plugins/table.action.js'][791]++;
  var dragButtonTimer;
  _$jscoverage['plugins/table.action.js'][793]++;
  function toggleDragButton(show, table, editor) {
    _$jscoverage['plugins/table.action.js'][794]++;
    if ((! show)) {
      _$jscoverage['plugins/table.action.js'][795]++;
      if (dragOver) {
        _$jscoverage['plugins/table.action.js'][795]++;
        return;
      }
      _$jscoverage['plugins/table.action.js'][796]++;
      dragButtonTimer = setTimeout((function () {
  _$jscoverage['plugins/table.action.js'][797]++;
  ((! dragOver) && dragButton && dragButton.parentNode && dragButton.parentNode.removeChild(dragButton));
}), 2000);
    }
    else {
      _$jscoverage['plugins/table.action.js'][800]++;
      createDragButton(table, editor);
    }
}
  _$jscoverage['plugins/table.action.js'][804]++;
  function createDragButton(table, editor) {
    _$jscoverage['plugins/table.action.js'][805]++;
    var pos = domUtils.getXY(table), doc = table.ownerDocument;
    _$jscoverage['plugins/table.action.js'][807]++;
    if ((dragButton && dragButton.parentNode)) {
      _$jscoverage['plugins/table.action.js'][807]++;
      return dragButton;
    }
    _$jscoverage['plugins/table.action.js'][808]++;
    dragButton = doc.createElement("div");
    _$jscoverage['plugins/table.action.js'][809]++;
    dragButton.contentEditable = false;
    _$jscoverage['plugins/table.action.js'][810]++;
    dragButton.innerHTML = "";
    _$jscoverage['plugins/table.action.js'][811]++;
    dragButton.style.cssText = ("width:15px;height:15px;background-image:url(" + editor.options.UEDITOR_HOME_URL + "dialogs/table/dragicon.png);position: absolute;cursor:move;top:" + (pos.y - 15) + "px;left:" + pos.x + "px;");
    _$jscoverage['plugins/table.action.js'][812]++;
    domUtils.unSelectable(dragButton);
    _$jscoverage['plugins/table.action.js'][813]++;
    dragButton.onmouseover = (function (evt) {
  _$jscoverage['plugins/table.action.js'][814]++;
  dragOver = true;
});
    _$jscoverage['plugins/table.action.js'][816]++;
    dragButton.onmouseout = (function (evt) {
  _$jscoverage['plugins/table.action.js'][817]++;
  dragOver = false;
});
    _$jscoverage['plugins/table.action.js'][819]++;
    domUtils.on(dragButton, "click", (function (type, evt) {
  _$jscoverage['plugins/table.action.js'][820]++;
  doClick(evt, this);
}));
    _$jscoverage['plugins/table.action.js'][822]++;
    domUtils.on(dragButton, "dblclick", (function (type, evt) {
  _$jscoverage['plugins/table.action.js'][823]++;
  doDblClick(evt);
}));
    _$jscoverage['plugins/table.action.js'][825]++;
    domUtils.on(dragButton, "dragstart", (function (type, evt) {
  _$jscoverage['plugins/table.action.js'][826]++;
  domUtils.preventDefault(evt);
}));
    _$jscoverage['plugins/table.action.js'][828]++;
    var timer;
    _$jscoverage['plugins/table.action.js'][830]++;
    function doClick(evt, button) {
      _$jscoverage['plugins/table.action.js'][832]++;
      clearTimeout(timer);
      _$jscoverage['plugins/table.action.js'][833]++;
      timer = setTimeout((function () {
  _$jscoverage['plugins/table.action.js'][834]++;
  editor.fireEvent("tableClicked", table, button);
}), 300);
}
    _$jscoverage['plugins/table.action.js'][838]++;
    function doDblClick(evt) {
      _$jscoverage['plugins/table.action.js'][839]++;
      clearTimeout(timer);
      _$jscoverage['plugins/table.action.js'][840]++;
      var ut = getUETable(table), start = table.rows[0].cells[0], end = ut.getLastCell(), range = ut.getCellsRange(start, end);
      _$jscoverage['plugins/table.action.js'][844]++;
      editor.selection.getRange().setStart(start, 0).setCursor(false, true);
      _$jscoverage['plugins/table.action.js'][845]++;
      ut.setSelected(range);
}
    _$jscoverage['plugins/table.action.js'][848]++;
    doc.body.appendChild(dragButton);
}
  _$jscoverage['plugins/table.action.js'][863]++;
  function inTableSide(table, cell, evt, top) {
    _$jscoverage['plugins/table.action.js'][864]++;
    var pos = mouseCoords(evt), state = getRelation(cell, pos);
    _$jscoverage['plugins/table.action.js'][866]++;
    if (top) {
      _$jscoverage['plugins/table.action.js'][867]++;
      var caption = table.getElementsByTagName("caption")[0], capHeight = (caption? caption.offsetHeight: 0);
      _$jscoverage['plugins/table.action.js'][869]++;
      return ((state == "v1") && ((pos.y - domUtils.getXY(table).y - capHeight) < 8));
    }
    else {
      _$jscoverage['plugins/table.action.js'][871]++;
      return ((state == "h1") && ((pos.x - domUtils.getXY(table).x) < 8));
    }
}
  _$jscoverage['plugins/table.action.js'][880]++;
  function getPermissionX(dragTd, evt) {
    _$jscoverage['plugins/table.action.js'][881]++;
    var ut = getUETable(dragTd);
    _$jscoverage['plugins/table.action.js'][882]++;
    if (ut) {
      _$jscoverage['plugins/table.action.js'][883]++;
      var preTd = ut.getSameEndPosCells(dragTd, "x")[0], nextTd = ut.getSameStartPosXCells(dragTd)[0], mouseX = mouseCoords(evt).x, left = ((preTd? domUtils.getXY(preTd).x: domUtils.getXY(ut.table).x) + 20), right = (nextTd? ((domUtils.getXY(nextTd).x + nextTd.offsetWidth) - 20): ((me.body.offsetWidth + 5) || parseInt(domUtils.getComputedStyle(me.body, "width"), 10)));
      _$jscoverage['plugins/table.action.js'][888]++;
      return ((mouseX < left)? left: ((mouseX > right)? right: mouseX));
    }
}
  _$jscoverage['plugins/table.action.js'][895]++;
  function getPermissionY(dragTd, evt) {
    _$jscoverage['plugins/table.action.js'][896]++;
    try {
      _$jscoverage['plugins/table.action.js'][897]++;
      var top = domUtils.getXY(dragTd).y, mousePosY = mouseCoords(evt).y;
      _$jscoverage['plugins/table.action.js'][899]++;
      return ((mousePosY < top)? top: mousePosY);
    }
    catch (e) {
      _$jscoverage['plugins/table.action.js'][901]++;
      showError(e);
    }
}
  _$jscoverage['plugins/table.action.js'][908]++;
  function toggleDraggableState(editor, draggable, dir, mousePos, cell) {
    _$jscoverage['plugins/table.action.js'][909]++;
    try {
      _$jscoverage['plugins/table.action.js'][910]++;
      editor.body.style.cursor = ((dir == "h")? "col-resize": ((dir == "v")? "row-resize": "text"));
      _$jscoverage['plugins/table.action.js'][911]++;
      if (browser.ie) {
        _$jscoverage['plugins/table.action.js'][912]++;
        if ((dir && (! mousedown) && (! getUETableBySelected(editor)))) {
          _$jscoverage['plugins/table.action.js'][913]++;
          getDragLine(editor, editor.document);
          _$jscoverage['plugins/table.action.js'][914]++;
          showDragLineAt(dir, cell);
        }
        else {
          _$jscoverage['plugins/table.action.js'][916]++;
          hideDragLine(editor);
        }
      }
      _$jscoverage['plugins/table.action.js'][919]++;
      onBorder = draggable;
    }
    catch (e) {
      _$jscoverage['plugins/table.action.js'][921]++;
      showError(e);
    }
}
  _$jscoverage['plugins/table.action.js'][930]++;
  function getRelation(ele, mousePos) {
    _$jscoverage['plugins/table.action.js'][931]++;
    var elePos = domUtils.getXY(ele);
    _$jscoverage['plugins/table.action.js'][932]++;
    if ((((elePos.x + ele.offsetWidth) - mousePos.x) < 4)) {
      _$jscoverage['plugins/table.action.js'][933]++;
      return "h";
    }
    _$jscoverage['plugins/table.action.js'][935]++;
    if (((mousePos.x - elePos.x) < 4)) {
      _$jscoverage['plugins/table.action.js'][936]++;
      return "h1";
    }
    _$jscoverage['plugins/table.action.js'][938]++;
    if ((((elePos.y + ele.offsetHeight) - mousePos.y) < 4)) {
      _$jscoverage['plugins/table.action.js'][939]++;
      return "v";
    }
    _$jscoverage['plugins/table.action.js'][941]++;
    if (((mousePos.y - elePos.y) < 4)) {
      _$jscoverage['plugins/table.action.js'][942]++;
      return "v1";
    }
    _$jscoverage['plugins/table.action.js'][944]++;
    return "";
}
  _$jscoverage['plugins/table.action.js'][947]++;
  function mouseDownEvent(type, evt) {
    _$jscoverage['plugins/table.action.js'][949]++;
    if ((evt.button == 2)) {
      _$jscoverage['plugins/table.action.js'][950]++;
      var ut = getUETableBySelected(me), flag = false;
      _$jscoverage['plugins/table.action.js'][952]++;
      if (ut) {
        _$jscoverage['plugins/table.action.js'][953]++;
        var td = getTargetTd(me, evt);
        _$jscoverage['plugins/table.action.js'][954]++;
        utils.each(ut.selectedTds, (function (ti) {
  _$jscoverage['plugins/table.action.js'][955]++;
  if ((ti === td)) {
    _$jscoverage['plugins/table.action.js'][956]++;
    flag = true;
  }
}));
        _$jscoverage['plugins/table.action.js'][959]++;
        if ((! flag)) {
          _$jscoverage['plugins/table.action.js'][960]++;
          removeSelectedClass(domUtils.getElementsByTagName(me.body, "td"));
          _$jscoverage['plugins/table.action.js'][961]++;
          removeSelectedClass(domUtils.getElementsByTagName(me.body, "th"));
          _$jscoverage['plugins/table.action.js'][962]++;
          ut.clearSelected();
        }
        else {
          _$jscoverage['plugins/table.action.js'][964]++;
          td = ut.selectedTds[0];
          _$jscoverage['plugins/table.action.js'][965]++;
          setTimeout((function () {
  _$jscoverage['plugins/table.action.js'][966]++;
  me.selection.getRange().setStart(td, 0).setCursor(false, true);
}), 0);
        }
      }
      _$jscoverage['plugins/table.action.js'][972]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][974]++;
    if (evt.shiftKey) {
      _$jscoverage['plugins/table.action.js'][975]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][978]++;
    removeSelectedClass(domUtils.getElementsByTagName(me.body, "td"));
    _$jscoverage['plugins/table.action.js'][979]++;
    removeSelectedClass(domUtils.getElementsByTagName(me.body, "th"));
    _$jscoverage['plugins/table.action.js'][982]++;
    utils.each(me.document.getElementsByTagName("table"), (function (t) {
  _$jscoverage['plugins/table.action.js'][983]++;
  t.ueTable = null;
}));
    _$jscoverage['plugins/table.action.js'][985]++;
    startTd = getTargetTd(me, evt);
    _$jscoverage['plugins/table.action.js'][986]++;
    if ((! startTd)) {
      _$jscoverage['plugins/table.action.js'][986]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][987]++;
    var table = domUtils.findParentByTagName(startTd, "table", true);
    _$jscoverage['plugins/table.action.js'][988]++;
    ut = getUETable(table);
    _$jscoverage['plugins/table.action.js'][989]++;
    (ut && ut.clearSelected());
    _$jscoverage['plugins/table.action.js'][991]++;
    if ((! onBorder)) {
      _$jscoverage['plugins/table.action.js'][992]++;
      me.document.body.style.webkitUserSelect = "";
      _$jscoverage['plugins/table.action.js'][993]++;
      mousedown = true;
      _$jscoverage['plugins/table.action.js'][994]++;
      me.addListener("mouseover", mouseOverEvent);
    }
    else {
      _$jscoverage['plugins/table.action.js'][996]++;
      if ((browser.ie && (browser.version < 8))) {
        _$jscoverage['plugins/table.action.js'][996]++;
        return;
      }
      _$jscoverage['plugins/table.action.js'][997]++;
      var state = getRelation(startTd, mouseCoords(evt));
      _$jscoverage['plugins/table.action.js'][998]++;
      if (/\d/.test(state)) {
        _$jscoverage['plugins/table.action.js'][999]++;
        state = state.replace(/\d/, "");
        _$jscoverage['plugins/table.action.js'][1000]++;
        startTd = getUETable(startTd).getPreviewCell(startTd, (state == "v"));
      }
      _$jscoverage['plugins/table.action.js'][1002]++;
      hideDragLine(me);
      _$jscoverage['plugins/table.action.js'][1003]++;
      getDragLine(me, me.document);
      _$jscoverage['plugins/table.action.js'][1004]++;
      showDragLineAt(state, startTd);
      _$jscoverage['plugins/table.action.js'][1005]++;
      mousedown = true;
      _$jscoverage['plugins/table.action.js'][1007]++;
      onDrag = state;
      _$jscoverage['plugins/table.action.js'][1008]++;
      dragTd = startTd;
    }
}
  _$jscoverage['plugins/table.action.js'][1012]++;
  function mouseUpEvent(type, evt) {
    _$jscoverage['plugins/table.action.js'][1013]++;
    if ((evt.button == 2)) {
      _$jscoverage['plugins/table.action.js'][1013]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1014]++;
    var me = this;
    _$jscoverage['plugins/table.action.js'][1016]++;
    var range = me.selection.getRange(), start = domUtils.findParentByTagName(range.startContainer, "table", true), end = domUtils.findParentByTagName(range.endContainer, "table", true);
    _$jscoverage['plugins/table.action.js'][1020]++;
    if ((start || end)) {
      _$jscoverage['plugins/table.action.js'][1021]++;
      if ((start === end)) {
        _$jscoverage['plugins/table.action.js'][1022]++;
        start = domUtils.findParentByTagName(range.startContainer, ["td", "th", "caption"], true);
        _$jscoverage['plugins/table.action.js'][1023]++;
        end = domUtils.findParentByTagName(range.endContainer, ["td", "th", "caption"], true);
        _$jscoverage['plugins/table.action.js'][1024]++;
        if ((start !== end)) {
          _$jscoverage['plugins/table.action.js'][1025]++;
          me.selection.clearRange();
        }
      }
      else {
        _$jscoverage['plugins/table.action.js'][1028]++;
        me.selection.clearRange();
      }
    }
    _$jscoverage['plugins/table.action.js'][1031]++;
    mousedown = false;
    _$jscoverage['plugins/table.action.js'][1032]++;
    me.document.body.style.webkitUserSelect = "";
    _$jscoverage['plugins/table.action.js'][1034]++;
    if ((((! browser.ie) || (browser.ie && (browser.version > 7))) && onDrag && dragTd)) {
      _$jscoverage['plugins/table.action.js'][1035]++;
      dragLine = me.document.getElementById("ue_tableDragLine");
      _$jscoverage['plugins/table.action.js'][1036]++;
      var dragTdPos = domUtils.getXY(dragTd), dragLinePos = domUtils.getXY(dragLine);
      _$jscoverage['plugins/table.action.js'][1038]++;
      switch (onDrag) {
      case "h":
        _$jscoverage['plugins/table.action.js'][1040]++;
        changeColWidth(dragTd, (dragLinePos.x - dragTdPos.x - dragTd.offsetWidth));
        _$jscoverage['plugins/table.action.js'][1041]++;
        break;
      case "v":
        _$jscoverage['plugins/table.action.js'][1043]++;
        changeRowHeight(dragTd, (dragLinePos.y - dragTdPos.y - dragTd.offsetHeight));
        _$jscoverage['plugins/table.action.js'][1044]++;
        break;
      default:
      }
      _$jscoverage['plugins/table.action.js'][1047]++;
      onDrag = "";
      _$jscoverage['plugins/table.action.js'][1048]++;
      dragTd = null;
      _$jscoverage['plugins/table.action.js'][1050]++;
      hideDragLine(me);
      _$jscoverage['plugins/table.action.js'][1051]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1054]++;
    if ((! startTd)) {
      _$jscoverage['plugins/table.action.js'][1055]++;
      var target = domUtils.findParentByTagName((evt.target || evt.srcElement), "td", true);
      _$jscoverage['plugins/table.action.js'][1056]++;
      if ((! target)) {
        _$jscoverage['plugins/table.action.js'][1056]++;
        target = domUtils.findParentByTagName((evt.target || evt.srcElement), "th", true);
      }
      _$jscoverage['plugins/table.action.js'][1057]++;
      if ((target && ((target.tagName == "TD") || (target.tagName == "TH")))) {
        _$jscoverage['plugins/table.action.js'][1058]++;
        if ((me.fireEvent("excludetable", target) === true)) {
          _$jscoverage['plugins/table.action.js'][1058]++;
          return;
        }
        _$jscoverage['plugins/table.action.js'][1059]++;
        range = new (dom.Range)(me.document);
        _$jscoverage['plugins/table.action.js'][1060]++;
        range.setStart(target, 0).setCursor(false, true);
      }
    }
    else {
      _$jscoverage['plugins/table.action.js'][1063]++;
      var ut = getUETable(startTd), cell = (ut? ut.selectedTds[0]: null);
      _$jscoverage['plugins/table.action.js'][1065]++;
      if (cell) {
        _$jscoverage['plugins/table.action.js'][1066]++;
        range = new (dom.Range)(me.document);
        _$jscoverage['plugins/table.action.js'][1067]++;
        if (domUtils.isEmptyBlock(cell)) {
          _$jscoverage['plugins/table.action.js'][1068]++;
          range.setStart(cell, 0).setCursor(false, true);
        }
        else {
          _$jscoverage['plugins/table.action.js'][1070]++;
          range.selectNodeContents(cell).shrinkBoundary().setCursor(false, true);
        }
      }
      else {
        _$jscoverage['plugins/table.action.js'][1073]++;
        range = me.selection.getRange().shrinkBoundary();
        _$jscoverage['plugins/table.action.js'][1074]++;
        if ((! range.collapsed)) {
          _$jscoverage['plugins/table.action.js'][1075]++;
          var start = domUtils.findParentByTagName(range.startContainer, ["td", "th"], true), end = domUtils.findParentByTagName(range.endContainer, ["td", "th"], true);
          _$jscoverage['plugins/table.action.js'][1078]++;
          if (((start && (! end)) || ((! start) && end) || (start && end && (start !== end)))) {
            _$jscoverage['plugins/table.action.js'][1079]++;
            range.setCursor(false, true);
          }
        }
      }
      _$jscoverage['plugins/table.action.js'][1083]++;
      startTd = null;
      _$jscoverage['plugins/table.action.js'][1084]++;
      me.removeListener("mouseover", mouseOverEvent);
    }
    _$jscoverage['plugins/table.action.js'][1086]++;
    me._selectionChange(250, evt);
}
  _$jscoverage['plugins/table.action.js'][1089]++;
  function mouseOverEvent(type, evt) {
    _$jscoverage['plugins/table.action.js'][1090]++;
    var me = this, tar = (evt.target || evt.srcElement);
    _$jscoverage['plugins/table.action.js'][1092]++;
    currentTd = (domUtils.findParentByTagName(tar, "td", true) || domUtils.findParentByTagName(tar, "th", true));
    _$jscoverage['plugins/table.action.js'][1094]++;
    if ((startTd && currentTd && (((startTd.tagName == "TD") && (currentTd.tagName == "TD")) || ((startTd.tagName == "TH") && (currentTd.tagName == "TH"))) && (domUtils.findParentByTagName(startTd, "table") == domUtils.findParentByTagName(currentTd, "table")))) {
      _$jscoverage['plugins/table.action.js'][1097]++;
      var ut = getUETable(currentTd);
      _$jscoverage['plugins/table.action.js'][1098]++;
      if ((startTd != currentTd)) {
        _$jscoverage['plugins/table.action.js'][1099]++;
        me.document.body.style.webkitUserSelect = "none";
        _$jscoverage['plugins/table.action.js'][1100]++;
        (me.selection.getNative()[(browser.ie? "empty": "removeAllRanges")])();
        _$jscoverage['plugins/table.action.js'][1101]++;
        var range = ut.getCellsRange(startTd, currentTd);
        _$jscoverage['plugins/table.action.js'][1102]++;
        ut.setSelected(range);
      }
      else {
        _$jscoverage['plugins/table.action.js'][1104]++;
        me.document.body.style.webkitUserSelect = "";
        _$jscoverage['plugins/table.action.js'][1105]++;
        ut.clearSelected();
      }
    }
    _$jscoverage['plugins/table.action.js'][1109]++;
    (evt.preventDefault? evt.preventDefault(): (evt.returnValue = false));
}
  _$jscoverage['plugins/table.action.js'][1112]++;
  function setCellHeight(cell, height, backHeight) {
    _$jscoverage['plugins/table.action.js'][1113]++;
    var lineHight = parseInt(domUtils.getComputedStyle(cell, "line-height"), 10), tmpHeight = (backHeight + height);
    _$jscoverage['plugins/table.action.js'][1115]++;
    height = ((tmpHeight < lineHight)? lineHight: tmpHeight);
    _$jscoverage['plugins/table.action.js'][1116]++;
    if (cell.style.height) {
      _$jscoverage['plugins/table.action.js'][1116]++;
      cell.style.height = "";
    }
    _$jscoverage['plugins/table.action.js'][1117]++;
    ((cell.rowSpan == 1)? cell.setAttribute("height", height): (cell.removeAttribute && cell.removeAttribute("height")));
}
  _$jscoverage['plugins/table.action.js'][1120]++;
  function getWidth(cell) {
    _$jscoverage['plugins/table.action.js'][1121]++;
    if ((! cell)) {
      _$jscoverage['plugins/table.action.js'][1121]++;
      return 0;
    }
    _$jscoverage['plugins/table.action.js'][1122]++;
    return parseInt(domUtils.getComputedStyle(cell, "width"), 10);
}
  _$jscoverage['plugins/table.action.js'][1125]++;
  function changeColWidth(cell, changeValue) {
    _$jscoverage['plugins/table.action.js'][1126]++;
    if ((Math.abs(changeValue) < 10)) {
      _$jscoverage['plugins/table.action.js'][1126]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1127]++;
    var ut = getUETable(cell);
    _$jscoverage['plugins/table.action.js'][1128]++;
    if (ut) {
      _$jscoverage['plugins/table.action.js'][1129]++;
      var table = ut.table, backTableWidth = getWidth(table), defaultValue = getDefaultValue(me, table), leftCells = ut.getSameEndPosCells(cell, "x"), backLeftWidth = (getWidth(leftCells[0]) - (defaultValue.tdPadding * 2) - defaultValue.tdBorder), rightCells = ut.getSameStartPosXCells(cell), backRightWidth = (getWidth(rightCells[0]) - (defaultValue.tdPadding * 2) - defaultValue.tdBorder);
      _$jscoverage['plugins/table.action.js'][1138]++;
      utils.each(leftCells, (function (cell) {
  _$jscoverage['plugins/table.action.js'][1139]++;
  if (cell.style.width) {
    _$jscoverage['plugins/table.action.js'][1139]++;
    cell.style.width = "";
  }
  _$jscoverage['plugins/table.action.js'][1140]++;
  if ((changeValue < 0)) {
    _$jscoverage['plugins/table.action.js'][1140]++;
    cell.style.wordBreak = "break-all";
  }
  _$jscoverage['plugins/table.action.js'][1141]++;
  cell.setAttribute("width", (backLeftWidth + changeValue));
}));
      _$jscoverage['plugins/table.action.js'][1143]++;
      utils.each(rightCells, (function (cell) {
  _$jscoverage['plugins/table.action.js'][1144]++;
  if (cell.style.width) {
    _$jscoverage['plugins/table.action.js'][1144]++;
    cell.style.width = "";
  }
  _$jscoverage['plugins/table.action.js'][1145]++;
  if ((changeValue > 0)) {
    _$jscoverage['plugins/table.action.js'][1145]++;
    cell.style.wordBreak = "break-all";
  }
  _$jscoverage['plugins/table.action.js'][1146]++;
  cell.setAttribute("width", (backRightWidth - changeValue));
}));
      _$jscoverage['plugins/table.action.js'][1149]++;
      if ((! cell.nextSibling)) {
        _$jscoverage['plugins/table.action.js'][1150]++;
        if (table.style.width) {
          _$jscoverage['plugins/table.action.js'][1150]++;
          table.style.width = "";
        }
        _$jscoverage['plugins/table.action.js'][1151]++;
        table.setAttribute("width", (backTableWidth + changeValue));
      }
    }
}
  _$jscoverage['plugins/table.action.js'][1157]++;
  function changeRowHeight(td, changeValue) {
    _$jscoverage['plugins/table.action.js'][1158]++;
    if ((Math.abs(changeValue) < 10)) {
      _$jscoverage['plugins/table.action.js'][1158]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1159]++;
    var ut = getUETable(td);
    _$jscoverage['plugins/table.action.js'][1160]++;
    if (ut) {
      _$jscoverage['plugins/table.action.js'][1161]++;
      var cells = ut.getSameEndPosCells(td, "y"), backHeight = (cells[0]? cells[0].offsetHeight: 0);
      _$jscoverage['plugins/table.action.js'][1164]++;
      for (var i = 0, cell; (cell = cells[(i++)]);) {
        _$jscoverage['plugins/table.action.js'][1165]++;
        setCellHeight(cell, changeValue, backHeight);
}
    }
}
  _$jscoverage['plugins/table.action.js'][1171]++;
  function getDragLine(editor, doc) {
    _$jscoverage['plugins/table.action.js'][1172]++;
    if (mousedown) {
      _$jscoverage['plugins/table.action.js'][1172]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1173]++;
    dragLine = editor.document.createElement("div");
    _$jscoverage['plugins/table.action.js'][1174]++;
    domUtils.setAttributes(dragLine, {id: "ue_tableDragLine", unselectable: "on", contenteditable: false, "onresizestart": "return false", "ondragstart": "return false", "onselectstart": "return false", style: "background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});
    _$jscoverage['plugins/table.action.js'][1183]++;
    editor.body.appendChild(dragLine);
}
  _$jscoverage['plugins/table.action.js'][1186]++;
  function hideDragLine(editor) {
    _$jscoverage['plugins/table.action.js'][1187]++;
    if (mousedown) {
      _$jscoverage['plugins/table.action.js'][1187]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1188]++;
    var line;
    _$jscoverage['plugins/table.action.js'][1189]++;
    while ((line = editor.document.getElementById("ue_tableDragLine"))) {
      _$jscoverage['plugins/table.action.js'][1190]++;
      domUtils.remove(line);
}
}
  _$jscoverage['plugins/table.action.js'][1199]++;
  function showDragLineAt(state, cell) {
    _$jscoverage['plugins/table.action.js'][1200]++;
    if ((! cell)) {
      _$jscoverage['plugins/table.action.js'][1200]++;
      return;
    }
    _$jscoverage['plugins/table.action.js'][1201]++;
    var table = domUtils.findParentByTagName(cell, "table"), caption = table.getElementsByTagName("caption"), width = table.offsetWidth, height = (table.offsetHeight - ((caption.length > 0)? caption[0].offsetHeight: 0)), tablePos = domUtils.getXY(table), cellPos = domUtils.getXY(cell), css;
    _$jscoverage['plugins/table.action.js'][1207]++;
    switch (state) {
    case "h":
      _$jscoverage['plugins/table.action.js'][1209]++;
      css = ("height:" + height + "px;top:" + (tablePos.y + ((caption.length > 0)? caption[0].offsetHeight: 0)) + "px;left:" + ((cellPos.x + cell.offsetWidth) - 2));
      _$jscoverage['plugins/table.action.js'][1210]++;
      dragLine.style.cssText = (css + "px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)");
      _$jscoverage['plugins/table.action.js'][1211]++;
      break;
    case "v":
      _$jscoverage['plugins/table.action.js'][1213]++;
      css = ("width:" + width + "px;left:" + tablePos.x + "px;top:" + ((cellPos.y + cell.offsetHeight) - 2));
      _$jscoverage['plugins/table.action.js'][1215]++;
      dragLine.style.cssText = (css + "px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)");
      _$jscoverage['plugins/table.action.js'][1216]++;
      break;
    default:
    }
}
  _$jscoverage['plugins/table.action.js'][1226]++;
  function switchBorderColor(editor, flag) {
    _$jscoverage['plugins/table.action.js'][1227]++;
    var tableArr = domUtils.getElementsByTagName(editor.body, "table"), color;
    _$jscoverage['plugins/table.action.js'][1228]++;
    for (var i = 0, node; (node = tableArr[(i++)]);) {
      _$jscoverage['plugins/table.action.js'][1229]++;
      var td = domUtils.getElementsByTagName(node, "td");
      _$jscoverage['plugins/table.action.js'][1230]++;
      if (td[0]) {
        _$jscoverage['plugins/table.action.js'][1231]++;
        if (flag) {
          _$jscoverage['plugins/table.action.js'][1232]++;
          color = td[0].style.borderColor.replace(/\s/g, "");
          _$jscoverage['plugins/table.action.js'][1233]++;
          if (/(#ffffff)|(rgb\(255,f55,255\))/gi.test(color)) {
            _$jscoverage['plugins/table.action.js'][1234]++;
            domUtils.addClass(node, "noBorderTable");
          }
        }
        else {
          _$jscoverage['plugins/table.action.js'][1236]++;
          domUtils.removeClasses(node, "noBorderTable");
        }
      }
}
}
  _$jscoverage['plugins/table.action.js'][1243]++;
  function getTableWidth(editor, needIEHack, defaultValue) {
    _$jscoverage['plugins/table.action.js'][1244]++;
    var body = editor.body;
    _$jscoverage['plugins/table.action.js'][1245]++;
    return (body.offsetWidth - (needIEHack? (parseInt(domUtils.getComputedStyle(body, "margin-left"), 10) * 2): 0) - (defaultValue.tableBorder * 2) - (editor.options.offsetWidth || 0));
}
  _$jscoverage['plugins/table.action.js'][1248]++;
  function getTargetTd(editor, evt) {
    _$jscoverage['plugins/table.action.js'][1249]++;
    var target = domUtils.findParentByTagName((evt.target || evt.srcElement), ["td", "th"], true);
    _$jscoverage['plugins/table.action.js'][1251]++;
    return ((target && (! (editor.fireEvent("excludetable", target) === true)))? target: null);
}
});
